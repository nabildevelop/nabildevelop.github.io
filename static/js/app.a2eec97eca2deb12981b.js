webpackJsonp([0],{"+1fU":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("oCvb"),o=n("Amoq"),a=n("eIZu"),s=n("Fx72");n("Gf7q");var u,c="databaseURL",h=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return u||(u=new t),u},t.prototype.interrupt=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].interrupt()},t.prototype.resume=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].resume()},t.prototype.databaseFromApp=function(t,e){var n=e||t.options[c];void 0===n&&o.fatal("Can't determine Firebase Database URL.  Be sure to include "+c+" option when calling firebase.intializeApp().");var r=a.parseRepoInfo(n),i=r.repoInfo;s.validateUrl("Invalid Firebase Database URL",1,r),r.path.isEmpty()||o.fatal("Database URL must point to the root of a Firebase Database (not including a child path).");return this.createRepo(i,t).database},t.prototype.deleteRepo=function(t){var e=r.safeGet(this.repos_,t.app.name);e&&r.safeGet(e,t.repoInfo_.toURLString())===t||o.fatal("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.repoInfo_.toURLString()]},t.prototype.createRepo=function(t,e){var n=r.safeGet(this.repos_,e.name);n||(n={},this.repos_[e.name]=n);var a=r.safeGet(n,t.toURLString());return a&&o.fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new i.Repo(t,this.useRestClient_,e),n[t.toURLString()]=a,a},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}();e.RepoManager=h},"/WFI":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("lscU"),o=n("mnK5"),a=function(){function t(){this.changeMap_={}}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;o.assert(e==i.Change.CHILD_ADDED||e==i.Change.CHILD_CHANGED||e==i.Change.CHILD_REMOVED,"Only child changes supported for tracking"),o.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var a=r.safeGet(this.changeMap_,n);if(a){var s=a.type;if(e==i.Change.CHILD_ADDED&&s==i.Change.CHILD_REMOVED)this.changeMap_[n]=i.Change.childChangedChange(n,t.snapshotNode,a.snapshotNode);else if(e==i.Change.CHILD_REMOVED&&s==i.Change.CHILD_ADDED)delete this.changeMap_[n];else if(e==i.Change.CHILD_REMOVED&&s==i.Change.CHILD_CHANGED)this.changeMap_[n]=i.Change.childRemovedChange(n,a.oldSnap);else if(e==i.Change.CHILD_CHANGED&&s==i.Change.CHILD_ADDED)this.changeMap_[n]=i.Change.childAddedChange(n,t.snapshotNode);else{if(e!=i.Change.CHILD_CHANGED||s!=i.Change.CHILD_CHANGED)throw o.assertionError("Illegal combination of changes: "+t+" occurred after "+a);this.changeMap_[n]=i.Change.childChangedChange(n,t.snapshotNode,a.oldSnap)}}else this.changeMap_[n]=t},t.prototype.getChanges=function(){return r.getValues(this.changeMap_)},t}();e.ChildChangeAccumulator=a},"0Mhn":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("KbSj"),o=n("ZZsk"),a=n("CyQO"),s=n("4AKd"),u=n("sC/S");e.generateWithValues=function(t){return t=t||{},t.timestamp=t.timestamp||(new Date).getTime(),t},e.resolveDeferredValue=function(t,e){return t&&"object"==typeof t?(r.assert(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t},e.resolveDeferredValueTree=function(t,n){var r=new o.SparseSnapshotTree;return t.forEachTree(new i.Path(""),function(t,i){r.remember(t,e.resolveDeferredValueSnapshot(i,n))}),r},e.resolveDeferredValueSnapshot=function(t,n){var r,i=t.getPriority().val(),o=e.resolveDeferredValue(i,n);if(t.isLeafNode()){var c=t,h=e.resolveDeferredValue(c.getValue(),n);return h!==c.getValue()||o!==c.getPriority().val()?new a.LeafNode(h,s.nodeFromJSON(o)):t}var l=t;return r=l,o!==l.getPriority().val()&&(r=r.updatePriority(new a.LeafNode(o))),l.forEachChild(u.PRIORITY_INDEX,function(t,i){var o=e.resolveDeferredValueSnapshot(i,n);o!==i&&(r=r.updateImmediateChild(t,o))}),r}},"1et+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=r.clone(t);return this.last_&&r.forEach(this.last_,function(t,n){e[t]=e[t]-n}),this.last_=t,e},t}();e.StatsListener=i},"2/he":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("NxJK"),i=n("Amoq"),o=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new r.NamedNode(i.MIN_NAME,t),o=new r.NamedNode(i.MIN_NAME,e);return 0!==this.compare(n,o)},t.prototype.minPost=function(){return r.NamedNode.MIN},t}();e.Index=o},"27hO":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("mnK5"),o=n("KbSj"),a=n("8YHW"),s=n("sC/S"),u=n("n1q+"),c=function(){function t(){this.visibleWrites_=a.CompoundWrite.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new h(t,this)},t.prototype.addOverwrite=function(t,e,n,r){i.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){i.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex(function(e){return e.writeId===t});i.assert(n>=0,"removeWrite called with nonexistent writeId.");var o=this.allWrites_[n];this.allWrites_.splice(n,1);for(var a=o.visible,s=!1,u=this.allWrites_.length-1;a&&u>=0;){var c=this.allWrites_[u];c.visible&&(u>=n&&this.recordContainsPath_(c,o.path)?a=!1:o.path.contains(c.path)&&(s=!0)),u--}if(a){if(s)return this.resetTree_(),!0;if(o.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(o.path);else{var h=o.children;r.forEach(h,function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(o.path.child(t))})}return!0}return!1},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var a=this.visibleWrites_.childCompoundWrite(e);if(!i&&a.isEmpty())return n;if(i||null!=n||a.hasCompleteWrite(o.Path.Empty)){var s=function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))},c=t.layerTree_(this.allWrites_,s,e);f=n||u.ChildrenNode.EMPTY_NODE;return c.apply(f)}return null}var h=this.visibleWrites_.getCompleteNode(e);if(null!=h)return h;var l=this.visibleWrites_.childCompoundWrite(e);if(l.isEmpty())return n;if(null!=n||l.hasCompleteWrite(o.Path.Empty)){var f=n||u.ChildrenNode.EMPTY_NODE;return l.apply(f)}return null},t.prototype.calcCompleteEventChildren=function(t,e){var n=u.ChildrenNode.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(s.PRIORITY_INDEX,function(t,e){n=n.updateImmediateChild(t,e)}),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(s.PRIORITY_INDEX,function(t,e){var r=i.childCompoundWrite(new o.Path(t)).apply(e);n=n.updateImmediateChild(t,r)}),i.getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){i.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var o=t.child(e);if(this.visibleWrites_.hasCompleteWrite(o))return null;var a=this.visibleWrites_.childCompoundWrite(o);return a.isEmpty()?r.getChild(e):a.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);if(null!=i)return i;if(n.isCompleteForChild(e)){return this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e))}return null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,a){var s,u=this.visibleWrites_.childCompoundWrite(t),c=u.getCompleteNode(o.Path.Empty);if(null!=c)s=c;else{if(null==e)return[];s=u.apply(e)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var h=[],l=a.getCompare(),f=i?s.getReverseIteratorFrom(n,a):s.getIteratorFrom(n,a),p=f.getNext();p&&h.length<r;)0!==l(p,n)&&h.push(p),p=f.getNext();return h},t.prototype.recordContainsPath_=function(t,e){return t.snap?t.path.contains(e):!!r.findKey(t.children,function(n,r){return t.path.child(r).contains(e)})},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,o.Path.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var s=a.CompoundWrite.Empty,u=0;u<t.length;++u){var c=t[u];if(e(c)){var h=c.path,l=void 0;if(c.snap)n.contains(h)?(l=o.Path.relativePath(n,h),s=s.addWrite(l,c.snap)):h.contains(n)&&(l=o.Path.relativePath(h,n),s=s.addWrite(o.Path.Empty,c.snap.getChild(l)));else{if(!c.children)throw i.assertionError("WriteRecord should have .snap or .children");if(n.contains(h))l=o.Path.relativePath(n,h),s=s.addWrites(l,c.children);else if(h.contains(n))if((l=o.Path.relativePath(h,n)).isEmpty())s=s.addWrites(o.Path.Empty,c.children);else{var f=r.safeGet(c.children,l.getFront());if(f){var p=f.getChild(l.popFront());s=s.addWrite(o.Path.Empty,p)}}}}}return s},t}();e.WriteTree=c;var h=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}();e.WriteTreeRef=h},"3al8":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("MUsR");e.assert=function(t,n){if(!t)throw e.assertionError(n)},e.assertionError=function(t){return new Error("Firebase Database ("+r.CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)}},"4AKd":function(t,e,n){"use strict";function r(t,e){if(void 0===e&&(e=null),null===t)return i.ChildrenNode.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),u.assert(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t){var n=t;return new o.LeafNode(n,r(e))}if(t instanceof Array||!p){var d=i.ChildrenNode.EMPTY_NODE,y=t;return s.forEach(y,function(t,e){if(s.contains(y,t)&&"."!==t.substring(0,1)){var n=r(e);!n.isLeafNode()&&n.isEmpty()||(d=d.updateImmediateChild(t,n))}}),d.updatePriority(r(e))}var m=[],v=!1,g=t;if(s.forEach(g,function(t,e){if("string"!=typeof t||"."!==t.substring(0,1)){var n=r(g[t]);n.isEmpty()||(v=v||!n.getPriority().isEmpty(),m.push(new a.NamedNode(t,n)))}}),0==m.length)return i.ChildrenNode.EMPTY_NODE;var _=c.buildChildSet(m,h.NAME_ONLY_COMPARATOR,function(t){return t.name},h.NAME_COMPARATOR);if(v){var b=c.buildChildSet(m,f.PRIORITY_INDEX.getCompare());return new i.ChildrenNode(_,r(e),new l.IndexMap({".priority":b},{".priority":f.PRIORITY_INDEX}))}return new i.ChildrenNode(_,r(e),l.IndexMap.Default)}Object.defineProperty(e,"__esModule",{value:!0});var i=n("n1q+"),o=n("CyQO"),a=n("NxJK"),s=n("mnK5"),u=n("mnK5"),c=n("RlcV"),h=n("wwn+"),l=n("uBgE"),f=n("sC/S"),p=!0;e.nodeFromJSON=r,f.setNodeFromJSON(r)},"4e9P":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("Amoq"),o=n("ytZ3"),a=n("sC/S"),s=n("i9Ll"),u=n("Izak"),c=n("IzwH"),h=n("sn29"),l=n("5aM3"),f=n("mnK5"),p=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=a.PRIORITY_INDEX}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return r.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return r.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:i.MIN_NAME},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return r.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return r.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:i.MAX_NAME},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return r.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==a.PRIORITY_INDEX&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==a.PRIORITY_INDEX},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new c.IndexedFilter(this.getIndex()):this.hasLimit()?new h.LimitedFilter(this):new l.RangedFilter(this)},t.prototype.toRestQueryStringParameters=function(){var e=t.REST_QUERY_CONSTANTS_,n={};if(this.isDefault())return n;var i;return this.index_===a.PRIORITY_INDEX?i=e.PRIORITY_INDEX:this.index_===s.VALUE_INDEX?i=e.VALUE_INDEX:this.index_===o.KEY_INDEX?i=e.KEY_INDEX:(r.assert(this.index_ instanceof u.PathIndex,"Unrecognized index type!"),i=this.index_.toString()),n[e.ORDER_BY]=f.stringify(i),this.startSet_&&(n[e.START_AT]=f.stringify(this.indexStartValue_),this.startNameSet_&&(n[e.START_AT]+=","+f.stringify(this.indexStartName_))),this.endSet_&&(n[e.END_AT]=f.stringify(this.indexEndValue_),this.endNameSet_&&(n[e.END_AT]+=","+f.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[e.LIMIT_TO_FIRST]=this.limit_:n[e.LIMIT_TO_LAST]=this.limit_),n},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}();e.QueryParams=p},"4uRS":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n("mnK5"),o=n("Amoq"),a=n("mnK5");e.setMaxNode=function(t){r=t},e.priorityHashText=function(t){return"number"==typeof t?"number:"+o.doubleToIEEE754String(t):"string:"+t},e.validatePriorityNode=function(t){if(t.isLeafNode()){var e=t.val();i.assert("string"==typeof e||"number"==typeof e||"object"==typeof e&&a.contains(e,".sv"),"Priority must be a string or number.")}else i.assert(t===r||t.isEmpty(),"priority of unexpected type.");i.assert(t===r||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}},"5aM3":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("IzwH"),i=n("sC/S"),o=n("NxJK"),a=n("n1q+"),s=function(){function t(e){this.indexedFilter_=new r.IndexedFilter(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,s){return this.matches(new o.NamedNode(e,n))||(n=a.ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,s)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=a.ChildrenNode.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(a.ChildrenNode.EMPTY_NODE);var s=this;return e.forEachChild(i.PRIORITY_INDEX,function(t,e){s.matches(new o.NamedNode(t,e))||(r=r.updateImmediateChild(t,a.ChildrenNode.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}();e.RangedFilter=s},"6m+W":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n("rd4o"),o=n("KbSj"),a=n("Amoq"),s=n("mnK5"),u=function(){return r||(r=new i.SortedMap(a.stringCompare)),r},c=function(){function t(t,e){void 0===e&&(e=u()),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return s.forEach(e,function(t,e){n=n.set(new o.Path(t),e)}),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:o.Path.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);if(null!=i){return{path:new o.Path(n).child(i.path),value:i.value}}return null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,function(){return!0})},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=(this.children.get(r)||t.Empty).set(e.popFront(),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r=e.getFront(),i=(this.children.get(r)||t.Empty).setTree(e.popFront(),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new t(this.value,o)},t.prototype.fold=function(t){return this.fold_(o.Path.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(t.child(r),e)}),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,o.Path.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,o.Path.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_(o.Path.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal(function(n,r){r.foreach_(t.child(n),e)}),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal(function(e,n){n.value&&t(e,n.value)})},t.Empty=new t(null),t}();e.ImmutableTree=c},"7Oow":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){for(var e=[],n=0,r=0;r<t.length;r++){for(var i=t.charCodeAt(r);i>255;)e[n++]=255&i,i>>=8;e[n++]=i}return e};e.base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(r(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){if(t.length<8192)return String.fromCharCode.apply(null,t);for(var e="",n=0;n<t.length;n+=8192){var r=t.slice(n,n+8192);e+=String.fromCharCode.apply(null,r)}return e}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!=s){var h=a<<4&240|s>>2;if(r.push(h),64!=u){var l=s<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},e.base64Encode=function(t){var n=r(t);return e.base64.encodeByteArray(n,!0)},e.base64Decode=function(t){try{return e.base64.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}},"8YHW":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("6m+W"),i=n("KbSj"),o=n("mnK5"),a=n("NxJK"),s=n("sC/S"),u=n("mnK5"),c=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new r.ImmutableTree(n));var o=this.writeTree_.findRootMostValueAndPath(e);if(null!=o){var a=o.path,s=o.value,u=i.Path.relativePath(a,e);return s=s.updateChild(u,n),new t(this.writeTree_.set(a,s))}var c=new r.ImmutableTree(n);return new t(this.writeTree_.setTree(e,c))},t.prototype.addWrites=function(t,e){var n=this;return o.forEach(e,function(e,r){n=n.addWrite(t.child(e),r)}),n},t.prototype.removeWrite=function(e){if(e.isEmpty())return t.Empty;return new t(this.writeTree_.setTree(e,r.ImmutableTree.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(i.Path.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(s.PRIORITY_INDEX,function(e,n){t.push(new a.NamedNode(e,n))}):this.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new a.NamedNode(e,n.value))}),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new r.ImmutableTree(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(e){return t.applySubtreeWrite_(i.Path.Empty,this.writeTree_,e)},t.Empty=new t(new r.ImmutableTree(null)),t.applySubtreeWrite_=function(e,n,r){if(null!=n.value)return r.updateChild(e,n.value);var i=null;return n.children.inorderTraversal(function(n,o){".priority"===n?(u.assert(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=t.applySubtreeWrite_(e.child(n),o,r)}),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(e.child(".priority"),i)),r},t}();e.CompoundWrite=c},"9BlA":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("MUsR");e.getUA=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""},e.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(e.getUA())},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isNodeSdk=function(){return!0===r.CONSTANTS.NODE_CLIENT||!0===r.CONSTANTS.NODE_ADMIN}},"9ZaE":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n("TroR"),o=n("n1q+"),a=n("mnK5"),s=n("mnK5"),u=n("x9qz"),c=n("xqIQ"),h=function(){function t(){this.views_={}}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return a.assert(r,"Reference.ts has not been loaded"),r},set:function(t){a.assert(!r,"__referenceConstructor has already been defined"),r=t},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return s.isEmpty(this.views_)},t.prototype.applyOperation=function(t,e,n){var r=t.source.queryId;if(null!==r){var i=s.safeGet(this.views_,r);return a.assert(null!=i,"SyncTree gave us an op for an invalid query."),i.applyOperation(t,e,n)}var o=[];return s.forEach(this.views_,function(r,i){o=o.concat(i.applyOperation(t,e,n))}),o},t.prototype.addEventRegistration=function(t,e,n,r,a){var h=t.queryIdentifier(),l=s.safeGet(this.views_,h);if(!l){var f=n.calcCompleteEventCache(a?r:null),p=!1;f?p=!0:r instanceof o.ChildrenNode?(f=n.calcCompleteEventChildren(r),p=!1):(f=o.ChildrenNode.EMPTY_NODE,p=!1);var d=new u.ViewCache(new i.CacheNode(f,p,!1),new i.CacheNode(r,a,!1));l=new c.View(t,d),this.views_[h]=l}return l.addEventRegistration(e),l.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var i=e.queryIdentifier(),o=[],a=[],u=this.hasCompleteView();if("default"===i){var c=this;s.forEach(this.views_,function(t,e){a=a.concat(e.removeEventRegistration(n,r)),e.isEmpty()&&(delete c.views_[t],e.getQuery().getQueryParams().loadsAllData()||o.push(e.getQuery()))})}else{var h=s.safeGet(this.views_,i);h&&(a=a.concat(h.removeEventRegistration(n,r)),h.isEmpty()&&(delete this.views_[i],h.getQuery().getQueryParams().loadsAllData()||o.push(h.getQuery())))}return u&&!this.hasCompleteView()&&o.push(new t.__referenceConstructor(e.repo,e.path)),{removed:o,events:a}},t.prototype.getQueryViews=function(){var t=this;return Object.keys(this.views_).map(function(e){return t.views_[e]}).filter(function(t){return!t.getQuery().getQueryParams().loadsAllData()})},t.prototype.getCompleteServerCache=function(t){var e=null;return s.forEach(this.views_,function(n,r){e=e||r.getCompleteServerCache(t)}),e},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return s.safeGet(this.views_,e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){return s.findValue(this.views_,function(t){return t.getQuery().getQueryParams().loadsAllData()})||null},t}();e.SyncPoint=h},"9fSs":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.safeGet=function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]},e.forEach=function(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])},e.extend=function(t,n){return e.forEach(n,function(e,n){t[e]=n}),t},e.clone=function(t){return e.extend({},t)},e.isNonNullObject=function(t){return"object"==typeof t&&null!==t},e.isEmpty=function(t){for(var e in t)return!1;return!0},e.getCount=function(t){var e=0;for(var n in t)e++;return e},e.map=function(t,e,n){var r={};for(var i in t)r[i]=e.call(n,t[i],i,t);return r},e.findKey=function(t,e,n){for(var r in t)if(e.call(n,t[r],r,t))return r},e.findValue=function(t,n,r){var i=e.findKey(t,n,r);return i&&t[i]},e.getAnyKey=function(t){for(var e in t)return e},e.getValues=function(t){var e=[],n=0;for(var r in t)e[n++]=t[r];return e},e.every=function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!e(n,t[n]))return!1;return!0}},AmnR:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Amoq"),i=n("nf05"),o=n("Vu+o"),a=n("kawy"),s=function(){function t(t,e,n,i,o,s,u){this.id=t,this.repoInfo_=e,this.onMessage_=n,this.onReady_=i,this.onDisconnect_=o,this.onKill_=s,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=r.logWrapper("c:"+this.id+":"),this.transportManager_=new a.TransportManager(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){t.conn_&&t.conn_.open(n,i)},Math.floor(0));var o=e.healthyTimeout||0;o>0&&(this.healthyTimeout_=r.setTimeoutNonBlocking(function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))},Math.floor(o)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!=e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=r.requireKey("t",t),n=r.requireKey("d",t);if("c"==e)this.onSecondaryControl_(n);else{if("d"!=e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=r.requireKey("t",t),n=r.requireKey("d",t);"c"==e?this.onControl_(n):"d"==e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=r.requireKey("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?r.error("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):r.error("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(i),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),o.PROTOCOL_VERSION!==n&&r.warn("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),r.setTimeoutNonBlocking(function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())},Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):r.setTimeoutNonBlocking(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(i.PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}();e.Connection=s},Amoq:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("mnK5"),o=n("mnK5"),a=n("mnK5"),s=n("mnK5"),u=n("mnK5"),c=n("nf05"),h=n("mnK5");e.LUIDGenerator=function(){var t=1;return function(){return t++}}(),e.sha1=function(t){var e=s.stringToByteArray(t),n=new a.Sha1;n.update(e);var r=n.digest();return o.base64.encodeByteArray(r)};var l=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++)Array.isArray(t[r])||t[r]&&"object"==typeof t[r]&&"number"==typeof t[r].length?n+=l.apply(null,t[r]):"object"==typeof t[r]?n+=u.stringify(t[r]):n+=t[r],n+=" ";return n};e.logger=null;var f=!0;e.enableLogging=function(t,n){r.assert(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?("undefined"!=typeof console&&("function"==typeof console.log?e.logger=console.log.bind(console):"object"==typeof console.log&&(e.logger=function(t){console.log(t)})),n&&c.SessionStorage.set("logging_enabled",!0)):"function"==typeof t?e.logger=t:(e.logger=null,c.SessionStorage.remove("logging_enabled"))},e.log=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!0===f&&(f=!1,null===e.logger&&!0===c.SessionStorage.get("logging_enabled")&&e.enableLogging(!0)),e.logger){var r=l.apply(null,t);e.logger(r)}},e.logWrapper=function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e.log.apply(void 0,[t].concat(n))}},e.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof console){var n="FIREBASE INTERNAL ERROR: "+l.apply(void 0,t);void 0!==console.error?console.error(n):console.log(n)}},e.fatal=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=l.apply(void 0,t);throw new Error("FIREBASE FATAL ERROR: "+n)},e.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof console){var n="FIREBASE WARNING: "+l.apply(void 0,t);void 0!==console.warn?console.warn(n):console.log(n)}},e.warnIfPageIsSecure=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&e.warn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},e.warnAboutUnsupportedMethod=function(t){e.warn(t+" is unsupported and will likely change soon.  Please do not use.")},e.isInvalidJSONNumber=function(t){return"number"==typeof t&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)},e.executeWhenDOMReady=function(t){if(h.isNodeSdk()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},e.MIN_NAME="[MIN_NAME]",e.MAX_NAME="[MAX_NAME]",e.nameCompare=function(t,n){if(t===n)return 0;if(t===e.MIN_NAME||n===e.MAX_NAME)return-1;if(n===e.MIN_NAME||t===e.MAX_NAME)return 1;var r=e.tryParseInt(t),i=e.tryParseInt(n);return null!==r?null!==i?r-i==0?t.length-n.length:r-i:-1:null!==i?1:t<n?-1:1},e.stringCompare=function(t,e){return t===e?0:t<e?-1:1},e.requireKey=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+u.stringify(e))},e.ObjectToUniqueKey=function(t){if("object"!=typeof t||null===t)return u.stringify(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",o=0;o<n.length;o++)0!==o&&(i+=","),i+=u.stringify(n[o]),i+=":",i+=e.ObjectToUniqueKey(t[n[o]]);return i+="}"},e.splitStringBySize=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r},e.each=function(t,e){if(Array.isArray(t))for(var n=0;n<t.length;++n)e(n,t[n]);else i.forEach(t,function(t,n){return e(n,t)})},e.bindCallback=function(t,e){return e?t.bind(e):t},e.doubleToIEEE754String=function(t){r.assert(!e.isInvalidJSONNumber(t),"Invalid JSON number");var n,i,o,a,s,u,c;for(0===t?(i=0,o=0,n=1/t==-1/0?1:0):(n=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(i=(a=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,o=Math.round(t*Math.pow(2,52-a)-Math.pow(2,52))):(i=0,o=Math.round(t/Math.pow(2,-1074)))),u=[],s=52;s;s-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(s=11;s;s-=1)u.push(i%2?1:0),i=Math.floor(i/2);u.push(n?1:0),u.reverse(),c=u.join("");var h="";for(s=0;s<64;s+=8){var l=parseInt(c.substr(s,8),2).toString(16);1===l.length&&(l="0"+l),h+=l}return h.toLowerCase()},e.isChromeExtensionContentScript=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},e.isWindowsStoreApp=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},e.errorForServerCode=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?n="Client doesn't have permission to access the desired data.":"unavailable"==t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r},e.INTEGER_REGEXP_=new RegExp("^-?\\d{1,10}$"),e.tryParseInt=function(t){if(e.INTEGER_REGEXP_.test(t)){var n=Number(t);if(n>=-2147483648&&n<=2147483647)return n}return null},e.exceptionGuard=function(t){try{t()}catch(t){setTimeout(function(){var n=t.stack||"";throw e.warn("Exception was thrown by user callback.",n),t},Math.floor(0))}},e.callUserCallback=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];"function"==typeof t&&e.exceptionGuard(function(){t.apply(void 0,n)})},e.beingCrawled=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},e.exportPropGetter=function(t,e,n){Object.defineProperty(t,e,{get:n})},e.setTimeoutNonBlocking=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n}},BtxX:function(t,e){!function(e){function n(){}function r(t){if(!(this instanceof r))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(t,this)}function i(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,r._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void a(e.promise,t)}o(e.promise,r)}else(1===t._state?o:a)(e.promise,t._value)})):t._deferreds.push(e)}function o(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof r)return t._state=3,t._value=e,void s(t);if("function"==typeof n)return void u(function(t,e){return function(){t.apply(e,arguments)}}(n,e),t)}t._state=1,t._value=e,s(t)}catch(e){a(t,e)}}function a(t,e){t._state=2,t._value=e,s(t)}function s(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)i(t,t._deferreds[e]);t._deferreds=null}function u(t,e){var n=!1;try{t(function(t){n||(n=!0,o(e,t))},function(t){n||(n=!0,a(e,t))})}catch(t){if(n)return;n=!0,a(e,t)}}var c=setTimeout;r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,e){var r=new this.constructor(n);return i(this,new function(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}(t,e,r)),r},r.all=function(t){return new r(function(e,n){function r(t,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){r(t,e)},n)}i[t]=a,0==--o&&e(i)}catch(t){n(t)}}if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);for(var o=i.length,a=0;a<i.length;a++)r(a,i[a])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},r._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){c(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},void 0!==t&&t.exports?t.exports=r:e.Promise||(e.Promise=r)}(this)},CWxw:function(t,e,n){(function(t){var e=function(){if(void 0!==t)return t;if("undefined"!=typeof window)return window;if("undefined"!=typeof self)return self;throw new Error("unable to locate global object")}();"undefined"==typeof Promise&&(e.Promise=Promise=n("BtxX"))}).call(e,n("DuR2"))},CyQO:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n("mnK5"),o=n("Amoq"),a=n("4uRS"),s=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,i.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),a.validatePriorityNode(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return r},set:function(t){r=t},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(i.assert(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+a.priorityHashText(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?o.doubleToIEEE754String(this.value_):this.value_,this.lazyHash_=o.sha1(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(i.assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,o=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(r);return i.assert(o>=0,"Unknown leaf type: "+n),i.assert(a>=0,"Unknown leaf type: "+r),o===a?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-o},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();e.LeafNode=s},DUiD:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.jsonEval=function(t){return JSON.parse(t)},e.stringify=function(t){return JSON.stringify(t)}},EEdD:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return r.contains(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}();e.MemoryStorage=i},Fi7B:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("9fSs");e.querystring=function(t){var e=[];return r.forEach(t,function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}),e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach(function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}}),e}},Fx72:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("KbSj"),i=n("mnK5"),o=n("Amoq"),a=n("mnK5"),s=n("mnK5");e.INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,e.INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,e.MAX_LEAF_SIZE_=10485760,e.isValidKey=function(t){return"string"==typeof t&&0!==t.length&&!e.INVALID_KEY_REGEX_.test(t)},e.isValidPathString=function(t){return"string"==typeof t&&0!==t.length&&!e.INVALID_PATH_REGEX_.test(t)},e.isValidRootPathString=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),e.isValidPathString(t)},e.isValidPriority=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!o.isInvalidJSONNumber(t)||t&&"object"==typeof t&&i.contains(t,".sv")},e.validateFirebaseDataArg=function(t,n,r,i,o){o&&void 0===r||e.validateFirebaseData(a.errorPrefix(t,n,o),r,i)},e.validateFirebaseData=function(t,n,a){var u=a instanceof r.Path?new r.ValidationPath(a,t):a;if(void 0===n)throw new Error(t+"contains undefined "+u.toErrorString());if("function"==typeof n)throw new Error(t+"contains a function "+u.toErrorString()+" with contents = "+n.toString());if(o.isInvalidJSONNumber(n))throw new Error(t+"contains "+n.toString()+" "+u.toErrorString());if("string"==typeof n&&n.length>e.MAX_LEAF_SIZE_/3&&s.stringLength(n)>e.MAX_LEAF_SIZE_)throw new Error(t+"contains a string greater than "+e.MAX_LEAF_SIZE_+" utf8 bytes "+u.toErrorString()+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){var c=!1,h=!1;if(i.forEach(n,function(n,r){if(".value"===n)c=!0;else if(".priority"!==n&&".sv"!==n&&(h=!0,!e.isValidKey(n)))throw new Error(t+" contains an invalid key ("+n+") "+u.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');u.push(n),e.validateFirebaseData(t,r,u),u.pop()}),c&&h)throw new Error(t+' contains ".value" child '+u.toErrorString()+" in addition to actual children.")}},e.validateFirebaseMergePaths=function(t,n){var i,o;for(i=0;i<n.length;i++)for(var a=(o=n[i]).slice(),s=0;s<a.length;s++)if(".priority"===a[s]&&s===a.length-1);else if(!e.isValidKey(a[s]))throw new Error(t+"contains an invalid key ("+a[s]+") in path "+o.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');n.sort(r.Path.comparePaths);var u=null;for(i=0;i<n.length;i++){if(o=n[i],null!==u&&u.contains(o))throw new Error(t+"contains a path "+u.toString()+" that is ancestor of another path "+o.toString());u=o}},e.validateFirebaseMergeDataArg=function(t,n,o,s,u){if(!u||void 0!==o){var c=a.errorPrefix(t,n,u);if(!o||"object"!=typeof o||Array.isArray(o))throw new Error(c+" must be an object containing the children to replace.");var h=[];i.forEach(o,function(t,n){var i=new r.Path(t);if(e.validateFirebaseData(c,n,s.child(i)),".priority"===i.getBack()&&!e.isValidPriority(n))throw new Error(c+"contains an invalid value for '"+i.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");h.push(i)}),e.validateFirebaseMergePaths(c,h)}},e.validatePriority=function(t,n,r,i){if(!i||void 0!==r){if(o.isInvalidJSONNumber(r))throw new Error(a.errorPrefix(t,n,i)+"is "+r.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!e.isValidPriority(r))throw new Error(a.errorPrefix(t,n,i)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},e.validateEventType=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(a.errorPrefix(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},e.validateKey=function(t,n,r,i){if(!(i&&void 0===r||e.isValidKey(r)))throw new Error(a.errorPrefix(t,n,i)+'was an invalid key = "'+r+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},e.validatePathString=function(t,n,r,i){if(!(i&&void 0===r||e.isValidPathString(r)))throw new Error(a.errorPrefix(t,n,i)+'was an invalid path = "'+r+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},e.validateRootPathString=function(t,n,r,i){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),e.validatePathString(t,n,r,i)},e.validateWritablePath=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},e.validateUrl=function(t,n,r){var i=r.path.toString();if("string"!=typeof r.repoInfo.host||0===r.repoInfo.host.length||!e.isValidKey(r.repoInfo.namespace)||0!==i.length&&!e.isValidRootPathString(i))throw new Error(a.errorPrefix(t,n,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},e.validateCredential=function(t,e,n,r){if((!r||void 0!==n)&&"string"!=typeof n)throw new Error(a.errorPrefix(t,e,r)+"must be a valid credential (a string).")},e.validateBoolean=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(a.errorPrefix(t,e,r)+"must be a boolean.")},e.validateString=function(t,e,n,r){if((!r||void 0!==n)&&"string"!=typeof n)throw new Error(a.errorPrefix(t,e,r)+"must be a valid string.")},e.validateObject=function(t,e,n,r){if(!(r&&void 0===n||n&&"object"==typeof n&&null!==n))throw new Error(a.errorPrefix(t,e,r)+"must be a valid object.")},e.validateObjectContainsKey=function(t,e,n,r,o,s){if(!(n&&"object"==typeof n&&i.contains(n,r))){if(o)return;throw new Error(a.errorPrefix(t,e,o)+'must contain the key "'+r+'"')}if(s){var u=i.safeGet(n,r);if("number"===s&&"number"!=typeof u||"string"===s&&"string"!=typeof u||"boolean"===s&&"boolean"!=typeof u||"function"===s&&"function"!=typeof u||"object"===s&&"object"!=typeof u&&u)throw o?new Error(a.errorPrefix(t,e,o)+'contains invalid value for key "'+r+'" (must be of type "'+s+'")'):new Error(a.errorPrefix(t,e,o)+'must contain the key "'+r+'" with type "'+s+'"')}}},GC2w:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Amoq"),i=n("eIZu"),o=n("KbSj"),a=n("rURb"),s=n("oCvb"),u=n("+1fU"),c=n("mnK5"),h=n("Fx72"),l=function(){function t(t){this.repo_=t,t instanceof s.Repo||r.fatal("Don't call new Database() directly - please use firebase.database()."),this.root_=new a.Reference(t,o.Path.Empty),this.INTERNAL=new f(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),t.prototype.ref=function(t){return this.checkDeleted_("ref"),c.validateArgCount("database.ref",0,1,arguments.length),void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),c.validateArgCount(e,1,1,arguments.length);var n=i.parseRepoInfo(t);h.validateUrl(e,1,n);var o=n.repoInfo;return o.host!==this.repo_.repoInfo_.host&&r.fatal(e+": Host name does not match the current database: (found "+o.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repo_&&r.fatal("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){c.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){c.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"}},t}();e.Database=l;var f=function(){function t(t){this.database=t}return t.prototype.delete=function(){return this.database.checkDeleted_("delete"),u.RepoManager.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,Promise.resolve()},t}();e.DatabaseInternals=f},Gf7q:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n("mnK5"),o=n("rURb"),a=n("YR+7"),s=n("KbSj"),u=n("cBKv"),c=n("sC/S"),h=n("Amoq"),l=n("0Mhn"),f=n("Fx72"),p=n("mnK5"),d=n("4AKd"),y=n("n1q+"),m=n("oCvb");!function(t){t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT"}(r=e.TransactionStatus||(e.TransactionStatus={})),m.Repo.MAX_TRANSACTION_RETRIES_=25,m.Repo.prototype.transactions_init_=function(){this.transactionQueueTree_=new u.Tree},m.Repo.prototype.startTransaction=function(t,e,n,s){this.log_("transaction on "+t);var u=function(){},m=new o.Reference(this,t);m.on("value",u);var v={path:t,update:e,onComplete:n,status:null,order:h.LUIDGenerator(),applyLocally:s,retryCount:0,unwatcher:function(){m.off("value",u)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},g=this.getLatestState_(t);v.currentInputSnapshot=g;var _=v.update(g.val());if(void 0===_){if(v.unwatcher(),v.currentOutputSnapshotRaw=null,v.currentOutputSnapshotResolved=null,v.onComplete){var b=new a.DataSnapshot(v.currentInputSnapshot,new o.Reference(this,v.path),c.PRIORITY_INDEX);v.onComplete(null,!1,b)}}else{f.validateFirebaseData("transaction failed: Data returned ",_,v.path),v.status=r.RUN;var w=this.transactionQueueTree_.subTree(t),E=w.getValue()||[];E.push(v),w.setValue(E);var T=void 0;if("object"==typeof _&&null!==_&&p.contains(_,".priority"))T=p.safeGet(_,".priority"),i.assert(f.isValidPriority(T),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{T=(this.serverSyncTree_.calcCompleteEventCache(t)||y.ChildrenNode.EMPTY_NODE).getPriority().val()}T=T;var I=this.generateServerValues(),C=d.nodeFromJSON(_,T),S=l.resolveDeferredValueSnapshot(C,I);v.currentOutputSnapshotRaw=C,v.currentOutputSnapshotResolved=S,v.currentWriteId=this.getNextWriteId_();var N=this.serverSyncTree_.applyUserOverwrite(t,S,v.currentWriteId,v.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,N),this.sendReadyTransactions_()}},m.Repo.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||y.ChildrenNode.EMPTY_NODE},m.Repo.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);i.assert(n.length>0,"Sending zero length transaction queue");n.every(function(t){return t.status===r.RUN})&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild(function(t){e.sendReadyTransactions_(t)})},m.Repo.prototype.sendTransactionQueue_=function(t,e){for(var n=this,u=e.map(function(t){return t.currentWriteId}),l=this.getLatestState_(t,u),f=l,p=l.hash(),d=0;d<e.length;d++){var y=e[d];i.assert(y.status===r.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),y.status=r.SENT,y.retryCount++;var m=s.Path.relativePath(t,y.path);f=f.updateChild(m,y.currentOutputSnapshotRaw)}var v=f.val(!0),g=t;this.server_.put(g.toString(),v,function(i){n.log_("transaction put response",{path:g.toString(),status:i});var s=[];if("ok"===i){for(var u=[],l=0;l<e.length;l++){if(e[l].status=r.COMPLETED,s=s.concat(n.serverSyncTree_.ackUserWrite(e[l].currentWriteId)),e[l].onComplete){var f=e[l].currentOutputSnapshotResolved,p=new o.Reference(n,e[l].path),d=new a.DataSnapshot(f,p,c.PRIORITY_INDEX);u.push(e[l].onComplete.bind(null,null,!0,d))}e[l].unwatcher()}n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,s);for(l=0;l<u.length;l++)h.exceptionGuard(u[l])}else{if("datastale"===i)for(l=0;l<e.length;l++)e[l].status===r.SENT_NEEDS_ABORT?e[l].status=r.NEEDS_ABORT:e[l].status=r.RUN;else{h.warn("transaction at "+g.toString()+" failed: "+i);for(l=0;l<e.length;l++)e[l].status=r.NEEDS_ABORT,e[l].abortReason=i}n.rerunTransactions_(t)}},p)},m.Repo.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},m.Repo.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n=[],u=[],y=t.filter(function(t){return t.status===r.RUN}).map(function(t){return t.currentWriteId}),v=0;v<t.length;v++){var g=t[v],_=s.Path.relativePath(e,g.path),b=!1,w=void 0;if(i.assert(null!==_,"rerunTransactionsUnderNode_: relativePath should not be null."),g.status===r.NEEDS_ABORT)b=!0,w=g.abortReason,u=u.concat(this.serverSyncTree_.ackUserWrite(g.currentWriteId,!0));else if(g.status===r.RUN)if(g.retryCount>=m.Repo.MAX_TRANSACTION_RETRIES_)b=!0,w="maxretry",u=u.concat(this.serverSyncTree_.ackUserWrite(g.currentWriteId,!0));else{var E=this.getLatestState_(g.path,y);g.currentInputSnapshot=E;var T=t[v].update(E.val());if(void 0!==T){f.validateFirebaseData("transaction failed: Data returned ",T,g.path);var I=d.nodeFromJSON(T);"object"==typeof T&&null!=T&&p.contains(T,".priority")||(I=I.updatePriority(E.getPriority()));var C=g.currentWriteId,S=this.generateServerValues(),N=l.resolveDeferredValueSnapshot(I,S);g.currentOutputSnapshotRaw=I,g.currentOutputSnapshotResolved=N,g.currentWriteId=this.getNextWriteId_(),y.splice(y.indexOf(C),1),u=(u=u.concat(this.serverSyncTree_.applyUserOverwrite(g.path,N,g.currentWriteId,g.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(C,!0))}else b=!0,w="nodata",u=u.concat(this.serverSyncTree_.ackUserWrite(g.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,u),u=[],b&&(t[v].status=r.COMPLETED,function(t){setTimeout(t,Math.floor(0))}(t[v].unwatcher),t[v].onComplete))if("nodata"===w){var A=new o.Reference(this,t[v].path),R=t[v].currentInputSnapshot,O=new a.DataSnapshot(R,A,c.PRIORITY_INDEX);n.push(t[v].onComplete.bind(null,null,!1,O))}else n.push(t[v].onComplete.bind(null,new Error(w),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(v=0;v<n.length;v++)h.exceptionGuard(n[v]);this.sendReadyTransactions_()}},m.Repo.prototype.getAncestorTransactionNode_=function(t){for(var e,n=this.transactionQueueTree_;null!==(e=t.getFront())&&null===n.getValue();)n=n.subTree(e),t=t.popFront();return n},m.Repo.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort(function(t,e){return t.order-e.order}),e},m.Repo.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild(function(t){n.aggregateTransactionQueuesForNode_(t,e)})},m.Repo.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var i=0,o=0;o<n.length;o++)n[o].status!==r.COMPLETED&&(n[i]=n[o],i++);n.length=i,t.setValue(n.length>0?n:null)}t.forEachChild(function(t){e.pruneCompletedTransactionsBelowNode_(t)})},m.Repo.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor(function(t){e.abortTransactionsOnNode_(t)}),this.abortTransactionsOnNode_(r),r.forEachDescendant(function(t){e.abortTransactionsOnNode_(t)}),n},m.Repo.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],o=[],a=-1,s=0;s<e.length;s++)if(e[s].status===r.SENT_NEEDS_ABORT);else if(e[s].status===r.SENT)i.assert(a===s-1,"All SENT items should be at beginning of queue."),a=s,e[s].status=r.SENT_NEEDS_ABORT,e[s].abortReason="set";else if(i.assert(e[s].status===r.RUN,"Unexpected transaction status in abort"),e[s].unwatcher(),o=o.concat(this.serverSyncTree_.ackUserWrite(e[s].currentWriteId,!0)),e[s].onComplete){n.push(e[s].onComplete.bind(null,new Error("set"),!1,null))}-1===a?t.setValue(null):e.length=a+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),o);for(s=0;s<n.length;s++)h.exceptionGuard(n[s])}}},GhMr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Amoq"),i=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var i=function(){var t=o.pendingResponses[o.currentResponseNum];delete o.pendingResponses[o.currentResponseNum];for(var e=function(e){t[e]&&r.exceptionGuard(function(){n.onMessage_(t[e])})},i=0;i<t.length;++i)e(i);if(o.currentResponseNum===o.closeAfterResponse)return o.onClose&&(o.onClose(),o.onClose=null),"break";o.currentResponseNum++},o=this;this.pendingResponses[this.currentResponseNum];){if("break"===i())break}},t}();e.PacketReceiver=i},GstQ:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("n1q+"),i=function(){function t(){this.rootNode_=r.ChildrenNode.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();e.SnapshotHolder=i},"HW/i":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("7Oow"),i=n("DUiD");e.decode=function(t){var e={},n={},o={},a="";try{var s=t.split(".");e=i.jsonEval(r.base64Decode(s[0])||""),n=i.jsonEval(r.base64Decode(s[1])||""),a=s[2],o=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:o,signature:a}},e.isValidTimestamp=function(t){var n,r,i=e.decode(t).claims,o=Math.floor((new Date).getTime()/1e3);return"object"==typeof i&&(i.hasOwnProperty("nbf")?n=i.nbf:i.hasOwnProperty("iat")&&(n=i.iat),r=i.hasOwnProperty("exp")?i.exp:n+86400),o&&n&&r&&o>=n&&o<=r},e.issuedAtTime=function(t){var n=e.decode(t).claims;return"object"==typeof n&&n.hasOwnProperty("iat")?n.iat:null},e.isValidFormat=function(t){var n=e.decode(t),r=n.claims;return!!n.signature&&!!r&&"object"==typeof r&&r.hasOwnProperty("iat")},e.isAdmin=function(t){var n=e.decode(t).claims;return"object"==typeof n&&!0===n.admin}},IIoC:function(module,exports,__webpack_require__){(function(global){(function(){function l(t){return"string"==typeof t}function aa(){}function ba(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function n(t){return"array"==ba(t)}function ca(t){var e=ba(t);return"array"==e||"object"==e&&"number"==typeof t.length}function da(t){return"function"==ba(t)}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function fa(t,e,n){return t.call.apply(t.bind,arguments)}function ha(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function r(t,e,n){return(r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?fa:ha).apply(null,arguments)}function ia(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function u(t,e){function n(){}n.prototype=e.prototype,t.L=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Ab=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function ja(t){if(Error.captureStackTrace)Error.captureStackTrace(this,ja);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function ka(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function ma(t,e){return t<e?-1:t>e?1:0}function na(t,e){e.unshift(t),ja.call(this,ka.apply(null,e)),e.shift()}function oa(t,e){throw new na("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function w(){0!=qa&&(ra[this[q]||(this[q]=++ea)]=this),this.i=this.i,this.w=this.w}function ua(t){t:{for(var e=va,n=t.length,r=l(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:l(t)?t.charAt(e):t[e]}function wa(t){if(!n(t))for(var e=t.length-1;0<=e;e--)delete t[e];t.length=0}function xa(t){return Array.prototype.concat.apply([],arguments)}function ya(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function y(t){return-1!=x.indexOf(t)}function Ba(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Ca(t){var e,n=[],r=0;for(e in t)n[r++]=t[e];return n}function Da(t){var e,n=[],r=0;for(e in t)n[r++]=e;return n}function Ea(t){var e,n={};for(e in t)n[e]=t[e];return n}function Ga(t,e){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(var o=0;o<Fa.length;o++)n=Fa[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ha(t){return Ha[" "](t),t}function Ia(t,e){var n=Ja;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}function Oa(){var t=k.document;return t?t.documentMode:void 0}function Ta(t){return Ia(t,function(){for(var e=0,n=la(String(Pa)).split("."),r=la(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=ma(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||ma(0==a[2].length,0==s[2].length)||ma(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}function A(t,e){this.type=t,this.a=this.target=e,this.Pa=!0}function $a(t,e){if(A.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Ma){t:{try{Ha(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,null===r?(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=l(t.pointerType)?t.pointerType:ab[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}function cb(t){return!(!t||!t[bb])}function eb(t,e,n,r,i){this.listener=t,this.a=null,this.src=e,this.type=n,this.capture=!!r,this.ga=i,this.key=++db,this.Y=this.ca=!1}function fb(t){t.Y=!0,t.listener=null,t.a=null,t.src=null,t.ga=null}function gb(t){this.src=t,this.a={},this.b=0}function ib(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=sa(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(fb(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function jb(t,e,n,r,i){return t=t.a[e.toString()],e=-1,t&&(e=hb(t,n,r,i)),-1<e?t[e]:null}function hb(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ga==r)return i}return-1}function nb(t,e,r,i,o){if(i&&i.once)return ob(t,e,r,i,o);if(n(e)){for(var a=0;a<e.length;a++)nb(t,e[a],r,i,o);return null}return r=pb(r),cb(t)?t.aa(e,r,p(i)?!!i.capture:!!i,o):qb(t,e,r,!1,i,o)}function qb(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=p(i)?!!i.capture:!!i,s=rb(t);if(s||(t[kb]=s=new gb(t)),(n=s.add(e,n,r,a,o)).a)return n;if(r=sb(),n.a=r,r.src=t,r.listener=n,t.addEventListener)Za||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(tb(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return mb++,n}function sb(){var t=ub,e=Xa?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}function ob(t,e,r,i,o){if(n(e)){for(var a=0;a<e.length;a++)ob(t,e[a],r,i,o);return null}return r=pb(r),cb(t)?t.Ha(e,r,p(i)?!!i.capture:!!i,o):qb(t,e,r,!0,i,o)}function vb(t,e,r,i,o){if(n(e))for(var a=0;a<e.length;a++)vb(t,e[a],r,i,o);else i=p(i)?!!i.capture:!!i,r=pb(r),cb(t)?t.va(e,r,i,o):t&&(t=rb(t))&&(e=jb(t,e,r,i,o))&&wb(e)}function wb(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(cb(e))ib(e.c,t);else{var n=t.type,r=t.a;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(tb(n),r):e.addListener&&e.removeListener&&e.removeListener(r),mb--,(n=rb(e))?(ib(n,t),0==n.b&&(n.src=null,e[kb]=null)):fb(t)}}}function tb(t){return t in lb?lb[t]:lb[t]="on"+t}function xb(t,e,n,r){var i=!0;if((t=rb(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.Y&&(o=yb(o,r),i=i&&!1!==o)}return i}function yb(t,e){var n=t.listener,r=t.ga||t.src;return t.ca&&wb(t),n.call(r,e)}function ub(t,e){if(t.Y)return!0;if(!Xa){if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(r=e,e=new $a(r,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.a;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.a=r[i];var o=xb(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.a=r[i],o=xb(r[i],t,!1,e),n=n&&o}return n}return yb(t,new $a(e,this))}function rb(t){return(t=t[kb])instanceof gb?t:null}function pb(t){return da(t)?t:(t[zb]||(t[zb]=function(e){return t.handleEvent(e)}),t[zb])}function B(){w.call(this),this.c=new gb(this),this.P=this,this.J=null}function Ab(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.Y&&a.capture==n){var s=a.listener,u=a.ga||a.src;a.ca&&ib(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Pa}function Bb(t){return!/^\s*$/.test(t)&&/^[\],:{}\s\u2028\u2029]*$/.test(t.replace(/\\["\\\/bfnrtu]/g,"@").replace(/(?:"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)[\s\u2028\u2029]*(?=:|,|]|}|$)/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,""))}function Cb(a){if(a=String(a),Bb(a))try{return eval("("+a+")")}catch(t){}throw Error("Invalid JSON string: "+a)}function Db(t){var e=[];return Eb(new Fb,t,e),e.join("")}function Fb(){}function Eb(t,e,r){if(null==e)r.push("null");else{if("object"==typeof e){if(n(e)){var i=e;e=i.length,r.push("[");for(var o="",a=0;a<e;a++)r.push(o),Eb(t,i[a],r),o=",";return void r.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){r.push("{"),o="";for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&"function"!=typeof(a=e[i])&&(r.push(o),Gb(i,r),r.push(":"),Eb(t,a,r),o=",");return void r.push("}")}e=e.valueOf()}switch(typeof e){case"string":Gb(e,r);break;case"number":r.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":r.push(String(e));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}function Gb(t,e){e.push('"',t.replace(Ib,function(t){var e=Hb[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Hb[t]=e),e}),'"')}function Jb(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Kb(){this.b=this.a=null}function Ob(){var t=Pb,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Lb(){this.next=this.b=this.a=null}function Qb(t){k.setTimeout(function(){throw t},0)}function Sb(){var t=k.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!y("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(""),t.close();var n="callImmediate"+Math.random(),i="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=r(function(t){"*"!=i&&t.origin!=i||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,i)}}}),void 0!==t&&!y("Trident")&&!y("MSIE")){var e=new t,n={},i=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).za;n.za=null,t()}},function(t){i.next={za:t},i=i.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){k.setTimeout(t,0)}}function Ub(){if(-1!=String(k.Promise).indexOf("[native code]")){var t=k.Promise.resolve(void 0);Tb=function(){t.then(Vb)}}else Tb=function(){var t=Vb;!da(k.setImmediate)||k.Window&&k.Window.prototype&&!y("Edge")&&k.Window.prototype.setImmediate==k.setImmediate?(Rb||(Rb=Sb()),Rb(t)):k.setImmediate(t)}}function Vb(){for(var t;t=Ob();){try{t.a.call(t.b)}catch(t){Qb(t)}var e=Nb;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Wb=!1}function Xb(e,n){B.call(this),this.b=e||1,this.a=n||k,this.f=r(this.ib,this),this.g=t()}function Yb(t){t.$=!1,t.K&&(t.a.clearTimeout(t.K),t.K=null)}function Zb(t,e,n){if(da(t))n&&(t=r(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=r(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}function $b(t,e,n){w.call(this),this.f=null!=n?r(t,n):t,this.c=e,this.b=r(this.bb,this),this.a=[]}function ac(t){t.X=Zb(t.b,t.c),t.f.apply(null,t.a)}function C(t){w.call(this),this.b=t,this.a={}}function cc(t){Ba(t.a,function(t,e){this.a.hasOwnProperty(e)&&wb(t)},t),t.a={}}function dc(t,e,n){this.reset(t,e,n,void 0,void 0)}function fc(t){this.f=t,this.b=this.c=this.a=null}function D(t,e){this.name=t,this.value=e}function lc(t){return t.c?t.c:t.a?lc(t.a):(oa("Root logger has no level set."),null)}function oc(t){nc||(nc=new fc(""),mc[""]=nc,nc.c=jc);var e;if(!(e=mc[t])){e=new fc(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=oc(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,mc[t]=e}return e}function E(t,e){t&&t.log(hc,e,void 0)}function pc(t,e){t&&t.log(ic,e,void 0)}function F(t,e){t&&t.log(kc,e,void 0)}function qc(){this.a=oc("goog.labs.net.webChannel.WebChannelDebug"),this.b=!0}function rc(t,e,n,r,i,o){H(t,function(){if(t.b)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");a=2<=l.length&&"type"==l[1]?a+(h+"=")+c+"&":a+(h+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a})}function sc(t,e,n,r,i,o,a){H(t,function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a})}function tc(t,e,n,r){H(t,function(){return"XMLHTTP TEXT ("+e+"): "+uc(t,n)+(r?" "+r:"")})}function vc(t,e){H(t,function(){return"TIMEOUT: "+e})}function I(t,e){F(t.a,e)}function wc(t,e,n){(t=t.a)&&t.log(gc,n||"Exception",e)}function H(t,e){pc(t.a,e)}function xc(t,e){(t=t.a)&&t.log(gc,e,void 0)}function uc(t,e){if(!t.b)return e;if(!e)return null;try{var r=JSON.parse(e);if(r)for(var i=0;i<r.length;i++)if(n(r[i])){var o=r[i];if(!(2>o.length)){var a=o[1];if(n(a)&&!(1>a.length)){var s=a[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var u=1;u<a.length;u++)a[u]=""}}}return Db(r)}catch(n){return I(t,"Exception parsing expected JS array - probably was not JS"),e}}function zc(t){A.call(this,"serverreachability",t)}function Ac(t){yc.dispatchEvent(new zc(yc,t))}function Bc(t){A.call(this,"statevent",t)}function J(t){yc.dispatchEvent(new Bc(yc,t))}function Cc(t){A.call(this,"timingevent",t)}function Dc(t,e,n){yc.dispatchEvent(new Cc(yc,t,e,n))}function Ec(t,e){if(!da(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}function Hc(){}function Ic(t){var e;return(e=t.a)||(e={},Jc(t)&&(e[0]=!0,e[1]=!0),e=t.a=e),e}function Lc(){}function Mc(t){return(t=Jc(t))?new ActiveXObject(t):new XMLHttpRequest}function Jc(t){if(!t.b&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.b=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.b}function K(t,e,n,r){this.i=t,this.b=e,this.f=n,this.T=r||1,this.N=new C(this),this.S=Nc,(t=this.H=new Xb).b=Oc,t.K&&t.$?(Yb(t),t.start()):t.K&&Yb(t),this.j=null,this.c=!1,this.m=this.g=this.h=this.J=this.D=this.U=this.w=null,this.s=[],this.a=null,this.F=0,this.l=this.o=null,this.C=-1,this.B=!1,this.P=0,this.I=null,this.M=!1}function Pc(t,e){switch(t){case 0:return"Non-200 return code ("+e+")";case 1:return"XMLHTTP failure (no data)";case 2:return"HttpConnection timeout";default:return"Unknown error"}}function Sc(t,e,n){t.J=1,t.h=Tc(L(e)),t.m=n,t.M=!0,Uc(t,null)}function Vc(t,e,n,r){t.J=1,t.h=Tc(L(e)),t.m=null,t.M=n,Uc(t,r)}function Uc(e,n){e.D=t(),Wc(e),e.g=L(e.h),Xc(e.g,"t",e.T),e.F=0,e.a=e.i.da(e.i.ia()?n:null),0<e.P&&(e.I=new $b(r(e.Qa,e,e.a),e.P)),e.N.aa(e.a,"readystatechange",e.fb),n=e.j?Ea(e.j):{},e.m?(e.o||(e.o="POST"),n["Content-Type"]="application/x-www-form-urlencoded",e.a.fa(e.g,e.o,e.m,n)):(e.o="GET",e.a.fa(e.g,e.o,null,n)),Ac(1),rc(e.b,e.o,e.g,e.f,e.T,e.m)}function Yc(t){var e=M(t.a),n=t.a.Fa(),r=t.a.W();if(!(3>e||3==e&&!Ka&&!t.a.V())){t.B||4!=e||7==n||Ac(8==n||0>=r?3:2),Zc(t);var i=t.a.W();t.C=i,(n=t.a.V())||I(t.b,function(){return"No response text for uri "+t.g+" status "+i}),t.c=200==i,sc(t.b,t.o,t.g,t.f,t.T,e,i),t.c?(t.M?($c(t,e,n),Ka&&t.c&&3==e&&ad(t)):(tc(t.b,t.f,n,null),bd(t,n)),4==e&&cd(t),t.c&&!t.B&&(4==e?t.i.ua(t):(t.c=!1,Wc(t)))):(400==i&&0<n.indexOf("Unknown SID")?(t.l=3,J(12),E(t.b.a,"XMLHTTP Unknown SID ("+t.f+")")):(t.l=0,J(13),E(t.b.a,"XMLHTTP Bad status "+i+" ("+t.f+")")),cd(t),dd(t))}}function $c(t,e,n){for(var r=!0;!t.B&&t.F<n.length;){var i=ed(t,n);if(i==Rc){4==e&&(t.l=4,J(14),r=!1),tc(t.b,t.f,null,"[Incomplete Response]");break}if(i==Qc){t.l=4,J(15),tc(t.b,t.f,n,"[Invalid Chunk]"),r=!1;break}tc(t.b,t.f,i,null),bd(t,i)}4==e&&0==n.length&&(t.l=1,J(16),r=!1),t.c=t.c&&r,r||(tc(t.b,t.f,n,"[Invalid Chunked Response]"),cd(t),dd(t))}function ad(t){t.N.aa(t.H,"tick",t.eb),t.H.start()}function ed(t,e){var n=t.F,r=e.indexOf("\n",n);return-1==r?Rc:(n=Number(e.substring(n,r)),isNaN(n)?Qc:(r+=1)+n>e.length?Rc:(e=e.substr(r,n),t.F=r+n,e))}function Wc(e){e.U=t()+e.S,fd(e,e.S)}function fd(t,e){if(null!=t.w)throw Error("WatchDog timer not null");t.w=Ec(r(t.cb,t),e)}function Zc(t){t.w&&(k.clearTimeout(t.w),t.w=null)}function dd(t){t.i.Ja()||t.B||t.i.ua(t)}function cd(t){Zc(t);var e=t.I;e&&"function"==typeof e.Z&&e.Z(),t.I=null,Yb(t.H),cc(t.N),t.a&&(e=t.a,t.a=null,e.abort(),e.Z())}function bd(t,e){try{t.i.Ma(t,e),Ac(4)}catch(e){wc(t.b,e,"Error in httprequest callback")}}function gd(t){if(t.v&&"function"==typeof t.v)return t.v();if(l(t))return t.split("");if(ca(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}return Ca(t)}function hd(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(ca(t)||l(t))ta(t,e,void 0);else{if(t.O&&"function"==typeof t.O)var n=t.O();else if(t.v&&"function"==typeof t.v)n=void 0;else if(ca(t)||l(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else n=Da(t);i=(r=gd(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function N(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t){t instanceof N?(n=t.O(),r=t.v()):(n=Da(t),r=Ca(t));for(var i=0;i<n.length;i++)this.set(n[i],r[i])}}function jd(t){t.b={},t.a.length=0,t.c=0}function kd(t,e){return!!O(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&id(t),!0)}function id(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];O(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],O(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function md(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function P(t,e){this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1;var n;t instanceof P?(this.h=void 0!==e?e:t.h,nd(this,t.f),this.j=t.j,od(this,t.b),pd(this,t.i),this.a=t.a,qd(this,rd(t.c)),this.g=t.g):t&&(n=String(t).match(ld))?(this.h=!!e,nd(this,n[1]||"",!0),this.j=sd(n[2]||""),od(this,n[3]||"",!0),pd(this,n[4]),this.a=sd(n[5]||"",!0),qd(this,n[6]||"",!0),this.g=sd(n[7]||"")):(this.h=!!e,this.c=new td(null,this.h))}function L(t){return new P(t)}function nd(t,e,n){t.f=n?sd(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function od(t,e,n){t.b=n?sd(e,!0):e}function pd(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function qd(t,e,n){e instanceof td?(t.c=e,zd(t.c,t.h)):(n||(e=ud(e,Ad)),t.c=new td(e,t.h))}function Q(t,e,n){t.c.set(e,n)}function Xc(t,e,r){n(r)||(r=[String(r)]),Bd(t.c,e,r)}function Tc(e){return Q(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^t()).toString(36)),e}function Cd(t){return t instanceof P?L(t):new P(t,void 0)}function Dd(t,e,n,r){var i=new P(null,void 0);return t&&nd(i,t),e&&od(i,e),n&&pd(i,n),r&&(i.a=r),i}function sd(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ud(t,e,n){return l(t)?(t=encodeURI(t).replace(e,Ed),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ed(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}function td(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function R(t){t.a||(t.a=new N,t.b=0,t.c&&md(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Gd(t,e){R(t),e=Fd(t,e),O(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,kd(t.a,e))}function Hd(t,e){return R(t),e=Fd(t,e),O(t.a.b,e)}function Bd(t,e,n){Gd(t,e),0<n.length&&(t.c=null,t.a.set(Fd(t,e),ya(n)),t.b+=n.length)}function rd(t){var e=new td;return e.c=t.c,t.a&&(e.a=new N(t.a),e.b=t.b),e}function Fd(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function zd(t,e){e&&!t.f&&(R(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Gd(this,e),Bd(this,n,t))},t)),t.f=e}function Id(){this.a=t()}function Kd(){Jd||(Jd=new Id)}function Ld(){Jd||(Jd=new Id)}function Md(){}function Od(){A.call(this,"d")}function Pd(){A.call(this,"c")}function Qd(t,e){this.a=t,this.b=e,this.c=this.i=null,this.h=!1,this.l=null,this.f=-1,this.m=this.g=null}function Rd(t){I(t.b,"TestConnection: starting stage 2");var e=t.a.H.a;if(null!=e)I(t.b,function(){return"Buffered"}),J(4),e?(J(10),Sd(t.a,t,!1)):(J(11),Sd(t.a,t,!0));else{t.c=new K(t,t.b,void 0,void 0),t.c.j=t.i;var n=Td(t.a,t.g,t.l);J(4),Xc(n,"TYPE","xmlhttp");var r=t.a.j,i=t.a.J;r&&i&&Q(n,r,i),Vc(t.c,n,!1,t.g)}}function Vd(){this.a=this.b=null}function S(){this.a=new N}function Wd(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[q]||(t[q]=++ea)):e.charAt(0)+t}function Xd(t,e){this.a=t,this.b=e}function Yd(t){this.g=t||Zd,this.f=k.pa&&k.pa.Ka&&k.pa.Ka()&&k.pa.Ka().Bb?this.g:1,this.a=null,1<this.f&&(this.a=new S),this.b=null,this.c=[]}function $d(t,e){t.a||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(t.f=t.g,t.a=new S,t.b&&(ae(t,t.b),t.b=null))}function be(t){return!!t.b||!!t.a&&t.a.u()>=t.f}function ce(t,e){return t.b?t.b==e:!!t.a&&t.a.contains(e)}function ae(t,e){t.a?t.a.add(e):t.b=e}function de(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.contains(e)&&kd(t.a.a,Wd(e))}function ee(t){if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return ta(t.a.v(),function(t){e=e.concat(t.s)}),e}return ya(t.c)}function fe(t,e){t.c=t.c.concat(e)}function ge(){}function he(){this.a=new ge}function ie(t,e,n){var r=n||"";try{hd(t,function(t,n){var i=t;p(t)&&(i=Db(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function je(t,e){var n=new qc;I(n,"TestLoadImage: loading "+t);var r=new Image;r.onload=ia(ke,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ia(ke,n,r,"TestLoadImage: error",!1,e),r.onabort=ia(ke,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ia(ke,n,r,"TestLoadImage: timeout",!1,e),k.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}function ke(t,e,n,r,i){try{I(t,n),e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(e){wc(t,e)}}function T(t){B.call(this),this.headers=new N,this.F=t||null,this.f=!1,this.D=this.a=null,this.M=this.s="",this.j=0,this.g="",this.h=this.I=this.o=this.H=!1,this.l=0,this.B=null,this.N=le,this.C=this.m=!1}function qe(t){return z&&Ta(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function va(t){return"content-type"==t.toLowerCase()}function oe(t,e){t.f=!1,t.a&&(t.h=!0,t.a.abort(),t.h=!1),t.g=e,t.j=5,re(t),se(t)}function re(t){t.H||(t.H=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function te(t){if(t.f&&void 0!==goog)if(t.D[1]&&4==M(t)&&2==t.W())F(t.b,U(t,"Local request error detected and ignored"));else if(t.o&&4==M(t))Zb(t.La,0,t);else if(t.dispatchEvent("readystatechange"),4==M(t)){F(t.b,U(t,"Request complete")),t.f=!1;try{var e=t.W();t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break t;default:n=!1}var r;if(!(r=n)){var i;if(i=0===e){var o=String(t.s).match(ld)[1]||null;if(!o&&k.self&&k.self.location){var a=k.self.location.protocol;o=a.substr(0,a.length-1)}i=!me.test(o?o.toLowerCase():"")}r=i}r?(t.dispatchEvent("complete"),t.dispatchEvent("success")):(t.j=6,t.g=t.Ga()+" ["+t.W()+"]",re(t))}finally{se(t)}}}function se(t,e){if(t.a){pe(t);var n=t.a,r=t.D[0]?aa:null;t.a=null,t.D=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(gc,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function pe(t){t.a&&t.C&&(t.a.ontimeout=null),t.B&&(k.clearTimeout(t.B),t.B=null)}function M(t){return t.a?t.a.readyState:0}function U(t,e){return e+" ["+t.M+" "+t.s+" "+t.W()+"]"}function ue(t){var e="";return Ba(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function ve(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=ue(n),l(t)){if(e=encodeURIComponent(String(e)),n=null!=n?"="+encodeURIComponent(String(n)):"",e+=n){if(0>(n=t.indexOf("#"))&&(n=t.length),0>(r=t.indexOf("?"))||r>n){r=n;var i=""}else i=t.substring(r+1,n);n=(t=[t.substr(0,r),i,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return Q(t,e,n),t}function we(t){this.ya=0,this.g=[],this.a=new qc,this.H=new Vd,this.ja=this.wa=this.F=this.ka=this.b=this.J=this.j=this.U=this.h=this.M=this.i=null,this.Ua=this.P=0,this.la=this.B=this.o=this.m=this.l=this.f=null,this.s=this.xa=this.N=-1,this.T=this.w=this.C=0,this.S=t&&t.supportsCrossDomainXhr||!1,this.I="",this.c=new Yd(t&&t.concurrentRequestLimit),this.ma=new he,this.D=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,this.Ta=t&&t.fastHandshake||!1,t&&t.Ea&&this.a.Ea()}function xe(e){if(I(e.a,"disconnect()"),ye(e),3==e.G){var n=e.P++,r=L(e.F);Q(r,"SID",e.I),Q(r,"RID",n),Q(r,"TYPE","terminate"),ze(e,r),(n=new K(e,e.a,n,void 0)).J=2,n.h=Tc(L(r)),r=!1,k.navigator&&k.navigator.sendBeacon&&(r=k.navigator.sendBeacon(n.h.toString(),"")),!r&&k.Image&&((new Image).src=n.h,r=!0),r||(n.a=n.i.da(null),n.a.fa(n.h)),n.D=t(),Wc(n)}Ae(e)}function ye(t){t.B&&(t.B.abort(),t.B=null),t.b&&(t.b.cancel(),t.b=null),t.m&&(k.clearTimeout(t.m),t.m=null),Be(t),t.c.cancel(),t.l&&(k.clearTimeout(t.l),t.l=null)}function Ce(t,e){1e3==t.g.length&&xc(t.a,function(){return"Already have 1000 queued maps upon queueing "+Db(e)}),t.g.push(new Xd(t.Ua++,e)),3==t.G&&De(t)}function De(t){be(t.c)||t.l||(t.l=Ec(r(t.Oa,t),0),t.C=0)}function Ee(t,e){var n=t.c;return(n.b?1:n.a?n.a.u():0)>=t.c.f-(t.l?1:0)?(xc(t.a,"Unexpected retry request is scheduled."),!1):t.l?(I(t.a,"Use the retry request that is already scheduled."),t.g=e.s.concat(t.g),!0):!(1==t.G||2==t.G||2<=t.C)&&(I(t.a,"Going to retry POST"),t.l=Ec(r(t.Oa,t,e),Fe(t,t.C)),t.C++,!0)}function He(t,e){var n;n=e?e.f:t.P++;var r=L(t.F);Q(r,"SID",t.I),Q(r,"RID",n),Q(r,"AID",t.N),ze(t,r),t.h&&t.i&&ve(r,t.h,t.i),n=new K(t,t.a,n,t.C+1),null===t.h&&(n.j=t.i),e&&(t.g=e.s.concat(t.g)),e=Ge(t,n),n.setTimeout(Math.round(1e4)+Math.round(1e4*Math.random())),ae(t.c,n),Sc(n,r,e)}function ze(t,e){t.f&&hd({},function(t,n){Q(e,n,t)})}function Ge(t,e){var n=Math.min(t.g.length,1e3),i=t.f?r(t.f.Va,t.f,t):null;t:for(var o=t.g,a=-1;;){var s=["count="+n];-1==a?0<n?(a=o[0].a,s.push("ofs="+a)):a=0:s.push("ofs="+a);for(var u=!0,c=0;c<n;c++){var h=o[c].a,l=o[c].b;if(0>(h-=a))a=Math.max(0,o[c].a-100),u=!1;else try{ie(l,s,"req"+h+"_")}catch(t){i&&i(l)}}if(u){i=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,i}function Ie(t){if(!t.b&&!t.m){t.T=1;var e=t.Na;Tb||Ub(),Wb||(Tb(),Wb=!0),Pb.add(e,t),t.w=0}}function Je(t){return t.b||t.m?(xc(t.a,"Request already in progress"),!1):!(3<=t.w)&&(I(t.a,"Going to retry GET"),t.T++,t.m=Ec(r(t.Na,t),Fe(t,t.w)),t.w++,!0)}function Sd(t,e,n){I(t.a,"Test Connection Finished");var r=e.m;r&&$d(t.c,r),t.la=n,t.s=e.f,I(t.a,"connectChannel_()"),t.F=Ke(t,t.ka),De(t)}function Ud(t,e){I(t.a,"Test Connection Failed"),t.s=e.f,V(t,2)}function Be(t){null!=t.o&&(k.clearTimeout(t.o),t.o=null)}function Fe(t,e){var n=5e3+Math.floor(1e4*Math.random());return t.ra()||(I(t.a,"Inactive channel"),n*=2),n*e}function V(t,e){if(H(t.a,"Error code "+e),2==e){var n=null;t.f&&(n=null);var i=r(t.hb,t);n||(n=new P("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||nd(n,"https"),Tc(n)),je(n.toString(),i)}else J(2);I(t.a,"HttpChannel: error - "+e),t.G=0,t.f&&t.f.Ba(e),Ae(t),ye(t)}function Ae(t){if(t.G=0,t.s=-1,t.f){var e=ee(t.c);0==e.length&&0==t.g.length||(I(t.a,function(){return"Number of undelivered maps, pending: "+e.length+", outgoing: "+t.g.length}),t.c.c.length=0,ya(t.g),t.g.length=0),t.f.Aa()}}function Ke(t,e){return e=Le(t,null,e),I(t.a,"GetForwardChannelUri: "+e),e}function Td(t,e,n){return e=Le(t,t.ia()?e:null,n),I(t.a,"GetBackChannelUri: "+e),e}function Le(t,e,n){var r=Cd(n);if(""!=r.b)e&&od(r,e+"."+r.b),pd(r,r.i);else{var i,o=k.location;i=e?e+"."+o.hostname:o.hostname,r=Dd(o.protocol,i,o.port,n)}return t.U&&Ba(t.U,function(t,e){Q(r,e,t)}),e=t.j,n=t.J,e&&n&&Q(r,e,n),Q(r,"VER",t.oa),ze(t,r),r}function Me(){}function Ne(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r=arguments[n];if(0==r.lastIndexOf("/",0))e=r;else{var i;(i=""==e)||(i=e.length-1,i=0<=i&&e.indexOf("/",i)==i),e+=i?r:"/"+r}}return e}function Oe(){if(z&&!(10<=Number(Ua)))throw Error("Environmental error: no available transport.")}function W(t,e){B.call(this),this.a=new we(e),this.b=t,this.s=e&&e.testUrl?e.testUrl:Ne(this.b,"test"),this.f=oc("goog.labs.net.webChannel.WebChannelBaseTransport"),this.g=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),this.a.M=t,(t=e&&e.httpHeadersOverwriteParam)&&!/^[\s\xa0]*$/.test(t)&&(this.a.h=t),this.o=e&&e.supportsCrossDomainXhr||!1,this.m=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!/^[\s\xa0]*$/.test(e)&&(this.a.j=e,null!==(t=this.g)&&e in t&&(t=this.g,e in t&&delete t[e],E(this.f,"Ignore httpSessionIdParam also specified with messageUrlParams: "+e))),this.h=new Pe(this)}function Qe(t){Od.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Re(){Pd.call(this),this.status=1}function Pe(t){this.a=t}function Te(){this.b=[],this.a=[]}function Ue(t){return 0==t.b.length&&(t.b=t.a,t.b.reverse(),t.a=[]),t.b.pop()}function Ve(t,e){if(w.call(this),this.h=t||0,this.c=e||10,this.h>this.c)throw Error(We);this.a=new Te,this.b=new S,this.g=null,this.ba()}function Xe(t){if("function"==typeof t.Z)t.Z();else for(var e in t)t[e]=null}function Ye(t,e){this.a=t,this.b=e}function Ze(t){if(this.a=[],t)t:{if(t instanceof Ze){var e=t.O();if(t=t.v(),0>=this.u()){for(var n=this.a,r=0;r<e.length;r++)n.push(new Ye(e[r],t[r]));break t}}else e=Da(t),t=Ca(t);for(r=0;r<e.length;r++)$e(this,e[r],t[r])}}function $e(t,e,n){var r=t.a;for(r.push(new Ye(e,n)),e=r.length-1,n=(t=t.a)[e];0<e&&(r=e-1>>1,t[r].a>n.a);)t[e]=t[r],e=r;t[e]=n}function af(){Ze.call(this)}function X(t,e){this.f=new af,Ve.call(this,t,e)}function Y(t,e,n,r){this.l=t,this.j=!!r,X.call(this,e,n)}var g,goog=goog||{},k=this,q="closure_uid_"+(1e9*Math.random()>>>0),ea=0,t=Date.now||function(){return+new Date};u(ja,Error),ja.prototype.name="CustomError";var la=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};u(na,ja),na.prototype.name="AssertionError";var qa=0,ra={};w.prototype.i=!1,w.prototype.Z=function(){if(!this.i&&(this.i=!0,this.A(),0!=qa)){var t=this[q]||(this[q]=++ea);delete ra[t]}},w.prototype.A=function(){if(this.w)for(;this.w.length;)this.w.shift()()};var sa=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(l(t))return l(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},ta=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=l(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},x;t:{var za=k.navigator;if(za){var Aa=za.userAgent;if(Aa){x=Aa;break t}}x=""}var Fa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");Ha[" "]=aa;var Ka=y("Opera"),z=y("Trident")||y("MSIE"),La=y("Edge"),Ma=y("Gecko")&&!(-1!=x.toLowerCase().indexOf("webkit")&&!y("Edge"))&&!(y("Trident")||y("MSIE"))&&!y("Edge"),Na=-1!=x.toLowerCase().indexOf("webkit")&&!y("Edge"),Pa;t:{var Qa="",Ra=function(){var t=x;return Ma?/rv:([^\);]+)(\)|;)/.exec(t):La?/Edge\/([\d\.]+)/.exec(t):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Na?/WebKit\/(\S+)/.exec(t):Ka?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Ra&&(Qa=Ra?Ra[1]:""),z){var Sa=Oa();if(null!=Sa&&Sa>parseFloat(Qa)){Pa=String(Sa);break t}}Pa=Qa}var Ja={},Ua,Va=k.document;Ua=Va&&z?Oa()||("CSS1Compat"==Va.compatMode?parseInt(Pa,10):5):void 0;var Wa=Object.freeze||function(t){return t},Xa=!z||9<=Number(Ua),Ya=z&&!Ta("9"),Za=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return k.addEventListener("test",aa,e),k.removeEventListener("test",aa,e),t}();A.prototype.b=function(){this.Pa=!1},u($a,A);var ab=Wa({2:"touch",3:"pen",4:"mouse"});$a.prototype.b=function(){$a.L.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ya)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var bb="closure_listenable_"+(1e6*Math.random()|0),db=0;gb.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=hb(t,e,r,i);return-1<a?(e=t[a],n||(e.ca=!1)):(e=new eb(e,this.src,o,!!r,i),e.ca=n,t.push(e)),e};var kb="closure_lm_"+(1e6*Math.random()|0),lb={},mb=0,zb="__closure_events_fn_"+(1e9*Math.random()>>>0);u(B,w),B.prototype[bb]=!0,g=B.prototype,g.addEventListener=function(t,e,n,r){nb(this,t,e,n,r)},g.removeEventListener=function(t,e,n,r){vb(this,t,e,n,r)},g.dispatchEvent=function(t){var e,n=this.J;if(n)for(e=[];n;n=n.J)e.push(n);n=this.P;var r=t.type||t;if(l(t))t=new A(t,n);else if(t instanceof A)t.target=t.target||n;else{var i=t;Ga(t=new A(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=Ab(a,r,!0,t)&&i}if(a=t.a=n,i=Ab(a,r,!0,t)&&i,i=Ab(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)a=t.a=e[o],i=Ab(a,r,!1,t)&&i;return i},g.A=function(){if(B.L.A.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)0,fb(n[r]);delete e.a[t],e.b--}}this.J=null},g.aa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},g.Ha=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)},g.va=function(t,e,n,r){var i=this.c;if((t=String(t).toString())in i.a){var o=i.a[t];-1<(e=hb(o,e,n,r))&&(fb(o[e]),Array.prototype.splice.call(o,e,1),0==o.length&&(delete i.a[t],i.b--))}};var Hb={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Ib=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;Jb.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Nb=new Jb(function(){return new Lb},function(t){t.reset()});Kb.prototype.add=function(t,e){var n=Nb.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Lb.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Lb.prototype.reset=function(){this.next=this.b=this.a=null};var Rb,Tb,Wb=!1,Pb=new Kb;u(Xb,B),g=Xb.prototype,g.$=!1,g.K=null,g.ib=function(){if(this.$){var e=t()-this.g;0<e&&e<.8*this.b?this.K=this.a.setTimeout(this.f,this.b-e):(this.K&&(this.a.clearTimeout(this.K),this.K=null),this.dispatchEvent("tick"),this.$&&(this.K=this.a.setTimeout(this.f,this.b),this.g=t()))}},g.start=function(){this.$=!0,this.K||(this.K=this.a.setTimeout(this.f,this.b),this.g=t())},g.A=function(){Xb.L.A.call(this),Yb(this),delete this.a},u($b,w),g=$b.prototype,g.ha=!1,g.X=null,g.Xa=function(t){this.a=arguments,this.X?this.ha=!0:ac(this)},g.A=function(){$b.L.A.call(this),this.X&&(k.clearTimeout(this.X),this.X=null,this.ha=!1,this.a=[])},g.bb=function(){this.X=null,this.ha&&(this.ha=!1,ac(this))},u(C,w);var bc=[];C.prototype.aa=function(t,e,r,i){n(e)||(e&&(bc[0]=e.toString()),e=bc);for(var o=0;o<e.length;o++){var a=nb(t,e[o],r||this.handleEvent,i||!1,this.b||this);if(!a)break;this.a[a.key]=a}return this},C.prototype.va=function(t,e,r,i,o){if(n(e))for(var a=0;a<e.length;a++)this.va(t,e[a],r,i,o);else r=r||this.handleEvent,i=p(i)?!!i.capture:!!i,o=o||this.b||this,r=pb(r),i=!!i,(e=cb(t)?jb(t.c,String(e),r,i,o):t&&(t=rb(t))?jb(t,e,r,i,o):null)&&(wb(e),delete this.a[e.key])},C.prototype.A=function(){C.L.A.call(this),cc(this)},C.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},dc.prototype.a=null;var ec=0;dc.prototype.reset=function(e,n,r,i,o){"number"==typeof o||ec++,i||t(),delete this.a},D.prototype.toString=function(){return this.name};var gc=new D("SEVERE",1e3),hc=new D("WARNING",900),ic=new D("INFO",800),jc=new D("CONFIG",700),kc=new D("FINE",500);fc.prototype.log=function(t,e,n){if(t.value>=lc(this).value)for(da(e)&&(e=e()),t=new dc(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var mc={},nc=null;qc.prototype.Ea=function(){this.b=!1};var yc=new B;u(zc,A),u(Bc,A),u(Cc,A);var Fc={NO_ERROR:0,jb:1,qb:2,pb:3,mb:4,ob:5,rb:6,Ra:7,TIMEOUT:8,ub:9},Gc={lb:"complete",yb:"success",Sa:"error",Ra:"abort",wb:"ready",xb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",vb:"progress",nb:"downloadprogress",zb:"uploadprogress"};Hc.prototype.a=null;var Kc;u(Lc,Hc),Kc=new Lc;var Nc=45e3,Oc=250,Qc={},Rc={};g=K.prototype,g.setTimeout=function(t){this.S=t},g.fb=function(t){t=t.target;var e=this.I;e&&3==M(t)?(I(this.b,"Throttling readystatechange."),e.Xa()):this.Qa(t)},g.Qa=function(t){try{t==this.a?Yc(this):E(this.b.a,"Called back with an unexpected xmlhttp")}catch(t){if(I(this.b,"Failed call to OnXmlHttpReadyStateChanged_"),this.a&&this.a.V()){var e=this;wc(this.b,t,function(){return"ResponseText: "+e.a.V()})}else wc(this.b,t,"No response text")}},g.eb=function(){var t=M(this.a),e=this.a.V();this.F<e.length&&(Zc(this),$c(this,t,e),this.c&&4!=t&&Wc(this))},g.cancel=function(){this.B=!0,cd(this)},g.cb=function(){this.w=null;var e=t();0<=e-this.U?(this.c&&xc(this.b,"Received watchdog timeout even though request loaded successfully"),vc(this.b,this.g),2!=this.J&&(Ac(3),J(17)),cd(this),this.l=2,dd(this)):(E(this.b.a,"WatchDog timer called too early"),fd(this,this.U-e))},g=N.prototype,g.u=function(){return this.c},g.v=function(){id(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},g.O=function(){return id(this),this.a.concat()},g.get=function(t,e){return O(this.b,t)?this.b[t]:e},g.set=function(t,e){O(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},g.forEach=function(t,e){for(var n=this.O(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ld=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;P.prototype.toString=function(){var t=[],e=this.f;e&&t.push(ud(e,vd,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(ud(e,vd,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(ud(n,"/"==n.charAt(0)?wd:xd,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",ud(n,yd)),t.join("")},P.prototype.resolve=function(t){var e=L(this),n=!!t.f;n?nd(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?od(e,t.b):n=null!=t.i;var r=t.a;if(n)pd(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?qd(e,rd(t.c)):n=!!t.g,n&&(e.g=t.g),e};var vd=/[#\/\?@]/g,xd=/[#\?:]/g,wd=/[#\?]/g,Ad=/[#\?@]/g,yd=/#/g;g=td.prototype,g.u=function(){return R(this),this.b},g.add=function(t,e){R(this),this.c=null,t=Fd(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},g.forEach=function(t,e){R(this),this.a.forEach(function(n,r){ta(n,function(n){t.call(e,n,r,this)},this)},this)},g.O=function(){R(this);for(var t=this.a.v(),e=this.a.O(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},g.v=function(t){R(this);var e=[];if(l(t))Hd(this,t)&&(e=xa(e,this.a.get(Fd(this,t))));else{t=this.a.v();for(var n=0;n<t.length;n++)e=xa(e,t[n])}return e},g.set=function(t,e){return R(this),this.c=null,t=Fd(this,t),Hd(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},g.get=function(t,e){return 0<(t=t?this.v(t):[]).length?String(t[0]):e},g.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.O(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.v(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var Jd=null;Id.prototype.set=function(t){this.a=t},Id.prototype.reset=function(){this.set(t())},Id.prototype.get=function(){return this.a},u(Ld,Kd);var Nd={OPEN:"a",kb:"b",Sa:"c",tb:"d"};u(Od,A),u(Pd,A),g=Qd.prototype,g.R=null,g.da=function(t){return this.a.da(t)},g.abort=function(){this.c&&(this.c.cancel(),this.c=null),this.f=-1},g.Ja=function(){return!1},g.Ma=function(t,e){if(this.f=t.C,0==this.R){if(I(this.b,"TestConnection: Got data for stage 1"),!this.a.D&&(t=t.a)){var n=t.a?t.a.getResponseHeader("X-Client-Wire-Protocol"):null;this.m=n||null,this.a.j&&((t=t.a?t.a.getResponseHeader("X-HTTP-Session-Id"):null)?this.a.J=t:E(this.b.a,"Missing X_HTTP_SESSION_ID in the handshake response"))}if(e){try{var r=this.a.ma.a.parse(e)}catch(t){return wc(this.b,t),void Ud(this.a,this)}this.g=r[0]}else I(this.b,"TestConnection: Null responseText"),Ud(this.a,this)}else 1==this.R&&(this.h?J(6):"11111"==e?(J(5),this.h=!0,(!z||10<=Number(Ua))&&(this.f=200,this.c.cancel(),I(this.b,"Test connection succeeded; using streaming connection"),J(11),Sd(this.a,this,!0))):(J(7),this.h=!1))},g.ua=function(){this.f=this.c.C,this.c.c?0==this.R?(this.R=1,I(this.b,"TestConnection: request complete for initial check"),Rd(this)):1==this.R&&(I(this.b,"TestConnection: request complete for stage 2"),this.h?(I(this.b,"Test connection succeeded; using streaming connection"),J(11),Sd(this.a,this,!0)):(I(this.b,"Test connection failed; not using streaming"),J(10),Sd(this.a,this,!1))):(I(this.b,"TestConnection: request failed, in state "+this.R),0==this.R?J(8):1==this.R&&J(9),Ud(this.a,this))},g.ia=function(){return this.a.ia()},g.ra=function(){return this.a.ra()},S.prototype.u=function(){return this.a.u()},S.prototype.add=function(t){this.a.set(Wd(t),t)},S.prototype.contains=function(t){return t=Wd(t),O(this.a.b,t)},S.prototype.v=function(){return this.a.v()};var Zd=10;Yd.prototype.cancel=function(){this.c=ee(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(ta(this.a.v(),function(t){t.cancel()}),jd(this.a.a))},ge.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},ge.prototype.parse=function(t){return k.JSON.parse(t,void 0)},u(T,B);var le="";T.prototype.b=oc("goog.net.XhrIo");var me=/^https?$/i,ne=["POST","PUT"];g=T.prototype,g.fa=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.s+"; newUri="+t);e=e?e.toUpperCase():"GET",this.s=t,this.g="",this.j=0,this.M=e,this.H=!1,this.f=!0,this.a=this.F?Mc(this.F):Mc(Kc),this.D=this.F?Ic(this.F):Ic(Kc),this.a.onreadystatechange=r(this.La,this);try{F(this.b,U(this,"Opening Xhr")),this.I=!0,this.a.open(e,String(t),!0),this.I=!1}catch(t){return F(this.b,U(this,"Error opening Xhr: "+t.message)),void oe(this,t)}t=n||"";var o=new N(this.headers);i&&hd(i,function(t,e){o.set(e,t)}),i=ua(o.O()),n=k.FormData&&t instanceof k.FormData,!(0<=sa(ne,e))||i||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.N&&(this.a.responseType=this.N),"withCredentials"in this.a&&this.a.withCredentials!==this.m&&(this.a.withCredentials=this.m);try{pe(this),0<this.l&&(this.C=qe(this.a),F(this.b,U(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.C)),this.C?(this.a.timeout=this.l,this.a.ontimeout=r(this.Ia,this)):this.B=Zb(this.Ia,this.l,this)),F(this.b,U(this,"Sending request")),this.o=!0,this.a.send(t),this.o=!1}catch(t){F(this.b,U(this,"Send error: "+t.message)),oe(this,t)}},g.Ia=function(){void 0!==goog&&this.a&&(this.g="Timed out after "+this.l+"ms, aborting",this.j=8,F(this.b,U(this,this.g)),this.dispatchEvent("timeout"),this.abort(8))},g.abort=function(t){this.a&&this.f&&(F(this.b,U(this,"Aborting")),this.f=!1,this.h=!0,this.a.abort(),this.h=!1,this.j=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),se(this))},g.A=function(){this.a&&(this.f&&(this.f=!1,this.h=!0,this.a.abort(),this.h=!1),se(this,!0)),T.L.A.call(this)},g.La=function(){this.i||(this.I||this.o||this.h?te(this):this.ab())},g.ab=function(){te(this)},g.W=function(){try{return 2<M(this)?this.a.status:-1}catch(t){return-1}},g.Ga=function(){try{return 2<M(this)?this.a.statusText:""}catch(t){return F(this.b,"Can not get status: "+t.message),""}},g.V=function(){try{return this.a?this.a.responseText:""}catch(t){return F(this.b,"Can not get responseText: "+t.message),""}},g.Ya=function(t){if(this.a){var e=this.a.responseText;t&&0==e.indexOf(t)&&(e=e.substring(t.length));t:{if(t=e,k.JSON)try{var n=k.JSON.parse(t);break t}catch(t){}n=Cb(t)}return n}},g.Fa=function(){return this.j},g.Za=function(){return l(this.g)?this.g:String(this.g)},g=we.prototype,g.oa=8,g.G=1,g.Ja=function(){return 0==this.G},g.Oa=function(t){if(this.l=null,I(this.a,"startForwardChannel_"),1==this.G)if(t)xc(this.a,"Not supposed to retry the open");else{I(this.a,"open_()"),this.P=Math.floor(1e5*Math.random()),t=this.P++;var e=new K(this,this.a,t,void 0),n=this.i;this.M&&(n?(n=Ea(n),Ga(n,this.M)):n=this.M),null===this.h&&(e.j=n);var r=Ge(this,e),i=L(this.F);Q(i,"RID",t),Q(i,"CVER",21),this.D&&this.j&&Q(i,"X-HTTP-Session-Id",this.j),ze(this,i),this.h&&n&&ve(i,this.h,n),ae(this.c,e),this.Ta?(Q(i,"$req",r),Sc(e,i,null)):Sc(e,i,r),this.G=2}else 3==this.G&&(t?He(this,t):0==this.g.length?I(this.a,"startForwardChannel_ returned: nothing to send"):be(this.c)?xc(this.a,"startForwardChannel_ returned: connection already in progress"):(He(this),I(this.a,"startForwardChannel_ finished, sent request")))},g.Na=function(){this.m=null,I(this.a,"Creating new HttpRequest"),this.b=new K(this,this.a,"rpc",this.T),null===this.h&&(this.b.j=this.i),this.b.P=0;var t=L(this.wa);Q(t,"RID","rpc"),Q(t,"SID",this.I),Q(t,"CI",this.la?"0":"1"),Q(t,"AID",this.N),ze(this,t),Q(t,"TYPE","xmlhttp"),this.h&&this.i&&ve(t,this.h,this.i),Vc(this.b,t,!0,this.ja),I(this.a,"New Request created")},g.Ma=function(t,e){if(0!=this.G&&(this.b==t||ce(this.c,t)))if(this.s=t.C,ce(this.c,t)&&3==this.G){try{var i=this.ma.a.parse(e)}catch(t){i=null}if(n(i)&&3==i.length)if(0==(e=i)[0])t:if(I(this.a,"Server claims our backchannel is missing."),this.m)I(this.a,"But we are currently starting the request.");else{if(this.b){if(!(this.b.D+3e3<t.D))break t;Be(this),this.b.cancel(),this.b=null}else E(this.a.a,"We do not have a BackChannel established");Je(this),J(18)}else this.xa=e[1],0<(t=this.xa-this.N)&&(e=e[2],I(this.a,e+" bytes (in "+t+" arrays) are outstanding on the BackChannel"),37500>e&&this.la&&0==this.w&&!this.o&&(this.o=Ec(r(this.$a,this),6e3)));else I(this.a,"Bad POST response data returned"),V(this,11)}else if(this.b==t&&Be(this),!/^[\s\xa0]*$/.test(e))for(e=i=this.ma.a.parse(e),i=0;i<e.length;i++){var o=e[i];if(this.N=o[0],o=o[1],2==this.G)if("c"==o[0]){this.I=o[1],this.ja=o[2];var a=o[3];null!=a&&(this.oa=a,H(this.a,"VER="+this.oa)),null!=(o=o[4])&&(this.ya=o,H(this.a,"SVER="+this.ya)),this.D&&(o=t.a)&&((a=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)&&$d(this.c,a),this.j&&((o=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)?(this.J=o,Q(this.F,this.j,o)):E(this.a.a,"Missing X_HTTP_SESSION_ID in the handshake response"))),this.G=3,this.f&&this.f.Da(),this.wa=Td(this,this.ja,this.ka),Ie(this)}else"stop"!=o[0]&&"close"!=o[0]||V(this,7);else 3==this.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?V(this,7):xe(this):"noop"!=o[0]&&this.f&&this.f.Ca(o),this.w=0)}},g.$a=function(){null!=this.o&&(this.o=null,this.b.cancel(),this.b=null,Je(this),J(19))},g.ua=function(e){I(this.a,"Request complete");var n=null;if(this.b==e){Be(this),this.b=null;var r=2}else{if(!ce(this.c,e))return;n=e.s,de(this.c,e),r=1}if(this.s=e.C,0!=this.G)if(e.c)1==r?(Dc(e.m?e.m.length:0,t()-e.D,this.C),De(this)):Ie(this);else{var i=e.l;if(3==i||0==i&&0<this.s)I(this.a,"Not retrying due to error type");else{var o=this;if(I(this.a,function(){return"Maybe retrying, last error: "+Pc(i,o.s)}),1==r&&Ee(this,e)||2==r&&Je(this))return;I(this.a,"Exceeded max number of retries")}switch(n&&0<n.length&&fe(this.c,n),I(this.a,"Error: HTTP request failed"),i){case 1:V(this,5);break;case 4:V(this,10);break;case 3:V(this,6);break;default:V(this,2)}}},g.hb=function(t){t?(H(this.a,"Successfully pinged google.com"),J(2)):(H(this.a,"Failed to ping google.com"),J(1))},g.da=function(t){if(t&&!this.S)throw Error("Can't create secondary domain capable XhrIo object.");return t=new T,t.m=this.S,t},g.ra=function(){return!!this.f&&!0},g.ia=function(){return this.S},new Ld,g=Me.prototype,g.Da=function(){},g.Ca=function(){},g.Ba=function(){},g.Aa=function(){},g.Va=function(){},Oe.prototype.a=function(t,e){return new W(t,e)},u(W,B),W.prototype.j=function(){this.a.f=this.h,this.o&&(this.a.S=!0);var t=this.a,e=this.s,n=this.b,r=this.g||void 0;I(t.a,"connect()"),J(0),t.ka=n,t.U=r||{},t.D&&(I(t.a,"connect() bypassed channel-test."),t.H.b=[],t.H.a=!1),I(t.a,"connectTest_()"),t.B=new Qd(t,t.a),null===t.h&&(t.B.i=t.i),n=e,t.h&&t.i&&(n=ve(e,t.h,t.i)),(t=t.B).l=n,e=Ke(t.a,t.l),J(3),null!=(n=t.a.H.b)?(t.g=n[0],t.R=1,Rd(t)):(Xc(e,"MODE","init"),!t.a.D&&t.a.j&&Xc(e,"X-HTTP-Session-Id",t.a.j),t.c=new K(t,t.b,void 0,void 0),t.c.j=t.i,Vc(t.c,e,!1,null),t.R=0)},W.prototype.close=function(){xe(this.a)},W.prototype.l=function(t){if(l(t)){var e={};e.__data__=t,Ce(this.a,e)}else this.m?(e={},e.__data__=Db(t),Ce(this.a,e)):Ce(this.a,t)},W.prototype.A=function(){this.a.f=null,delete this.h,xe(this.a),delete this.a,W.L.A.call(this)},u(Qe,Od),u(Re,Pd),u(Pe,Me),Pe.prototype.Da=function(){pc(this.a.f,"WebChannel opened on "+this.a.b),this.a.dispatchEvent("a")},Pe.prototype.Ca=function(t){this.a.dispatchEvent(new Qe(t))},Pe.prototype.Ba=function(t){pc(this.a.f,"WebChannel aborted on "+this.a.b+" due to channel error: "+t),this.a.dispatchEvent(new Re(t))},Pe.prototype.Aa=function(){pc(this.a.f,"WebChannel closed on "+this.a.b),this.a.dispatchEvent("b")};var Se=ia(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},Oe);Te.prototype.u=function(){return this.b.length+this.a.length},Te.prototype.contains=function(t){return 0<=sa(this.b,t)||0<=sa(this.a,t)},Te.prototype.v=function(){for(var t=[],e=this.b.length-1;0<=e;--e)t.push(this.b[e]);var n=this.a.length;for(e=0;e<n;++e)t.push(this.a[e]);return t},u(Ve,w);var We="[goog.structs.Pool] Min can not be greater than max";g=Ve.prototype,g.ea=function(){var e=t();if(!(null!=this.g&&0>e-this.g)){for(var n;0<this.a.u()&&(n=Ue(this.a),!this.ta(n));)this.ba();return!n&&this.u()<this.c&&(n=this.qa()),n&&(this.g=e,this.b.add(n)),n}},g.gb=function(t){return!!kd(this.b.a,Wd(t))&&(this.na(t),!0)},g.na=function(t){kd(this.b.a,Wd(t)),this.ta(t)&&this.u()<this.c?this.a.a.push(t):Xe(t)},g.ba=function(){for(var t=this.a;this.u()<this.h;){var e=this.qa();t.a.push(e)}for(;this.u()>this.c&&0<this.a.u();)Xe(Ue(t))},g.qa=function(){return{}},g.ta=function(t){return"function"!=typeof t.Wa||t.Wa()},g.contains=function(t){return this.a.contains(t)||this.b.contains(t)},g.u=function(){return this.a.u()+this.b.u()},g.A=function(){if(Ve.L.A.call(this),0<this.b.u())throw Error("[goog.structs.Pool] Objects not released");delete this.b;for(var t=this.a;0!=t.b.length||0!=t.a.length;)Xe(Ue(t));delete this.a},Ze.prototype.v=function(){for(var t=this.a,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].b);return e},Ze.prototype.O=function(){for(var t=this.a,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].a);return e},Ze.prototype.u=function(){return this.a.length},u(af,Ze),u(X,Ve),g=X.prototype,g.ea=function(t,e){if(!t)return X.L.ea.call(this);$e(this.f,void 0!==e?e:100,t),this.sa()},g.sa=function(){for(var t=this.f;0<t.u();){var e=this.ea();if(!e)break;var n=t,r=n.a,i=r.length,o=r[0];if(0>=i)o=void 0;else{if(1==i)wa(r);else{r[0]=r.pop(),r=0,i=(n=n.a).length;for(var a=n[r];r<i>>1;){var s=2*r+1,u=2*r+2;if(s=u<i&&n[u].a<n[s].a?u:s,n[s].a>a.a)break;n[r]=n[s],r=s}n[r]=a}o=o.b}o.apply(this,[e])}},g.na=function(t){X.L.na.call(this,t),this.sa()},g.ba=function(){X.L.ba.call(this),this.sa()},g.A=function(){X.L.A.call(this),k.clearTimeout(void 0),wa(this.f.a),this.f=null},u(Y,X),Y.prototype.qa=function(){var t=new T,e=this.l;return e&&e.forEach(function(e,n){t.headers.set(n,e)}),this.j&&(t.m=!0),t},Y.prototype.ta=function(t){return!t.i&&!t.a},Oe.prototype.createWebChannel=Oe.prototype.a,W.prototype.send=W.prototype.l,W.prototype.open=W.prototype.j,W.prototype.close=W.prototype.close,Fc.NO_ERROR=0,Fc.TIMEOUT=8,Fc.HTTP_ERROR=6,Gc.COMPLETE="complete",Md.EventType=Nd,Nd.OPEN="a",Nd.CLOSE="b",Nd.ERROR="c",Nd.MESSAGE="d",B.prototype.listen=B.prototype.aa,Y.prototype.getObject=Y.prototype.ea,Y.prototype.releaseObject=Y.prototype.gb,T.prototype.listenOnce=T.prototype.Ha,T.prototype.getLastError=T.prototype.Za,T.prototype.getLastErrorCode=T.prototype.Fa,T.prototype.getStatus=T.prototype.W,T.prototype.getStatusText=T.prototype.Ga,T.prototype.getResponseJson=T.prototype.Ya,T.prototype.getResponseText=T.prototype.V,T.prototype.getResponseText=T.prototype.V,T.prototype.send=T.prototype.fa,module.exports={createWebChannelTransport:Se,ErrorCode:Fc,EventType:Gc,WebChannel:Md,XhrIoPool:Y}}).call(void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(exports,__webpack_require__("DuR2"))},IbAO:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("U1HK"),i=n("s7Gl"),o=n("KbSj"),a=n("mnK5"),s=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=r.OperationType.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new o.Path(e));return n.isEmpty()?null:n.value?new i.Overwrite(this.source,o.Path.Empty,n.value):new t(this.source,o.Path.Empty,n)}return a.assert(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}();e.Merge=s},Iq0B:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Amoq"),i=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new o(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.equals(t)})},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.contains(t)||t.contains(e)})},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];if(r){t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1}}e&&(this.eventLists_=[]),this.recursionDepth_--},t}();e.EventQueue=i;var o=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();r.logger&&r.log("event: "+e.toString()),r.exceptionGuard(n)}}},t.prototype.getPath=function(){return this.path_},t}();e.EventList=o},Izak:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n("mnK5"),o=n("Amoq"),a=n("2/he"),s=n("n1q+"),u=n("NxJK"),c=n("4AKd"),h=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,i.assert(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return r(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?o.nameCompare(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=c.nodeFromJSON(t),r=s.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,n);return new u.NamedNode(e,r)},e.prototype.maxPost=function(){var t=s.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,s.MAX_NODE);return new u.NamedNode(o.MAX_NAME,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(a.Index);e.PathIndex=h},IzwH:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("lscU"),o=n("n1q+"),a=n("sC/S"),s=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,o,a,s){r.assert(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var u=t.getImmediateChild(e);return u.getChild(o).equals(n.getChild(o))&&u.isEmpty()==n.isEmpty()?t:(null!=s&&(n.isEmpty()?t.hasChild(e)?s.trackChildChange(i.Change.childRemovedChange(e,u)):r.assert(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):u.isEmpty()?s.trackChildChange(i.Change.childAddedChange(e,n)):s.trackChildChange(i.Change.childChangedChange(e,n,u))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(a.PRIORITY_INDEX,function(t,r){e.hasChild(t)||n.trackChildChange(i.Change.childRemovedChange(t,r))}),e.isLeafNode()||e.forEachChild(a.PRIORITY_INDEX,function(e,r){if(t.hasChild(e)){var o=t.getImmediateChild(e);o.equals(r)||n.trackChildChange(i.Change.childChangedChange(e,r,o))}else n.trackChildChange(i.Change.childAddedChange(e,r))})),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?o.ChildrenNode.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}();e.IndexedFilter=s},K6hM:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("ovUe"),i=n("XpTC"),o=n("+1fU"),a=n("AmnR");e.DataConnection=i.PersistentConnection,i.PersistentConnection.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},i.PersistentConnection.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)},e.RealTimeConnection=a.Connection,e.hijackHash=function(t){var e=i.PersistentConnection.prototype.put;return i.PersistentConnection.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){i.PersistentConnection.prototype.put=e}},e.ConnectionTarget=r.RepoInfo,e.queryIdentifier=function(t){return t.queryIdentifier()},e.listens=function(t){return t.repo.persistentConnection_.listens_},e.forceRestClient=function(t){o.RepoManager.getInstance().forceRestClient(t)}},KbSj:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Amoq"),i=n("mnK5"),o=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!0,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),i=e.slice(),o=0;o<n.length&&o<i.length;o++){var a=r.nameCompare(n[o],i[o]);if(0!==a)return a}return n.length===i.length?0:n.length<i.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}();e.Path=o;var a=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=i.stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=i.stringLength(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=i.stringLength(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}();e.ValidationPath=a},KgKr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Amoq"),i=function(){function t(t){this.app_=t}return t.prototype.getToken=function(t){return this.app_.INTERNAL.getToken(t).then(null,function(t){return t&&"auth/token-not-initialized"===t.code?(r.log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})},t.prototype.addTokenChangeListener=function(t){this.app_.INTERNAL.addAuthTokenListener(t)},t.prototype.removeTokenChangeListener=function(t){this.app_.INTERNAL.removeAuthTokenListener(t)},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',r.warn(t)},t}();e.AuthTokenProvider=i},KyhF:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n("mnK5"),o=n("Amoq"),a=n("mnK5"),s=n("mnK5"),u=n("mnK5"),c=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=o.logWrapper("p:rest:"),i.listens_={},i}return r(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(i.assert(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var o=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var h=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",h,function(t,e){var n=e;if(404===t&&(n=null,t=null),null===t&&o.onDataUpdate_(a,n,!1,r),s.safeGet(o.listens_,u)===c){i(t?401==t?"permission_denied":"rest_error:"+t:"ok",null)}})},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then(function(i){var s=i&&i.accessToken;s&&(e.auth=s);var c=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?"+u.querystring(e);r.log_("Sending REST request for "+c);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(n&&4===h.readyState){r.log_("REST Response for "+c+" received. status:",h.status,"response:",h.responseText);var t=null;if(h.status>=200&&h.status<300){try{t=a.jsonEval(h.responseText)}catch(t){o.warn("Failed to parse JSON response for "+c+": "+h.responseText)}n(null,t)}else 401!==h.status&&404!==h.status&&o.warn("Got unsuccessful REST response for "+c+" Status: "+h.status),n(h.status);n=null}},h.open("GET",c,!0),h.send()})},e}(n("RcG9").ServerActions);e.ReadonlyRestClient=c},L7k2:function(t,e,n){"use strict";function r(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument "}Object.defineProperty(e,"__esModule",{value:!0}),e.validateArgCount=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i){var o=t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}},e.errorPrefix=r,e.validateNamespace=function(t,e,n,i){if((!i||n)&&"string"!=typeof n)throw new Error(r(t,e,i)+"must be a valid firebase namespace.")},e.validateCallback=function(t,e,n,i){if((!i||n)&&"function"!=typeof n)throw new Error(r(t,e,i)+"must be a valid function.")},e.validateContextObject=function(t,e,n,i){if((!i||n)&&("object"!=typeof n||null===n))throw new Error(r(t,e,i)+"must be a valid context object.")}},MB0S:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="FirebaseError",i=Error.captureStackTrace;e.patchCapture=function(t){var e=i;return i=t,e};var o=function(){return function(t,e){if(this.code=t,this.message=e,i)i(this,a.prototype.create);else{var n=Error.apply(this,arguments);this.name=r,Object.defineProperty(this,"stack",{get:function(){return n.stack}})}}}();e.FirebaseError=o,o.prototype=Object.create(Error.prototype),o.prototype.constructor=o,o.prototype.name=r;var a=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return t.prototype.create=function(t,e){void 0===e&&(e={});var n,r=this.errors[t],i=this.service+"/"+t;n=void 0===r?"Error":r.replace(this.pattern,function(t,n){var r=e[n];return void 0!==r?r.toString():"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+i+").";var a=new o(i,n);for(var s in e)e.hasOwnProperty(s)&&"_"!==s.slice(-1)&&(a[s]=e[s]);return a},t}();e.ErrorFactory=a},MUsR:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"}},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("7+uW"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("nav",[e("div",{staticClass:"nav-wrapper green"},[e("div",{staticClass:"container"},[e("router-link",{staticClass:"brand-logo",attrs:{to:"/"}},[this._v("Employee Manager")])],1)])])},staticRenderFns:[]},o={name:"app",components:{Navbar:n("VU/8")(null,i,!1,null,null,null).exports}},a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("Navbar"),this._v(" "),e("div",{staticClass:"container"},[e("router-view")],1)],1)},staticRenderFns:[]},s=n("VU/8")(o,a,!1,null,null,null).exports,u=n("/ocq"),c=n("YiEk"),h=n.n(c),l=(n("n5gG"),h.a.initializeApp({apiKey:"AIzaSyCSNl1XCYLTZjfysxI4M7hovBlZIcYnYE8",authDomain:"vuejs-ce263.firebaseapp.com",databaseURL:"https://vuejs-ce263.firebaseio.com",projectId:"vuejs-ce263",storageBucket:"vuejs-ce263.appspot.com",messagingSenderId:"986674628749"}).firestore()),f={name:"dashboard",data:function(){return{employees:[]}},created:function(){var t=this;l.collection("employees").orderBy("name").get().then(function(e){e.forEach(function(e){console.log(e.data());var n={id:e.id,employee_id:e.data().employee_id,name:e.data().name,dpt:e.data().dpt,position:e.data().position};t.employees.push(n)})})}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"dashboard"}},[n("ul",{staticClass:"collection with-header"},[t._m(0),t._v(" "),t._l(t.employees,function(e){return n("li",{key:e.id,staticClass:"collection-item"},[n("div",{staticClass:"chip"},[t._v(t._s(e.dpt))]),t._v("\n            "+t._s(e.employee_id)+":"+t._s(e.name)+"\n\n            "),n("router-link",{staticClass:"secondary-content",attrs:{to:{name:"view-employee",params:{employee_id:e.employee_id}}}},[n("i",{staticClass:"fa fa-eye"})])],1)})],2),t._v(" "),n("div",{staticClass:"fixed-action-btn"},[n("router-link",{staticClass:"btn-floating btn-large red",attrs:{to:"/new"}},[n("i",{staticClass:"fa fa-plus"})])],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"collection-header"},[e("h4",[this._v("Employees")])])}]},d=n("VU/8")(f,p,!1,null,null,null).exports,y={name:"new-employee",data:function(){return{employee_id:null,name:null,dpt:null,position:null}},methods:{saveEmployee:function(){var t=this;l.collection("employees").add({employee_id:this.employee_id,name:this.name,dpt:this.dpt,position:this.position}).then(function(e){t.$router.push("/")}).catch(function(t){return console.log(t)})}}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"new-employee"}},[n("h3",[t._v("New Employee")]),t._v(" "),n("div",{staticClass:"row"},[n("form",{staticClass:"col s12",on:{submit:function(e){e.preventDefault(),t.saveEmployee(e)}}},[n("div",{staticClass:"row"},[n("div",{staticClass:"input-field col s12"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.employee_id,expression:"employee_id"}],attrs:{type:"text",required:""},domProps:{value:t.employee_id},on:{input:function(e){e.target.composing||(t.employee_id=e.target.value)}}}),t._v(" "),n("label",[t._v("Employee ID#")])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"input-field col s12"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",required:""},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),t._v(" "),n("label",[t._v("Name")])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"input-field col s12"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.dpt,expression:"dpt"}],attrs:{type:"text",required:""},domProps:{value:t.dpt},on:{input:function(e){e.target.composing||(t.dpt=e.target.value)}}}),t._v(" "),n("label",[t._v("Department")])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"input-field col s12"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.position,expression:"position"}],attrs:{type:"text",required:""},domProps:{value:t.position},on:{input:function(e){e.target.composing||(t.position=e.target.value)}}}),t._v(" "),n("label",[t._v("Position")])])]),t._v(" "),n("button",{staticClass:"btn",attrs:{type:"submit"}},[t._v("Submit")]),t._v(" "),n("router-link",{staticClass:"btn grey",attrs:{to:"/"}},[t._v("Cancel")])],1)])])},staticRenderFns:[]},v=n("VU/8")(y,m,!1,null,null,null).exports,g={name:"view-employee",data:function(){return{employee_id:null,name:null,dpt:null,position:null}},beforeRouteEnter:function(t,e,n){l.collection("employees").where("employee_id","==",t.params.employee_id).get().then(function(t){t.forEach(function(t){n(function(e){e.employee_id=t.data().employee_id,e.name=t.data().name,e.dpt=t.data().dpt,e.position=t.data().position})})})},watch:{$route:"fetchData"},methods:{fetchData:function(){var t=this;l.collection("employees").where("employee_id","==",this.$route.params.employee_id).get().then(function(e){e.forEach(function(e){t.employee_id=e.data().employee_id,t.name=e.data().name,t.dpt=e.data().dpt,t.position=e.data().position})})},deleteEmployee:function(){var t=this;confirm("Are you sure you want to delete that employee?")&&l.collection("employees").where("employee_id","==",this.$route.params.employee_id).get().then(function(e){e.forEach(function(e){e.ref.delete(),t.$router.push("/")})})}}},_={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"view-employee"}},[e("ul",{staticClass:"collection with-header"},[e("li",{staticClass:"collection-header"},[e("h4",[this._v(this._s(this.name))])]),this._v(" "),e("li",{staticClass:"collection-item"},[this._v("Employee ID: "+this._s(this.employee_id))]),this._v(" "),e("li",{staticClass:"collection-item"},[this._v("Department: "+this._s(this.dpt))]),this._v(" "),e("li",{staticClass:"collection-item"},[this._v("Position: "+this._s(this.position))])]),this._v(" "),e("router-link",{staticClass:"btn grey",attrs:{to:"/"}},[this._v("Back")]),this._v(" "),e("button",{staticClass:"btn red",on:{click:this.deleteEmployee}},[this._v("Delete")]),this._v(" "),e("div",{staticClass:"fixed-action-btn"},[e("router-link",{staticClass:"btn-floating btn-large red",attrs:{to:{name:"edit-employee",params:{employee_id:this.employee_id}}}},[e("i",{staticClass:"fa fa-pencil"})])],1)],1)},staticRenderFns:[]},b=n("VU/8")(g,_,!1,null,null,null).exports,w={name:"edit-employee",data:function(){return{employee_id:null,name:null,dpt:null,position:null}},beforeRouteEnter:function(t,e,n){l.collection("employees").where("employee_id","==",t.params.employee_id).get().then(function(t){t.forEach(function(t){n(function(e){e.employee_id=t.data().employee_id,e.name=t.data().name,e.dpt=t.data().dpt,e.position=t.data().position})})})},watch:{$route:"fetchData"},methods:{fetchData:function(){var t=this;l.collection("employees").where("employee_id","==",this.$route.params.employee_id).get().then(function(e){e.forEach(function(e){t.employee_id=e.data().employee_id,t.name=e.data().name,t.dpt=e.data().dpt,t.position=e.data().position})})},updateEmployee:function(){var t=this;l.collection("employees").where("employee_id","==",this.$route.params.employee_id).get().then(function(e){e.forEach(function(e){e.ref.update({employee_id:t.employee_id,name:t.name,dpt:t.dpt,position:t.position}).then(function(){t.$router.push({name:"view-employee",params:{employee_id:t.employee_id}})})})})}}},E={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"edit-employee"}},[n("h3",[t._v("Edit Employee")]),t._v(" "),n("div",{staticClass:"row"},[n("form",{staticClass:"col s12",on:{submit:function(e){e.preventDefault(),t.updateEmployee(e)}}},[n("div",{staticClass:"row"},[n("div",{staticClass:"input-field col s12"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.employee_id,expression:"employee_id"}],attrs:{disabled:"",type:"text",required:""},domProps:{value:t.employee_id},on:{input:function(e){e.target.composing||(t.employee_id=e.target.value)}}}),t._v(" "),n("label",{staticClass:"active"},[t._v("Employee ID#")])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"input-field col s12"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",required:""},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),t._v(" "),n("label",{staticClass:"active"},[t._v("Name")])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"input-field col s12"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.dpt,expression:"dpt"}],attrs:{type:"text",required:""},domProps:{value:t.dpt},on:{input:function(e){e.target.composing||(t.dpt=e.target.value)}}}),t._v(" "),n("label",{staticClass:"active"},[t._v("Department")])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"input-field col s12"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.position,expression:"position"}],attrs:{type:"text",required:""},domProps:{value:t.position},on:{input:function(e){e.target.composing||(t.position=e.target.value)}}}),t._v(" "),n("label",{staticClass:"active"},[t._v("Position")])])]),t._v(" "),n("button",{staticClass:"btn",attrs:{type:"submit"}},[t._v("Submit")]),t._v(" "),n("router-link",{staticClass:"btn grey",attrs:{to:"/"}},[t._v("Cancel")])],1)])])},staticRenderFns:[]},T=n("VU/8")(w,E,!1,null,null,null).exports;r.a.use(u.a);var I=new u.a({routes:[{path:"/",name:"dashboard",component:d},{path:"/new",name:"new-employee",component:v},{path:"/edit/:employee_id",name:"edit-employee",component:T},{path:"/:employee_id",name:"view-employee",component:b}]});r.a.config.productionTip=!1,new r.a({el:"#app",router:I,template:"<App/>",components:{App:s}})},NxJK:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}();e.NamedNode=r},QUqZ:function(t,e,n){"use strict";function r(t){var e={Messaging:I};t.INTERNAL.registerService("messaging",function(t){return self&&"ServiceWorkerGlobalScope"in self?new S(t):new I(t)},e)}Object.defineProperty(e,"__esModule",{value:!0});var i,o=n("mnK5"),a={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key"},s={codes:a,map:(i={},i[a.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",i[a.AVAILABLE_IN_SW]="This method is available in a service worker context.",i[a.SHOULD_BE_INHERITED]="This method should be overriden by extended classes.",i[a.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",i[a.PERMISSION_DEFAULT]="The required permissions were not granted and dismissed instead.",i[a.PERMISSION_BLOCKED]="The required permissions were not granted and blocked instead.",i[a.UNSUPPORTED_BROWSER]="This browser doesn't support the API's required to use the firebase SDK.",i[a.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",i[a.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",i[a.SW_REGISTRATION_EXPECTED]="A service worker registration was the expected input.",i[a.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get any existing Push Subscriptions.",i[a.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",i[a.SW_REG_REDUNDANT]="The service worker being used for push was made redundant.",i[a.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the user to FCM: {$message}",i[a.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing the user to push.",i[a.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response when getting an FCM token.",i[a.USE_SW_BEFORE_GET_TOKEN]="You must call useServiceWorker() before calling getToken() to ensure your service worker is used.",i[a.INVALID_DELETE_TOKEN]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",i[a.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not be performed as the token was not found.",i[a.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker scope could not be performed as the scope was not found.",i[a.BG_HANDLER_FUNCTION_EXPECTED]="The input to setBackgroundMessageHandler() must be a function.",i[a.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a non-existant window client.",i[a.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",i[a.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",i[a.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",i[a.NO_SW_IN_REG]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",i[a.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",i[a.BAD_SCOPE]="The service worker scope must be a string with at least one character.",i[a.BAD_VAPID_KEY]="The public VAPID key must be a string with at least one character.",i[a.BAD_SUBSCRIPTION]="The subscription must be a valid PushSubscription.",i[a.BAD_TOKEN]="The FCM Token used for storage / lookup was not a valid token string.",i[a.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not not a valid push set string.",i[a.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",i)},u=function(t){return function(t){var e=new Uint8Array(t);return window.btoa(String.fromCharCode.apply(null,e))}(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},c=[4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110],h={ENDPOINT:"https://fcm.googleapis.com",APPLICATION_SERVER_KEY:c,SUBSCRIPTION_OPTIONS:{userVisibleOnly:!0,applicationServerKey:new Uint8Array(c)}},l="fcm_token_object_Store",f=function(){function t(){this.errorFactory_=new o.ErrorFactory("messaging","Messaging",s.map),this.openDbPromise_=null}return t.prototype.openDatabase_=function(){return this.openDbPromise_?this.openDbPromise_:(this.openDbPromise_=new Promise(function(e,n){var r=indexedDB.open(t.DB_NAME,1);r.onerror=function(t){n(t.target.error)},r.onsuccess=function(t){e(t.target.result)},r.onupgradeneeded=function(t){var e=t.target.result.createObjectStore(l,{keyPath:"swScope"});e.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),e.createIndex("fcmToken","fcmToken",{unique:!0})}}),this.openDbPromise_)},t.prototype.closeDatabase=function(){var t=this;return this.openDbPromise_?this.openDbPromise_.then(function(e){e.close(),t.openDbPromise_=null}):Promise.resolve()},t.prototype.getTokenDetailsFromToken=function(t){return this.openDatabase_().then(function(e){return new Promise(function(n,r){var i=e.transaction([l]).objectStore(l).index("fcmToken").get(t);i.onerror=function(t){r(t.target.error)},i.onsuccess=function(t){n(t.target.result)}})})},t.prototype.getTokenDetailsFromSWScope_=function(t){return this.openDatabase_().then(function(e){return new Promise(function(n,r){var i=e.transaction([l]).objectStore(l).get(t);i.onerror=function(t){r(t.target.error)},i.onsuccess=function(t){n(t.target.result)}})})},t.prototype.getAllTokenDetailsForSenderId_=function(t){return this.openDatabase_().then(function(e){return new Promise(function(n,r){var i=[],o=e.transaction([l]).objectStore(l).openCursor();o.onerror=function(t){r(t.target.error)},o.onsuccess=function(e){var r=e.target.result;r?(r.value.fcmSenderId===t&&i.push(r.value),r.continue()):n(i)}})})},t.prototype.subscribeToFCM=function(t,e,n){var r=this,i=u(e.getKey("p256dh")),o=u(e.getKey("auth")),a="authorized_entity="+t+"&endpoint="+e.endpoint+"&encryption_key="+i+"&encryption_auth="+o;n&&(a+="&pushSet="+n);var c=new Headers;c.append("Content-Type","application/x-www-form-urlencoded");var l={method:"POST",headers:c,body:a};return fetch(h.ENDPOINT+"/fcm/connect/subscribe",l).then(function(t){return t.json()}).then(function(t){var e=t;if(e.error){var n=e.error.message;throw r.errorFactory_.create(s.codes.TOKEN_SUBSCRIBE_FAILED,{message:n})}if(!e.token)throw r.errorFactory_.create(s.codes.TOKEN_SUBSCRIBE_NO_TOKEN);if(!e.pushSet)throw r.errorFactory_.create(s.codes.TOKEN_SUBSCRIBE_NO_PUSH_SET);return{token:e.token,pushSet:e.pushSet}})},t.prototype.isSameSubscription_=function(t,e){return t.endpoint===e.endpoint&&u(t.getKey("auth"))===e.auth&&u(t.getKey("p256dh"))===e.p256dh},t.prototype.saveTokenDetails_=function(t,e,n,r,i){var o={swScope:e.scope,endpoint:n.endpoint,auth:u(n.getKey("auth")),p256dh:u(n.getKey("p256dh")),fcmToken:r,fcmPushSet:i,fcmSenderId:t};return this.openDatabase_().then(function(t){return new Promise(function(e,n){var r=t.transaction([l],"readwrite").objectStore(l).put(o);r.onerror=function(t){n(t.target.error)},r.onsuccess=function(t){e()}})})},t.prototype.getSavedToken=function(t,e){var n=this;return e instanceof ServiceWorkerRegistration?"string"!=typeof t||0===t.length?Promise.reject(this.errorFactory_.create(s.codes.BAD_SENDER_ID)):this.getAllTokenDetailsForSenderId_(t).then(function(n){if(0!==n.length){var r=n.findIndex(function(n){return e.scope===n.swScope&&t===n.fcmSenderId});if(-1!==r)return n[r]}}).then(function(t){if(t)return e.pushManager.getSubscription().catch(function(t){throw n.errorFactory_.create(s.codes.GET_SUBSCRIPTION_FAILED)}).then(function(e){if(e&&n.isSameSubscription_(e,t))return t.fcmToken})}):Promise.reject(this.errorFactory_.create(s.codes.SW_REGISTRATION_EXPECTED))},t.prototype.createToken=function(t,e){var n=this;if("string"!=typeof t||0===t.length)return Promise.reject(this.errorFactory_.create(s.codes.BAD_SENDER_ID));if(!(e instanceof ServiceWorkerRegistration))return Promise.reject(this.errorFactory_.create(s.codes.SW_REGISTRATION_EXPECTED));var r,i;return e.pushManager.getSubscription().then(function(t){return t||e.pushManager.subscribe(h.SUBSCRIPTION_OPTIONS)}).then(function(e){return r=e,n.subscribeToFCM(t,r)}).then(function(o){return i=o,n.saveTokenDetails_(t,e,r,i.token,i.pushSet)}).then(function(){return i.token})},t.prototype.deleteToken=function(t){var e=this;return"string"!=typeof t||0===t.length?Promise.reject(this.errorFactory_.create(s.codes.INVALID_DELETE_TOKEN)):this.getTokenDetailsFromToken(t).then(function(t){if(!t)throw e.errorFactory_.create(s.codes.DELETE_TOKEN_NOT_FOUND);return e.openDatabase_().then(function(n){return new Promise(function(r,i){var o=n.transaction([l],"readwrite").objectStore(l).delete(t.swScope);o.onerror=function(t){i(t.target.error)},o.onsuccess=function(n){0!==n.target.result?r(t):i(e.errorFactory_.create(s.codes.FAILED_TO_DELETE_TOKEN))}})})})},t}(),p="granted",d="denied",y="messagingSenderId",m=function(){function t(t){var e=this;if(this.errorFactory_=new o.ErrorFactory("messaging","Messaging",s.map),!t.options[y]||"string"!=typeof t.options[y])throw this.errorFactory_.create(s.codes.BAD_SENDER_ID);this.messagingSenderId_=t.options[y],this.tokenManager_=new f,this.app=t,this.INTERNAL={},this.INTERNAL.delete=function(){return e.delete}}return t.prototype.getToken=function(){var t=this,e=this.getNotificationPermission_();return e!==p?e===d?Promise.reject(this.errorFactory_.create(s.codes.NOTIFICATIONS_BLOCKED)):Promise.resolve(null):this.getSWRegistration_().then(function(e){return t.tokenManager_.getSavedToken(t.messagingSenderId_,e).then(function(n){return n||t.tokenManager_.createToken(t.messagingSenderId_,e)})})},t.prototype.deleteToken=function(t){var e=this;return this.tokenManager_.deleteToken(t).then(function(){return e.getSWRegistration_().then(function(t){if(t)return t.pushManager.getSubscription()}).then(function(t){if(t)return t.unsubscribe()})})},t.prototype.getSWRegistration_=function(){throw this.errorFactory_.create(s.codes.SHOULD_BE_INHERITED)},t.prototype.requestPermission=function(){throw this.errorFactory_.create(s.codes.AVAILABLE_IN_WINDOW)},t.prototype.useServiceWorker=function(t){throw this.errorFactory_.create(s.codes.AVAILABLE_IN_WINDOW)},t.prototype.onMessage=function(t,e,n){throw this.errorFactory_.create(s.codes.AVAILABLE_IN_WINDOW)},t.prototype.onTokenRefresh=function(t,e,n){throw this.errorFactory_.create(s.codes.AVAILABLE_IN_WINDOW)},t.prototype.setBackgroundMessageHandler=function(t){throw this.errorFactory_.create(s.codes.AVAILABLE_IN_SW)},t.prototype.delete=function(){return this.tokenManager_.closeDatabase()},t.prototype.getNotificationPermission_=function(){return Notification.permission},t.prototype.getTokenManager=function(){return this.tokenManager_},t}(),v={TYPE_OF_MSG:"firebase-messaging-msg-type",DATA:"firebase-messaging-msg-data"},g=v,_={PUSH_MSG_RECEIVED:"push-msg-received",NOTIFICATION_CLICKED:"notification-clicked"},b=function(t,e){return n={},n[v.TYPE_OF_MSG]=t,n[v.DATA]=e,n;var n},w="/firebase-messaging-sw.js",E="/firebase-cloud-messaging-push-scope",T=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),I=function(t){function e(e){var n=t.call(this,e)||this;return n.registrationToUse_,n.manifestCheckPromise_,n.messageObserver_=null,n.onMessage_=Object(o.createSubscribe)(function(t){n.messageObserver_=t}),n.tokenRefreshObserver_=null,n.onTokenRefresh_=Object(o.createSubscribe)(function(t){n.tokenRefreshObserver_=t}),n.setupSWMessageListener_(),n}return T(e,t),e.prototype.getToken=function(){var e=this;return this.isSupported_()?this.manifestCheck_().then(function(){return t.prototype.getToken.call(e)}):Promise.reject(this.errorFactory_.create(s.codes.UNSUPPORTED_BROWSER))},e.prototype.manifestCheck_=function(){var t=this;if(this.manifestCheckPromise_)return this.manifestCheckPromise_;var e=document.querySelector('link[rel="manifest"]');return this.manifestCheckPromise_=e?fetch(e.href).then(function(t){return t.json()}).catch(function(){return Promise.resolve()}).then(function(e){if(e&&e.gcm_sender_id&&"103953800507"!==e.gcm_sender_id)throw t.errorFactory_.create(s.codes.INCORRECT_GCM_SENDER_ID)}):Promise.resolve(),this.manifestCheckPromise_},e.prototype.requestPermission=function(){var t=this;return Notification.permission===p?Promise.resolve():new Promise(function(e,n){var r=function(r){return r===p?e():n(r===d?t.errorFactory_.create(s.codes.PERMISSION_BLOCKED):t.errorFactory_.create(s.codes.PERMISSION_DEFAULT))},i=Notification.requestPermission(function(t){i||r(t)});i&&i.then(r)})},e.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw this.errorFactory_.create(s.codes.SW_REGISTRATION_EXPECTED);if(void 0!==this.registrationToUse_)throw this.errorFactory_.create(s.codes.USE_SW_BEFORE_GET_TOKEN);this.registrationToUse_=t},e.prototype.onMessage=function(t,e,n){return this.onMessage_(t,e,n)},e.prototype.onTokenRefresh=function(t,e,n){return this.onTokenRefresh_(t,e,n)},e.prototype.waitForRegistrationToActivate_=function(t){var e=this,n=t.installing||t.waiting||t.active;return new Promise(function(r,i){if(n)if("activated"!==n.state)if("redundant"!==n.state){var o=function(){if("activated"===n.state)r(t);else{if("redundant"!==n.state)return;i(e.errorFactory_.create(s.codes.SW_REG_REDUNDANT))}n.removeEventListener("statechange",o)};n.addEventListener("statechange",o)}else i(e.errorFactory_.create(s.codes.SW_REG_REDUNDANT));else r(t);else i(e.errorFactory_.create(s.codes.NO_SW_IN_REG))})},e.prototype.getSWRegistration_=function(){var t=this;return this.registrationToUse_?this.waitForRegistrationToActivate_(this.registrationToUse_):(this.registrationToUse_=null,navigator.serviceWorker.register(w,{scope:E}).catch(function(e){throw t.errorFactory_.create(s.codes.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:e.message})}).then(function(e){return t.waitForRegistrationToActivate_(e).then(function(){return t.registrationToUse_=e,e.update(),e})}))},e.prototype.setupSWMessageListener_=function(){var t=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(e){if(e.data&&e.data[g.TYPE_OF_MSG]){var n=e.data;switch(n[g.TYPE_OF_MSG]){case _.PUSH_MSG_RECEIVED:case _.NOTIFICATION_CLICKED:var r=n[g.DATA];t.messageObserver_.next(r)}}},!1)},e.prototype.isSupported_=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")},e}(m),C=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(t){function e(e){var n=t.call(this,e)||this;return self.addEventListener("push",function(t){return n.onPush_(t)},!1),self.addEventListener("pushsubscriptionchange",function(t){return n.onSubChange_(t)},!1),self.addEventListener("notificationclick",function(t){return n.onNotificationClick_(t)},!1),n.bgMessageHandler_=null,n}return C(e,t),e.prototype.onPush_=function(t){var e,n=this;try{e=t.data.json()}catch(t){return}var r=this.hasVisibleClients_().then(function(t){if(t){if(e.notification||n.bgMessageHandler_)return n.sendMessageToWindowClients_(e)}else{var r=n.getNotificationData_(e);if(r){var i=r.title||"";return self.registration.showNotification(i,r)}if(n.bgMessageHandler_)return n.bgMessageHandler_(e)}});t.waitUntil(r)},e.prototype.onSubChange_=function(t){var e=this,n=this.getToken().then(function(t){if(!t)throw e.errorFactory_.create(s.codes.NO_FCM_TOKEN_FOR_RESUBSCRIBE);var n=null,r=e.getTokenManager();return r.getTokenDetailsFromToken(t).then(function(t){if(!(n=t))throw e.errorFactory_.create(s.codes.INVALID_SAVED_TOKEN);return self.registration.pushManager.subscribe(h.SUBSCRIPTION_OPTIONS)}).then(function(t){return r.subscribeToFCM(n.fcmSenderId,t,n.fcmPushSet)}).catch(function(t){return r.deleteToken(n.fcmToken).then(function(){throw e.errorFactory_.create(s.codes.UNABLE_TO_RESUBSCRIBE,{message:t})})})});t.waitUntil(n)},e.prototype.onNotificationClick_=function(t){var e=this;if(t.notification&&t.notification.data&&t.notification.data.FCM_MSG){t.stopImmediatePropagation(),t.notification.close();var n=t.notification.data.FCM_MSG,r=n.notification.click_action;if(r){var i=this.getWindowClient_(r).then(function(t){return t||self.clients.openWindow(r)}).then(function(t){if(t){n.notification;delete n.notification;var r=b(_.NOTIFICATION_CLICKED,n);return e.attemptToMessageClient_(t,r)}});t.waitUntil(i)}}},e.prototype.getNotificationData_=function(t){if(t&&"object"==typeof t.notification){var e=Object.assign({},t.notification);return e.data=(n={},n.FCM_MSG=t,n),e;var n}},e.prototype.setBackgroundMessageHandler=function(t){if(t&&"function"!=typeof t)throw this.errorFactory_.create(s.codes.BG_HANDLER_FUNCTION_EXPECTED);this.bgMessageHandler_=t},e.prototype.getWindowClient_=function(t){var e=new URL(t).href;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(t){for(var n=null,r=0;r<t.length;r++){if(new URL(t[r].url).href===e){n=t[r];break}}if(n)return n.focus(),n})},e.prototype.attemptToMessageClient_=function(t,e){var n=this;return new Promise(function(r,i){if(!t)return i(n.errorFactory_.create(s.codes.NO_WINDOW_CLIENT_TO_MSG));t.postMessage(e),r()})},e.prototype.hasVisibleClients_=function(){return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(t){return t.some(function(t){return"visible"===t.visibilityState})})},e.prototype.sendMessageToWindowClients_=function(t){var e=this;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(n){var r=b(_.PUSH_MSG_RECEIVED,t);return Promise.all(n.map(function(t){return e.attemptToMessageClient_(t,r)}))})},e.prototype.getSWRegistration_=function(){return Promise.resolve(self.registration)},e}(m),N=n("qQjo");e.registerMessaging=r,r(N.default)},RFlV:function(t,e,n){n("RJVP")},RJVP:function(t,e,n){(function(t){(function(){function t(t){return"string"==typeof t}function e(t){return"boolean"==typeof t}function r(){}function i(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function o(t){return null===t}function a(t){return"array"==i(t)}function s(t){var e=i(t);return"array"==e||"object"==e&&"number"==typeof t.length}function u(t){return"function"==i(t)}function c(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function h(t,e,n){return t.call.apply(t.bind,arguments)}function l(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function f(t,e,n){return(f=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?h:l).apply(null,arguments)}function p(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function d(t,e){function n(){}n.prototype=e.prototype,t.ib=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Rc=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function y(t){if(Error.captureStackTrace)Error.captureStackTrace(this,y);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function m(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function v(t){return Ma.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(Aa,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Ra,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(Oa,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(Pa,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(Da,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(ka,"&#0;")),t):t}function g(t,e){return-1!=t.indexOf(e)}function _(t,e){return t<e?-1:t>e?1:0}function b(t,e){e.unshift(t),y.call(this,m.apply(null,e)),e.shift()}function w(t,e){throw new b("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function E(t,e){return 0<=xa(t,e)}function T(t,e){var n;return(n=0<=(e=xa(t,e)))&&Array.prototype.splice.call(t,e,1),n}function I(e,n){!function(e,n){var r=e.length,i=t(e)?e.split(""):e;for(--r;0<=r;--r)r in i&&n.call(void 0,i[r],r,e)}(e,function(t,r){n.call(void 0,t,r,e)&&1==Array.prototype.splice.call(e,r,1).length&&0})}function C(t){return Array.prototype.concat.apply([],arguments)}function S(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function N(t){return g(La,t)}function A(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function R(t){var e,n=[],r=0;for(e in t)n[r++]=t[e];return n}function O(t){var e,n=[],r=0;for(e in t)n[r++]=e;return n}function P(t){for(var e in t)return!1;return!0}function D(t,e){for(var n in t)if(!(n in e)||t[n]!==e[n])return!1;for(n in e)if(!(n in t))return!1;return!0}function k(t){var e,n={};for(e in t)n[e]=t[e];return n}function M(t,e){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(var o=0;o<ja.length;o++)n=ja[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function L(t){return L[" "](t),t}function x(){var t=Ta.document;return t?t.documentMode:void 0}function F(t){return function(t,e){var n=ts;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=Na(String(Wa)).split("."),r=Na(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=_(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||_(0==a[2].length,0==s[2].length)||_(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}function U(t){t.prototype.then=t.prototype.then,t.prototype.$goog_Thenable=!0}function B(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function V(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function q(t,e){t.g(e),t.b<t.f&&(t.b++,e.next=t.a,t.a=e)}function j(){var t=as,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function W(){this.next=this.b=this.a=null}function K(t){Ta.setTimeout(function(){throw t},0)}function G(t,e){is||function(){if(-1!=String(Ta.Promise).indexOf("[native code]")){var t=Ta.Promise.resolve(void 0);is=function(){t.then(Q)}}else is=function(){var t=Q;!u(Ta.setImmediate)||Ta.Window&&Ta.Window.prototype&&!N("Edge")&&Ta.Window.prototype.setImmediate==Ta.setImmediate?(rs||(rs=function(){var t=Ta.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!N("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(""),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=f(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!N("Trident")&&!N("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).pb;n.pb=null,t()}},function(t){r.next={pb:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){Ta.setTimeout(t,0)}}()),rs(t)):Ta.setImmediate(t)}}(),os||(is(),os=!0);var n=as,r=ns.get();r.set(t,e),n.b?n.b.next=r:n.a=r,n.b=r}function Q(){for(var t;t=j();){try{t.a.call(t.b)}catch(t){K(t)}q(ns,t)}os=!1}function H(t,e){if(this.a=ss,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=r)try{var n=this;t.call(e,function(t){rt(n,us,t)},function(t){if(!(t instanceof ct))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}rt(n,cs,t)})}catch(t){rt(this,cs,t)}}function z(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}function X(t,e,n){var r=hs.get();return r.g=t,r.b=e,r.f=n,r}function Y(t){if(t instanceof H)return t;var e=new H(r);return rt(e,us,t),e}function J(t){return new H(function(e,n){n(t)})}function $(t,e,n){it(t,e,n,null)||G(p(e,t))}function Z(t,e){return e=X(e,e,void 0),e.c=!0,et(t,e),t}function tt(t,e){if(t.a==ss)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==t&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==ss&&1==r?tt(n,e):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):at(n),st(n,i,cs,e)))}t.c=null}else rt(t,cs,e)}function et(t,e){t.b||t.a!=us&&t.a!=cs||ot(t),t.f?t.f.next=e:t.b=e,t.f=e}function nt(t,e,n,r){var i=X(null,null,null);return i.a=new H(function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof ct?o(e):t(i)}catch(t){o(t)}}:o}),i.a.c=t,et(t,i),i.a}function rt(t,e,n){t.a==ss&&(t===n&&(e=cs,n=new TypeError("Promise cannot resolve to itself")),t.a=1,it(n,t.Ac,t.Bc,t)||(t.i=n,t.a=e,t.c=null,ot(t),e!=cs||n instanceof ct||function(t,e){t.g=!0,G(function(){t.g&&ls.call(null,e)})}(t,n)))}function it(t,e,n,i){if(t instanceof H)return et(t,X(e||r,n||null,i)),!0;if(B(t))return t.then(e,n,i),!0;if(c(t))try{var o=t.then;if(u(o))return function(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}function a(t){s||(s=!0,n.call(i,t))}var s=!1;try{e.call(t,a,o)}catch(t){o(t)}}(t,o,e,n,i),!0}catch(t){return n.call(i,t),!0}return!1}function ot(t){t.h||(t.h=!0,G(t.Qb,t))}function at(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function st(t,e,n,r){if(n==cs&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,ut(e,n,r);else try{e.c?e.g.call(e.f):ut(e,n,r)}catch(t){ls.call(null,t)}q(hs,e)}function ut(t,e,n){e==us?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}function ct(t){y.call(this,t)}function ht(){this.a="",this.b=ps}function lt(t){return t instanceof ht&&t.constructor===ht&&t.b===ps?t.a:(w("expected object of type Const, got '"+t+"'"),"type_error:Const")}function ft(t){var e=new ht;return e.a=t,e}function pt(){this.a="",this.b=ms}function dt(t){return t instanceof pt&&t.constructor===pt&&t.b===ms?t.a:(w("expected object of type TrustedResourceUrl, got '"+t+"' of type "+i(t)),"type_error:TrustedResourceUrl")}function yt(t,e){return t=function(t,e){var n=lt(t);if(!ys.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return n.replace(ds,function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof ht?lt(t):encodeURIComponent(String(t))})}(t,e),e=new pt,e.a=t,e}function mt(){this.a="",this.b=gs}function vt(t){return t instanceof mt&&t.constructor===mt&&t.b===gs?t.a:(w("expected object of type SafeUrl, got '"+t+"' of type "+i(t)),"type_error:SafeUrl")}function gt(t){return t instanceof mt?t:(t=t.la?t.ja():String(t),vs.test(t)||(t="about:invalid#zClosurez"),_t(t))}function _t(t){var e=new mt;return e.a=t,e}function bt(){this.a="",this.b=_s}function wt(t){var e=new bt;return e.a=t,e}function Et(e){var n=document;return t(e)?n.getElementById(e):e}function Tt(t,e){A(e,function(e,n){e&&e.la&&(e=e.ja()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:bs.hasOwnProperty(n)?t.setAttribute(bs[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}function It(e,n,r){var i=arguments,o=document,h=String(i[0]),l=i[1];if(!fs&&l&&(l.name||l.type)){if(h=["<",h],l.name&&h.push(' name="',v(l.name),'"'),l.type){h.push(' type="',v(l.type),'"');var f={};M(f,l),delete f.type,l=f}h.push(">"),h=h.join("")}return h=o.createElement(h),l&&(t(l)?h.className=l:a(l)?h.className=l.join(" "):Tt(h,l)),2<i.length&&function(e,n,r){function i(r){r&&n.appendChild(t(r)?e.createTextNode(r):r)}for(var o=2;o<r.length;o++){var a=r[o];!s(a)||c(a)&&0<a.nodeType?i(a):Fa(function(t){if(t&&"number"==typeof t.length){if(c(t))return"function"==typeof t.item||"string"==typeof t.item;if(u(t))return"function"==typeof t.item}return!1}(a)?S(a):a,i)}}(o,h,i),h}function Ct(t){var e=[];return St(new function(){},t,e),e.join("")}function St(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(a(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),St(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){n.push("{"),i="";for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&"function"!=typeof(o=e[r])&&(n.push(i),Nt(r,n),n.push(":"),St(t,o,n),i=",");return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":Nt(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}function Nt(t,e){e.push('"',t.replace(Es,function(t){var e=ws[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),ws[t]=e),e}),'"')}function At(){0!=Ts&&(Is[this[Ia]||(this[Ia]=++Ca)]=this),this.oa=this.oa,this.Fa=this.Fa}function Rt(t){t.oa||(t.oa=!0,t.ta(),0!=Ts&&(t=t[Ia]||(t[Ia]=++Ca),delete Is[t]))}function Ot(t,e){this.type=t,this.b=this.target=e,this.Bb=!0}function Pt(e,n){if(Ot.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var r=this.type=e.type,i=e.changedTouches?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=n,n=e.relatedTarget){if(za){t:{try{L(n.nodeName);var o=!0;break t}catch(t){}o=!1}o||(n=null)}}else"mouseover"==r?n=e.fromElement:"mouseout"==r&&(n=e.toElement);this.relatedTarget=n,null===i?(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=t(e.pointerType)?e.pointerType:Rs[e.pointerType]||"",this.a=e,e.defaultPrevented&&this.c()}}function Dt(t){t.ma=!0,t.listener=null,t.a=null,t.src=null,t.La=null}function kt(t){this.src=t,this.a={},this.b=0}function Mt(t,e,n,r,i,o){var a=e.toString();(e=t.a[a])||(e=t.a[a]=[],t.b++);var s=xt(e,n,i,o);return-1<s?(t=e[s],r||(t.Ha=!1)):(t=new function(t,e,n,r,i){this.listener=t,this.a=null,this.src=e,this.type=n,this.capture=!!r,this.La=i,this.key=++Ps,this.ma=this.Ha=!1}(n,t.src,a,!!i,o),t.Ha=r,e.push(t)),t}function Lt(t,e){var n=e.type;n in t.a&&T(t.a[n],e)&&(Dt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ma&&o.listener==e&&o.capture==!!n&&o.La==r)return i}return-1}function Ft(t,e,n,r,i){if(r&&r.once)Bt(t,e,n,r,i);else if(a(e))for(var o=0;o<e.length;o++)Ft(t,e[o],n,r,i);else n=Ht(n),t&&t[Os]?Yt(t,e,n,c(r)?!!r.capture:!!r,i):Ut(t,e,n,!1,r,i)}function Ut(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=c(i)?!!i.capture:!!i,s=Qt(t);if(s||(t[Ds]=s=new kt(t)),!(n=Mt(s,e,n,r,a,o)).a){if(r=function(){var t=Gt,e=Ss?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.a=r,r.src=t,r.listener=n,t.addEventListener)As||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else{if(!t.attachEvent)throw Error("addEventListener and attachEvent are unavailable.");t.attachEvent(jt(e.toString()),r)}0}}function Bt(t,e,n,r,i){if(a(e))for(var o=0;o<e.length;o++)Bt(t,e[o],n,r,i);else n=Ht(n),t&&t[Os]?Jt(t,e,n,c(r)?!!r.capture:!!r,i):Ut(t,e,n,!0,r,i)}function Vt(t,e,n,r,i){if(a(e))for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);else r=c(r)?!!r.capture:!!r,n=Ht(n),t&&t[Os]?(t=t.u,(e=String(e).toString())in t.a&&(o=t.a[e],-1<(n=xt(o,n,r,i))&&(Dt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=Qt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=xt(e,n,r,i)),(n=-1<t?e[t]:null)&&qt(n))}function qt(t){if("number"!=typeof t&&t&&!t.ma){var e=t.src;if(e&&e[Os])Lt(e.u,t);else{var n=t.type,r=t.a;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent&&e.detachEvent(jt(n),r),0,(n=Qt(e))?(Lt(n,t),0==n.b&&(n.src=null,e[Ds]=null)):Dt(t)}}}function jt(t){return t in ks?ks[t]:ks[t]="on"+t}function Wt(t,e,n,r){var i=!0;if((t=Qt(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.ma&&(o=Kt(o,r),i=i&&!1!==o)}return i}function Kt(t,e){var n=t.listener,r=t.La||t.src;return t.Ha&&qt(t),n.call(r,e)}function Gt(t,e){if(t.ma)return!0;if(!Ss){if(!e)t:{e=["window","event"];for(var n=Ta,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(r=e,e=new Pt(r,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=Wt(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=Wt(r[i],t,!1,e),n=n&&o}return n}return Kt(t,new Pt(e,this))}function Qt(t){return(t=t[Ds])instanceof kt?t:null}function Ht(t){return u(t)?t:(t[Ms]||(t[Ms]=function(e){return t.handleEvent(e)}),t[Ms])}function zt(){At.call(this),this.u=new kt(this),this.Ib=this,this.Ra=null}function Xt(e,n){var r,i=e.Ra;if(i)for(r=[];i;i=i.Ra)r.push(i);if(e=e.Ib,i=n.type||n,t(n))n=new Ot(n,e);else if(n instanceof Ot)n.target=n.target||e;else{var o=n;M(n=new Ot(i,e),o)}if(o=!0,r)for(var a=r.length-1;0<=a;a--){var s=n.b=r[a];o=$t(s,i,!0,n)&&o}if(s=n.b=e,o=$t(s,i,!0,n)&&o,o=$t(s,i,!1,n)&&o,r)for(a=0;a<r.length;a++)s=n.b=r[a],o=$t(s,i,!1,n)&&o}function Yt(t,e,n,r,i){Mt(t.u,String(e),n,!1,r,i)}function Jt(t,e,n,r,i){Mt(t.u,String(e),n,!0,r,i)}function $t(t,e,n,r){if(!(e=t.u.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ma&&a.capture==n){var s=a.listener,u=a.La||a.src;a.Ha&&Lt(t.u,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Bb}function Zt(t,e,n){if(u(t))n&&(t=f(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=f(t.handleEvent,t)}return 2147483647<Number(e)?-1:Ta.setTimeout(t,e||0)}function te(t){var e=null;return new H(function(n,r){-1==(e=Zt(function(){n(void 0)},t))&&r(Error("Failed to schedule timer."))}).s(function(t){throw Ta.clearTimeout(e),t})}function ee(t,e,n,r,i){this.reset(t,e,n,r,i)}function ne(t){this.f=t,this.b=this.c=this.a=null}function re(t,e){this.name=t,this.value=e}function ie(t){return t.c?t.c:t.a?ie(t.a):(w("Root logger has no level set."),null)}function oe(t){Bs||(Bs=new ne(""),Us[""]=Bs,Bs.c=xs);var e;if(!(e=Us[t])){e=new ne(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=oe(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,Us[t]=e}return e}function ae(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t){t instanceof ae?(n=t.S(),r=t.P()):(n=O(t),r=R(t));for(var i=0;i<n.length;i++)this.set(n[i],r[i])}}function se(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ue(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],ue(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function ue(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ce(t,e){t&&t.log(Fs,e,void 0)}function he(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=qs[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Vs){Vs={},qs={};for(var t=0;65>t;t++)Vs[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),qs[Vs[t]]=t,62<=t&&(qs["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,function(t){e+=String.fromCharCode(t)}),e}function le(t,e){this.g=[],this.v=t,this.o=e||null,this.f=this.a=!1,this.c=void 0,this.u=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function fe(t,e,n){t.a=!0,t.c=n,t.f=!e,me(t)}function pe(t){if(t.a){if(!t.u)throw new ve;t.u=!1}}function de(t,e,n,r){t.g.push([e,n,r]),t.a&&me(t)}function ye(t){return Ba(t.g,function(t){return u(t[1])})}function me(t){if(t.h&&t.a&&ye(t)){var e=t.h,n=Ws[e];n&&(Ta.clearTimeout(n.a),delete Ws[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.o,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(B(e)||"function"==typeof Ta.Promise&&e instanceof Ta.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,ye(t)||(n=!0)}}t.c=e,r&&(s=f(t.m,t,!0),r=f(t.m,t,!1),e instanceof le?(de(e,s,r),e.w=!0):e.then(s,r)),n&&(e=new _e(e),Ws[e.a]=e,t.h=e.a)}function ve(){y.call(this)}function ge(){y.call(this)}function _e(t){this.a=Ta.setTimeout(f(this.c,this),0),this.b=t}function be(t,e){this.b=-1,this.b=Ks,this.f=Ta.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=Ta.Int32Array?new Int32Array(64):Array(64),js||(js=Ta.Int32Array?new Int32Array(Xs):Xs),this.reset()}function we(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&l)+(0|js[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function Ee(e,n,r){void 0===r&&(r=n.length);var i=0,o=e.c;if(t(n))for(;i<r;)e.f[o++]=n.charCodeAt(i++),o==e.b&&(we(e),o=0);else{if(!s(n))throw Error("message must be string or array");for(;i<r;){var a=n[i++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");e.f[o++]=a,o==e.b&&(we(e),o=0)}}e.c=o,e.g+=r}function Te(){be.call(this,8,Ys)}function Ie(e){if(e.P&&"function"==typeof e.P)return e.P();if(t(e))return e.split("");if(s(e)){for(var n=[],r=e.length,i=0;i<r;i++)n.push(e[i]);return n}return R(e)}function Ce(e){if(e.S&&"function"==typeof e.S)return e.S();if(!e.P||"function"!=typeof e.P){if(s(e)||t(e)){var n=[];e=e.length;for(var r=0;r<e;r++)n.push(r);return n}return O(e)}}function Se(t,e){if(this.b=this.l=this.c="",this.i=null,this.h=this.g="",this.f=!1,t instanceof Se){this.f=void 0!==e?e:t.f,Ne(this,t.c),this.l=t.l,this.b=t.b,Ae(this,t.i),this.g=t.g,e=t.a;var n=new Fe;n.c=e.c,e.a&&(n.a=new ae(e.a),n.b=e.b),Re(this,n),this.h=t.h}else t&&(n=String(t).match(Js))?(this.f=!!e,Ne(this,n[1]||"",!0),this.l=Me(n[2]||""),this.b=Me(n[3]||"",!0),Ae(this,n[4]),this.g=Me(n[5]||"",!0),Re(this,n[6]||"",!0),this.h=Me(n[7]||"")):(this.f=!!e,this.a=new Fe(null,0,this.f))}function Ne(t,e,n){t.c=n?Me(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Ae(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function Re(t,e,n){e instanceof Fe?(t.a=e,function(t,e){e&&!t.f&&(Ue(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(qe(this,e),We(this,n,t))},t)),t.f=e}(t.a,t.f)):(n||(e=Le(e,eu)),t.a=new Fe(e,0,t.f))}function Oe(t,e,n){t.a.set(e,n)}function Pe(t,e){return t.a.get(e)}function De(t){return t instanceof Se?new Se(t):new Se(t,void 0)}function ke(t,e){var n=new Se(null,void 0);return Ne(n,"https"),t&&(n.b=t),e&&(n.g=e),n}function Me(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Le(e,n,r){return t(e)?(e=encodeURI(e).replace(n,xe),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function xe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}function Fe(t,e,n){this.b=this.a=null,this.c=t||null,this.f=!!n}function Ue(t){t.a||(t.a=new ae,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){Ve(t,decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Be(t){var e=Ce(t);if(void 0===e)throw Error("Keys are undefined");var n=new Fe(null,0,void 0);t=Ie(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];a(o)?We(n,i,o):Ve(n,i,o)}return n}function Ve(t,e,n){Ue(t),t.c=null,e=Ke(t,e);var r=t.a.get(e);r||t.a.set(e,r=[]),r.push(n),t.b+=1}function qe(t,e){Ue(t),e=Ke(t,e),ue(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,t=t.a,ue(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&se(t)))}function je(t,e){return Ue(t),e=Ke(t,e),ue(t.a.b,e)}function We(t,e,n){qe(t,e),0<n.length&&(t.c=null,t.a.set(Ke(t,e),S(n)),t.b+=n.length)}function Ke(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Ge(){}function Qe(t){return t.c||(t.c=t.b())}function He(){}function ze(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Xe(t){zt.call(this),this.headers=new ae,this.w=t||null,this.b=!1,this.v=this.a=null,this.g=this.I=this.i="",this.c=this.G=this.h=this.A=!1,this.f=0,this.m=null,this.l=iu,this.o=this.N=!1}function Ye(e,n,r,i,o){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.i+"; newUri="+n);r=r?r.toUpperCase():"GET",e.i=n,e.g="",e.I=r,e.A=!1,e.b=!0,e.a=e.w?e.w.a():ru.a(),e.v=e.w?Qe(e.w):Qe(ru),e.a.onreadystatechange=f(e.Ab,e);try{ce(e.J,an(e,"Opening Xhr")),e.G=!0,e.a.open(r,String(n),!0),e.G=!1}catch(t){return ce(e.J,an(e,"Error opening Xhr: "+t.message)),void $e(e,t)}n=i||"";var a=new ae(e.headers);o&&function(e,n){if(e.forEach&&"function"==typeof e.forEach)e.forEach(n,void 0);else if(s(e)||t(e))Fa(e,n,void 0);else for(var r=Ce(e),i=Ie(e),o=i.length,a=0;a<o;a++)n.call(void 0,i[a],r&&r[a],e)}(o,function(t,e){a.set(e,t)}),o=function(e){t:{for(var n=Je,r=e.length,i=t(e)?e.split(""):e,o=0;o<r;o++)if(o in i&&n.call(void 0,i[o],o,e)){n=o;break t}n=-1}return 0>n?null:t(e)?e.charAt(n):e[n]}(a.S()),i=Ta.FormData&&n instanceof Ta.FormData,!E(uu,r)||o||i||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),a.forEach(function(t,e){this.a.setRequestHeader(e,t)},e),e.l&&(e.a.responseType=e.l),"withCredentials"in e.a&&e.a.withCredentials!==e.N&&(e.a.withCredentials=e.N);try{nn(e),0<e.f&&(e.o=function(t){return Ga&&F(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(e.a),ce(e.J,an(e,"Will abort after "+e.f+"ms if incomplete, xhr2 "+e.o)),e.o?(e.a.timeout=e.f,e.a.ontimeout=f(e.Ea,e)):e.m=Zt(e.Ea,e.f,e)),ce(e.J,an(e,"Sending request")),e.h=!0,e.a.send(n),e.h=!1}catch(t){ce(e.J,an(e,"Send error: "+t.message)),$e(e,t)}}function Je(t){return"content-type"==t.toLowerCase()}function $e(t,e){t.b=!1,t.a&&(t.c=!0,t.a.abort(),t.c=!1),t.g=e,Ze(t),en(t)}function Ze(t){t.A||(t.A=!0,Xt(t,"complete"),Xt(t,"error"))}function tn(t){if(t.b&&void 0!==Ea)if(t.v[1]&&4==rn(t)&&2==on(t))ce(t.J,an(t,"Local request error detected and ignored"));else if(t.h&&4==rn(t))Zt(t.Ab,0,t);else if(Xt(t,"readystatechange"),4==rn(t)){ce(t.J,an(t,"Request complete")),t.b=!1;try{var e=on(t);t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break t;default:n=!1}var r;if(!(r=n)){var i;if(i=0===e){var o=String(t.i).match(Js)[1]||null;if(!o&&Ta.self&&Ta.self.location){var a=Ta.self.location.protocol;o=a.substr(0,a.length-1)}i=!su.test(o?o.toLowerCase():"")}r=i}if(r)Xt(t,"complete"),Xt(t,"success");else{try{var s=2<rn(t)?t.a.statusText:""}catch(e){ce(t.J,"Can not get status: "+e.message),s=""}t.g=s+" ["+on(t)+"]",Ze(t)}}finally{en(t)}}}function en(t,e){if(t.a){nn(t);var n=t.a,i=t.v[0]?r:null;t.a=null,t.v=null,e||Xt(t,"ready");try{n.onreadystatechange=i}catch(e){(t=t.J)&&t.log(Ls,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function nn(t){t.a&&t.o&&(t.a.ontimeout=null),"number"==typeof t.m&&(Ta.clearTimeout(t.m),t.m=null)}function rn(t){return t.a?t.a.readyState:0}function on(t){try{return 2<rn(t)?t.a.status:-1}catch(t){return-1}}function an(t,e){return e+" ["+t.I+" "+t.i+" "+on(t)+"]"}function sn(t){var e={},n=e.document||document,r=dt(t),i=document.createElement("SCRIPT"),o={Cb:i,Ea:void 0},a=new le(un,o),s=null,u=null!=e.timeout?e.timeout:5e3;return 0<u&&(s=window.setTimeout(function(){cn(i,!0);var t=new hn(lu,"Timeout reached for loading script "+r);pe(a),fe(a,!1,t)},u),o.Ea=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(cn(i,e.Sc||!1,s),a.A(null))},i.onerror=function(){cn(i,!0,s);var t=new hn(hu,"Error while loading script "+r);pe(a),fe(a,!1,t)},o=e.attributes||{},M(o,{type:"text/javascript",charset:"UTF-8"}),Tt(i,o),i.src=dt(t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function un(){if(this&&this.Cb){var t=this.Cb;t&&"SCRIPT"==t.tagName&&cn(t,!0,this.Ea)}}function cn(t,e,n){null!=n&&Ta.clearTimeout(n),t.onload=r,t.onerror=r,t.onreadystatechange=r,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}function hn(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),y.call(this,n),this.code=t}function ln(){}function fn(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseText="",this.status=-1,this.statusText=this.responseXML=null,this.a.onload=f(this.Wb,this),this.a.onerror=f(this.xb,this),this.a.onprogress=f(this.Xb,this),this.a.ontimeout=f(this.Yb,this)}function pn(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function dn(){var t=An();return Ga&&!!Za&&11==Za||/Edge\/\d+/.test(t)}function yn(){return Ta.window&&Ta.window.location.href||""}function mn(t,e){e=e||Ta.window;var n="about:blank";t&&(n=vt(gt(t))),e.location.href=n}function vn(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):a(t[n])?D(t[n],e[n])||r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<vn(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function gn(t){return!!((t=(t||An()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function _n(t){t=t||Ta.window;try{t.close()}catch(t){}}function bn(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var o=(window.screen.availHeight-n)/2,a=(window.screen.availWidth-e)/2;e={width:e,height:n,top:0<o?o:0,left:0<a?a:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=An().toLowerCase(),r&&(e.target=r,g(n,"crios/")&&(e.target="_blank")),Sn(An())==pu&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(r=e)||(r={}),t=window,e=n instanceof mt?n:gt(void 0!==n.href?n.href:String(n)),n=r.target||n.target,o=[];for(s in r)switch(s){case"width":case"height":case"top":case"left":o.push(s+"="+r[s]);break;case"target":case"noreferrer":break;default:o.push(s+"="+(r[s]?1:0))}var s=o.join(",");if((N("iPhone")&&!N("iPod")&&!N("iPad")||N("iPad")||N("iPod"))&&t.navigator&&t.navigator.standalone&&n&&"_self"!=n?(s=t.document.createElement("A"),e instanceof mt||e instanceof mt||(e=e.la?e.ja():String(e),vs.test(e)||(e="about:invalid#zClosurez"),e=_t(e)),s.href=vt(e),s.setAttribute("target",n),r.noreferrer&&s.setAttribute("rel","noreferrer"),(r=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,t,1),s.dispatchEvent(r),s={}):r.noreferrer?(s=t.open("",n,s),t=vt(e),s&&(Ha&&g(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),s.opener=null,ft("b/12014412, meta tag with sanitized URL"),t='<META HTTP-EQUIV="refresh" content="0; url='+v(t)+'">',t=wt(t),s.document.write(function(t){return t instanceof bt&&t.constructor===bt&&t.b===_s?t.a:(w("expected object of type SafeHtml, got '"+t+"' of type "+i(t)),"type_error:SafeHtml")}(t)),s.document.close())):s=t.open(vt(e),n,s),s)try{s.focus()}catch(t){}return s}function wn(){var t=null;return new H(function(e){"complete"==Ta.document.readyState?e():(t=function(){e()},Bt(window,"load",t))}).s(function(e){throw Vt(window,"load",t),e})}function En(t){return t=t||An(),!("file:"!==kn()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Tn(){var t=Ta.window;try{return!(!t||t==t.top)}catch(t){return!1}}function In(){return wa.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":wa.INTERNAL.hasOwnProperty("node")?"Node":"Browser"}function Cn(){var t=In();return"ReactNative"===t||"Node"===t}function Sn(t){var e=t.toLowerCase();return g(e,"opera/")||g(e,"opr/")||g(e,"opios/")?"Opera":g(e,"iemobile")?"IEMobile":g(e,"msie")||g(e,"trident/")?"IE":g(e,"edge/")?"Edge":g(e,"firefox/")?pu:g(e,"silk/")?"Silk":g(e,"blackberry")?"Blackberry":g(e,"webos")?"Webos":!g(e,"safari/")||g(e,"chrome/")||g(e,"crios/")||g(e,"android")?!g(e,"chrome/")&&!g(e,"crios/")||g(e,"edge/")?g(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":du:"Safari"}function Nn(t,e){e=e||[];var n,r=[],i={};for(n in yu)i[yu[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),r=In(),i="",(i="Browser"===r?Sn(An()):r)+"/JsCore/"+t+"/"+e.join(",")}function An(){return Ta.navigator&&Ta.navigator.userAgent||""}function Rn(t,e){t=t.split("."),e=e||Ta;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function On(){try{var t=Ta.localStorage,e=Un();if(t)return t.setItem(e,"1"),t.removeItem(e),!dn()||!!Ta.indexedDB}catch(t){}return!1}function Pn(){return(Dn()||"chrome-extension:"===kn()||En())&&!Cn()&&On()}function Dn(){return"http:"===kn()||"https:"===kn()}function kn(){return Ta.location&&Ta.location.protocol||null}function Mn(t){return t=t||An(),!gn(t)&&Sn(t)!=pu}function Ln(t){return void 0===t?null:Ct(t)}function xn(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Fn(t){if(null!==t)return JSON.parse(t)}function Un(t){return t||""+Math.floor(1e9*Math.random()).toString()}function Bn(t){return t=t||An(),"Safari"!=Sn(t)&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Vn(){var t=Ta.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function qn(){var t=Ta.navigator;return!t||"boolean"!=typeof t.onLine||!Dn()&&"chrome-extension:"!==kn()&&void 0===t.connection||t.onLine}function jn(t,e,n,r){if(t>e)throw Error("Short delay should be less than long delay!");this.c=t,this.b=e,t=n||An(),r=r||In(),this.a=gn(t)||"ReactNative"===r}function Wn(){var t=Ta.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Kn(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function Gn(t,e,n){mu?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Qn(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Gn(t,n,e[n])}function Hn(t){var e={};return Qn(e,t),e}function zn(t){var e=t;if("object"==typeof t&&null!=t){e="length"in t?[]:{};for(var n in t)Gn(e,n,zn(t[n]))}return e}function Xn(t,e){this.code=Su+t,this.message=e||Nu[t]||""}function Yn(t){var e=t&&t.code;return e?new Xn(e.substring(Su.length),t.message):null}function Jn(t){var e=t[Pu];if(void 0===e)throw new Xn("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new Xn("invalid-continue-uri");this.h=e,this.c=this.a=null,this.g=!1;var n=t[Au];if(n&&"object"==typeof n){e=n[Mu];var r=n[Du];if(n=n[ku],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new Xn("argument-error",Du+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Xn("argument-error",ku+" property must be a non empty string when specified.");this.c=n||null}else{if(void 0!==e)throw new Xn("argument-error",Mu+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new Xn("missing-android-pkg-name")}}else if(void 0!==n)throw new Xn("argument-error",Au+" property must be a non null object when specified.");if(this.b=null,(e=t[Ou])&&"object"==typeof e){if("string"==typeof(e=e[Lu])&&e.length)this.b=e;else if(void 0!==e)throw new Xn("argument-error",Lu+" property must be a non empty string when specified.")}else if(void 0!==e)throw new Xn("argument-error",Ou+" property must be a non null object when specified.");if(void 0!==(t=t[Ru])&&"boolean"!=typeof t)throw new Xn("argument-error",Ru+" property must be a boolean when specified.");if((this.f=!!t)&&!this.b&&!this.a)throw new Xn("argument-error",Ru+" property can't be true when no mobile application is provided.")}function $n(t){var e={};e.continueUrl=t.h,e.canHandleCodeInApp=t.f,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.c,e.androidInstallApp=t.g),e.iOSBundleId=t.b;for(var n in e)null===e[n]&&delete e[n];return e}function Zn(t){if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var r=JSON.parse(he(t));if(r.sub&&r.iss&&r.aud&&r.exp)return new function(t){this.b=t.sub,Sa(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null}(r)}catch(t){}return null}function tr(t){for(var e in Uu)if(Uu[e].Na==t)return Uu[e];return null}function er(t){var e={};e["facebook.com"]=ir,e["google.com"]=ar,e["github.com"]=or,e["twitter.com"]=sr;var n=t&&t[Vu];try{if(n)return e[n]?new e[n](t):new rr(t);if(void 0!==t[Bu])return new nr(t)}catch(t){}return null}function nr(t){var e=t[Vu];if(!e&&t[Bu]){var n=Zn(t[Bu]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Gn(this,"providerId",e),Gn(this,"isNewUser",n)}function rr(t){nr.call(this,t),Gn(this,"profile",zn((t=Fn(t.rawUserInfo||"{}"))||{}))}function ir(t){if(rr.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function or(t){if(rr.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Gn(this,"username",this.profile&&this.profile.login||null)}function ar(t){if(rr.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function sr(t){if(rr.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Gn(this,"username",t.screenName||null)}function ur(t,e){return t.then(function(t){if(t[ju]){var n=Zn(t[ju]);if(!n||e!=n.b)throw new Xn("user-mismatch");return t}throw new Xn("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==Su+"user-not-found"?new Xn("user-mismatch"):t})}function cr(t,e){if(e.idToken||e.accessToken)e.idToken&&Gn(this,"idToken",e.idToken),e.accessToken&&Gn(this,"accessToken",e.accessToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Xn("internal-error","failed to construct a credential");Gn(this,"accessToken",e.oauthToken),Gn(this,"secret",e.oauthTokenSecret)}Gn(this,"providerId",t)}function hr(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,{postBody:Be(e).toString(),requestUri:"http://localhost"}}function lr(t,e){this.rc=e||[],Qn(this,{providerId:t,isOAuthProvider:!0}),this.rb={},this.Wa=(tr(t)||{}).Ma||null,this.Ua=null}function fr(t){lr.call(this,t,Fu),this.a=[]}function pr(){fr.call(this,"facebook.com")}function dr(t){if(!t)throw new Xn("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return c(t)&&(e=t.accessToken),(new pr).credential(null,e)}function yr(){fr.call(this,"github.com")}function mr(t){if(!t)throw new Xn("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return c(t)&&(e=t.accessToken),(new yr).credential(null,e)}function vr(){fr.call(this,"google.com"),this.sa("profile")}function gr(t,e){var n=t;return c(t)&&(n=t.idToken,e=t.accessToken),(new vr).credential(n,e)}function _r(){lr.call(this,"twitter.com",xu)}function br(t,e){var n=t;if(c(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Xn("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new cr("twitter.com",n)}function wr(t,e){this.a=t,this.f=e,Gn(this,"providerId","password")}function Er(){Qn(this,{providerId:"password",isOAuthProvider:!1})}function Tr(t){if(!(t.Pa&&t.Oa||t.Da&&t.Y))throw new Xn("internal-error");this.a=t,Gn(this,"providerId","phone")}function Ir(t){return t.a.Da&&t.a.Y?{temporaryProof:t.a.Da,phoneNumber:t.a.Y}:{sessionInfo:t.a.Pa,code:t.a.Oa}}function Cr(t){try{this.a=t||wa.auth()}catch(t){throw new Xn("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Qn(this,{providerId:"phone",isOAuthProvider:!1})}function Sr(t,e){if(!t)throw new Xn("missing-verification-id");if(!e)throw new Xn("missing-verification-code");return new Tr({Pa:t,Oa:e})}function Nr(t){if(t.temporaryProof&&t.phoneNumber)return new Tr({Da:t.temporaryProof,Y:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret;t=t&&t.oauthIdToken;try{switch(e){case"google.com":return gr(t,n);case"facebook.com":return dr(n);case"github.com":return mr(n);case"twitter.com":return br(n,r);default:return new fr(e).credential(t,n)}}catch(t){return null}}function Ar(t){if(!t.isOAuthProvider)throw new Xn("invalid-oauth-provider")}function Rr(t,e,n,r,i){if(this.b=t,this.c=e||null,this.f=n||null,this.g=r||null,this.a=i||null,!this.f&&!this.a)throw new Xn("invalid-auth-event");if(this.f&&this.a)throw new Xn("invalid-auth-event");if(this.f&&!this.g)throw new Xn("invalid-auth-event")}function Or(t){return(t=t||{}).type?new Rr(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Yn(t.error)):null}function Pr(t){var e="unauthorized-domain",n=void 0,r=De(t);t=r.b,"chrome-extension"==(r=r.c)?n=m("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=m("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",Xn.call(this,e,n)}function Dr(t,e,n){Xn.call(this,t,n),(t=e||{}).sb&&Gn(this,"email",t.sb),t.Y&&Gn(this,"phoneNumber",t.Y),t.credential&&Gn(this,"credential",t.credential)}function kr(t){if(t.code){var e=t.code||"";0==e.indexOf(Su)&&(e=e.substring(Su.length));var n={credential:Nr(t)};if(t.email)n.sb=t.email;else{if(!t.phoneNumber)return new Xn(e,t.message||void 0);n.Y=t.phoneNumber}return new Dr(e,n,t.message)}return null}function Mr(t){this.f=t}function Lr(t,e,n){var r="Node"==In();if(!(r=Ta.XMLHttpRequest||r&&wa.INTERNAL.node&&wa.INTERNAL.node.XMLHttpRequest))throw new Xn("internal-error","The XMLHttpRequest compatibility library was not found.");this.b=t,t=e||{},this.i=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.l=t.secureTokenTimeout||Wu,this.c=k(t.secureTokenHeaders||Ku),this.g=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=t.firebaseTimeout||Gu,this.a=k(t.firebaseHeaders||Qu),n&&(this.a["X-Client-Version"]=n,this.c["X-Client-Version"]=n),this.f=new ln,this.o=new Mr(r)}function xr(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Fr(t,e){e?(t.a["X-Client-Version"]=e,t.c["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.c["X-Client-Version"])}function Ur(t,e,n,r,i,o,a){qn()?(function(){var t=An();return!((t=Sn(t)!=du?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Ga&&Za&&!(9<Za))}()?t=f(t.m,t):(qu||(qu=new H(function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{Ta[zu]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var n=yt(Hu,{onload:zu});!function(t,e){de(t,null,e,void 0)}(sn(n),function(){e(Error("CORS_UNSUPPORTED"))})}}(t,e)})),t=f(t.u,t)),t(e,n,r,i,o,a)):n&&n(null)}function Br(t){if(!cu.test(t.email))throw new Xn("invalid-email")}function Vr(t){"email"in t&&Br(t)}function qr(t){if(!t[ju])throw new Xn("internal-error")}function jr(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Xn("internal-error")}else{if(!t.sessionInfo)throw new Xn("missing-verification-id");if(!t.code)throw new Xn("missing-verification-code")}}function Wr(t){if(!t.requestUri||!t.sessionId&&!t.postBody)throw new Xn("internal-error")}function Kr(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=kr(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=kr(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=kr(t)):t.errorMessage&&(e=Yr(t.errorMessage)),e)throw e;if(!t[ju])throw new Xn("internal-error")}function Gr(t,e){return e.returnIdpCredential=!0,Xr(t,pc,e)}function Qr(t,e){return e.returnIdpCredential=!0,Xr(t,yc,e)}function Hr(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Xr(t,dc,e)}function zr(t){if(!t.oobCode)throw new Xn("invalid-action-code")}function Xr(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(void 0===r||null===r||""===r)return!1}return!0}(n,e.ea))return J(new Xn("internal-error"));var r,i=e.zb||"POST";return Y(n).then(e.D).then(function(){return e.T&&(n.returnSecureToken=!0),function(t,e,n,r,i,o){var a=De(t.g+e);Oe(a,"key",t.b),o&&Oe(a,"cb",Sa().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&Oe(a,u,r[u]);return new H(function(e,o){Ur(t,a.toString(),function(t){t?t.error?o(Jr(t,i||{})):e(t):o(new Xn("network-request-failed"))},n,s?void 0:Ct(xn(r)),t.a,t.h.get())})}(t,e.endpoint,i,n,e.Pb,e.nb||!1)}).then(function(t){return r=t}).then(e.O).then(function(){if(!e.ga)return r;if(!(e.ga in r))throw new Xn("internal-error");return r[e.ga]})}function Yr(t){return Jr({error:{errors:[{message:t}],code:400,message:t}})}function Jr(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new Xn(r[n]):null)return n;n=t.error&&t.error.message||"",M(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0;for(var i in r)if(0===n.indexOf(i))return new Xn(r[i],e);return!e&&t&&(e=Ln(t)),new Xn("internal-error",e)}function $r(t){for(var e in wc)if(wc[e].id===t)return t=wc[e],{firebaseEndpoint:t.Va,secureTokenEndpoint:t.ab};return null}function Zr(t){this.b=t,this.a=null,this.Ya=function(t){return(Cc||(Cc=new H(function(t,e){if(qn()){var n=function(){Vn(),Rn("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Vn(),e(Error("Network Error"))},timeout:Tc.get()})};if(Rn("gapi.iframes.Iframe"))t();else if(Rn("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();Ta[r]=function(){Rn("gapi.load")?n():e(Error("Network Error"))},Y(sn(r=yt(Ec,{onload:r}))).s(function(){e(Error("Network Error"))})}}else e(Error("Network Error"))}).s(function(t){throw Cc=null,t}))).then(function(){return new H(function(e,n){Rn("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Rn("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},Ic.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}(this)}function ti(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=ke(this.i,"/__/auth/iframe"),Oe(this.a,"apiKey",this.g),Oe(this.a,"appName",this.h),this.b=null,this.c=[]}function ei(t,e,n,r,i){this.m=t,this.u=e,this.c=n,this.l=r,this.i=this.g=this.h=null,this.a=i,this.f=null}function ni(t){try{return wa.app(t).auth().Ka()}catch(t){return[]}}function ri(t,e,n,r,i){this.u=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.m=this.o=this.v=null,this.g=[],this.l=this.a=null}function ii(t){var e=yn();return function(t){return Xr(t,ac,{}).then(function(t){return t.authorizedDomains||[]})}(t).then(function(t){t:{var n=De(e),r=n.c;n=n.b;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=De(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:fu.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Pr(yn())})}function oi(t){return t.l?t.l:(t.l=wn().then(function(){if(!t.o){var e=t.c,n=t.h,r=ni(t.b),i=new ti(t.u,t.f,t.b);i.f=e,i.b=n,i.c=S(r||[]),t.o=i.toString()}t.i=new Zr(t.o),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.Ya.then(function(){t.a.register("authEvent",e,Rn("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t.i,function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Or(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return n={},n.status=r?"ACK":"ERROR",Y(n)}return n.status="ERROR",Y(n)})}(t)}),t.l)}function ai(t){return t.m||(t.v=t.c?Nn(t.c,ni(t.b)):null,t.m=new Lr(t.f,$r(t.h),t.v)),t.m}function si(t,e,n,r,i,o,a,s,u,c){return t=new ei(t,e,n,r,i),t.h=o,t.g=a,t.i=s,t.b=k(u||null),t.f=c,t.toString()}function ui(t){var e={type:"webStorageSupport"};return oi(t).then(function(){return function(t,e){return t.Ya.then(function(){return new H(function(n){t.a.send(e.type,e,n,Rn("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(t.i,e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})}function ci(t){if(this.a=t||wa.INTERNAL.reactNative&&wa.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Xn("internal-error","The React Native compatibility library was not found.")}function hi(){this.a={}}function li(t,e,n,r,i,o){try{var a=!!Ta.indexedDB}catch(t){a=!1}if(!a)throw new Xn("web-storage-unsupported");this.u=t,this.h=e,this.g=n,this.l=r,this.m=i,this.f={},this.c=[],this.a=0,this.o=o||Ta.indexedDB}function fi(t){return t.i||(t.i=function(t){return new H(function(e,n){var r=t.o.open(t.u,t.m);r.onerror=function(t){n(Error(t.target.errorCode))},r.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore(t.h,{keyPath:t.g})}catch(t){n(t)}},r.onsuccess=function(t){e(t.target.result)}})}(t)),t.i}function pi(t,e){return e.objectStore(t.h)}function di(t,e,n){return e.transaction([t.h],n?"readwrite":"readonly")}function yi(t){return new H(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(Error(t.target.errorCode))}})}function mi(){if(!function(){var t="Node"==In();if(!(t=vi()||t&&wa.INTERNAL.node&&wa.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==In())throw new Xn("internal-error","The LocalStorage compatibility library was not found.");throw new Xn("web-storage-unsupported")}this.a=vi()||wa.INTERNAL.node.localStorage}function vi(){try{var t=Ta.localStorage,e=Un();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function gi(){}function _i(){if(!function(){var t="Node"==In();if(!(t=bi()||t&&wa.INTERNAL.node&&wa.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==In())throw new Xn("internal-error","The SessionStorage compatibility library was not found.");throw new Xn("web-storage-unsupported")}this.a=bi()||wa.INTERNAL.node.sessionStorage}function bi(){try{var t=Ta.sessionStorage,e=Un();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function wi(t,e,n,r,i){this.i=t,this.g=e,this.A=n,this.u=r,this.v=i,this.a={},Nc||(Nc=new function(){var t={};t.Browser=Rc,t.Node=Oc,t.ReactNative=Pc,this.a=t[In()]}),t=Nc;try{if(dn()){Sc||(Sc=new li("firebaseLocalStorageDb","firebaseLocalStorage","fbase_key","value",1));var o=Sc}else o=new t.a.C;this.l=o}catch(t){this.l=new hi,this.u=!0}try{this.o=new t.a.jb}catch(t){this.o=new hi}this.w=new hi,this.h=f(this.m,this),this.b={}}function Ei(){return Ac||(Ac=new wi("firebase",":",!(Bn(An())||!Tn()),Mn(),On())),Ac}function Ti(t,e){switch(e){case"session":return t.o;case"none":return t.w;default:return t.l}}function Ii(t,e,n){return t.i+t.g+e.name+(n?t.g+n:"")}function Ci(t,e,n){return n=Ii(t,e,n),"local"==e.C&&(t.b[n]=null),Ti(t,e.C).X(n)}function Si(t,e,n,r){e=Ii(t,e,n),t.v&&(t.b[e]=Ta.localStorage.getItem(e)),P(t.a)&&(Ti(t,"local").ia(t.h),t.u||dn()||!t.v||function(t){Ai(t),t.f=setInterval(function(){for(var e in t.a){var n=Ta.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Pt({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.m(n))}},1e3)}(t)),t.a[e]||(t.a[e]=[]),t.a[e].push(r)}function Ni(t,e,n){e=Ii(t,Bo("local"),e),t.a[e]&&(I(t.a[e],function(t){return t==n}),0==t.a[e].length&&delete t.a[e]),P(t.a)&&function(t){Ti(t,"local").da(t.h),Ai(t)}(t)}function Ai(t){t.f&&(clearInterval(t.f),t.f=null)}function Ri(t,e,n,r,i,o,a){this.u=t,this.i=e,this.l=n,this.m=r||null,this.o=a||null,this.h=e+":"+n,this.A=new function(){this.a=Ei()},this.g=new function(t){this.a=t,this.b=Ei()}(this.h),this.f=null,this.b=[],this.v=i||500,this.w=o||2e3,this.a=this.c=null}function Oi(t){return new Xn("invalid-cordova-configuration",t)}function Pi(t){var e=new Te;Ee(e,t),t=[];var n=8*e.g;56>e.c?Ee(e,zs,56-e.c):Ee(e,zs,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(we(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return Ua(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(t)}function Di(t,e,n,r){var i=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),o=new Rr(e,r,null,i,new Xn("no-auth-event")),a=Rn("BuildInfo.packageName",Ta);if("string"!=typeof a)throw new Xn("invalid-cordova-configuration");var s=Rn("BuildInfo.displayName",Ta),u={};if(An().toLowerCase().match(/iphone|ipad|ipod/))u.ibi=a;else{if(!An().toLowerCase().match(/android/))return J(new Xn("operation-not-supported-in-this-environment"));u.apn=a}s&&(u.appDisplayName=s),i=Pi(i),u.sessionId=i;var c=si(t.u,t.i,t.l,e,n,null,r,t.m,u,t.o);return t.ba().then(function(){var e=t.h;return t.A.a.set(kc,o.B(),e)}).then(function(){var e=Rn("cordova.plugins.browsertab.isAvailable",Ta);if("function"!=typeof e)throw new Xn("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=Rn("cordova.plugins.browsertab.openUrl",Ta)))throw new Xn("invalid-cordova-configuration");n(c)}else{if("function"!=typeof(n=Rn("cordova.InAppBrowser.open",Ta)))throw new Xn("invalid-cordova-configuration");e=!(!(e=An()).match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)),t.a=n(c,e?"_blank":"_system","location=yes")}})})}function ki(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Mi(t){return t.f||(t.f=t.ba().then(function(){return new H(function(e){function n(r){return e(r),t.Ja(n),!1}t.ua(n),function(t){function e(e){i=!0,o&&o.cancel(),Li(t).then(function(n){var i=r;if(n&&e&&e.url){i=null;var o=e.url,a=De(o),s=Pe(a,"link"),u=Pe(De(s),"link");a=Pe(a,"deep_link_id"),-1!=(o=Pe(De(a),"link")||a||u||s||o).indexOf("/__/auth/callback")&&(i=De(o),i=Fn(Pe(i,"firebaseError")||null),i=(i="object"==typeof i?Yn(i):null)?new Rr(n.b,n.c,null,null,i):new Rr(n.b,n.c,o,n.g)),i=i||r}ki(t,i)})}var n=Rn("universalLinks.subscribe",Ta);if("function"!=typeof n)throw new Xn("invalid-cordova-configuration");var r=new Rr("unknown",null,null,null,new Xn("no-auth-event")),i=!1,o=te(t.v).then(function(){return Li(t).then(function(){i||ki(t,r)})}),a=Ta.handleOpenURL;Ta.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Rn("BuildInfo.packageName",Ta).toLowerCase()+"://")&&e({url:t}),"function"==typeof a)try{a(t)}catch(t){console.error(t)}},n(null,e)}(t)})})),t.f}function Li(t){var e=null;return function(t){return t.b.get(kc,t.a).then(function(t){return Or(t)})}(t.g).then(function(n){return e=n,n=t.g,Ci(n.b,kc,n.a)}).then(function(){return e})}function xi(t){return Ci(t.b,Mc,t.a)}function Fi(t,e,n){this.v=t,this.l=e,this.u=n,this.h=[],this.f=!1,this.i=f(this.m,this),this.c=new Ki,this.o=new zi,this.g=new function(t){this.a=t,this.b=Ei()}(this.l+":"+this.u),this.b={},this.b.unknown=this.c,this.b.signInViaRedirect=this.c,this.b.linkViaRedirect=this.c,this.b.reauthViaRedirect=this.c,this.b.signInViaPopup=this.o,this.b.linkViaPopup=this.o,this.b.reauthViaPopup=this.o,this.a=Ui(this.v,this.l,this.u,Yu)}function Ui(t,e,n,r){var i=wa.SDK_VERSION||null;return En()?new Ri(t,e,n,i,void 0,void 0,r):new ri(t,e,n,i,r)}function Bi(t){t.f||(t.f=!0,t.a.ua(t.i));var e=t.a;return t.a.ba().s(function(n){throw t.a==e&&t.reset(),n})}function Vi(t){t.a.Db()&&Bi(t).s(function(e){var n=new Rr("unknown",null,null,null,new Xn("operation-not-supported-in-this-environment"));ji(e)&&t.m(n)}),t.a.yb()||Gi(t.c)}function qi(t,e,n,r,i,o){return t.a.vb(e,n,r,function(){t.f||(t.f=!0,t.a.ua(t.i))},function(){t.reset()},i,o)}function ji(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Wi(t,e,n){var r=e+":"+n;return Fc[r]||(Fc[r]=new Fi(t,e,n)),Fc[r]}function Ki(){this.b=null,this.f=[],this.c=[],this.a=null,this.g=!1}function Gi(t){t.g||(t.g=!0,Hi(t,!1,null,null))}function Qi(t,e){if(t.b=function(){return Y(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Hi(t,e,n,r){e?r?function(t,e){if(t.b=function(){return J(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):Qi(t,n):Qi(t,{user:null}),t.f=[],t.c=[]}function zi(){}function Xi(t,e){this.a=e,Gn(this,"verificationId",t)}function Yi(t,e,n,r){return new Cr(t).Qa(e,n).then(function(t){return new Xi(t,r)})}function Ji(t,e,n,r,i,o){if(this.h=t,this.i=e,this.g=n,this.c=r,this.f=i,this.l=!!o,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function $i(t,e){Zi(t),t.b=te(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(t,e)).then(function(){return t.l?Y():function(){var t=Ta.document,e=null;return Wn()||!t?Y():new H(function(n){e=function(){Wn()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).s(function(n){throw t.removeEventListener("visibilitychange",e,!1),n})}()}).then(function(){return t.h()}).then(function(){$i(t,!0)}).s(function(e){t.i(e)&&$i(t,!1)})}function Zi(t){t.b&&(t.b.cancel(),t.b=null)}function to(t){this.f=t,this.b=this.a=null,this.c=0}function eo(t,e){var n=e[ju],r=e.refreshToken;e=no(e.expiresIn),t.b=n,t.c=e,t.a=r}function no(t){return Sa()+1e3*parseInt(t,10)}function ro(t,e){return function(t,e){return new H(function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?Ur(t,t.i+"?key="+encodeURIComponent(t.b),function(t){t?t.error?r(Jr(t)):t.access_token&&t.refresh_token?n(t):r(new Xn("internal-error")):r(new Xn("network-request-failed"))},"POST",Be(e).toString(),t.c,t.l.get()):r(new Xn("internal-error"))})}(t.f,e).then(function(e){return t.b=e.access_token,t.c=no(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}function io(t,e){this.a=t||null,this.b=e||null,Qn(this,{lastSignInTime:Kn(e||null),creationTime:Kn(t||null)})}function oo(t,e){Ot.call(this,t);for(var n in e)this[n]=e[n]}function ao(t,e,n){this.A=[],this.G=t.apiKey,this.o=t.appName,this.w=t.authDomain||null,t=wa.SDK_VERSION?Nn(wa.SDK_VERSION):null,this.c=new Lr(this.G,$r(Yu),t),this.h=new to(this.c),po(this,e[ju]),eo(this.h,e),Gn(this,"refreshToken",this.h.a),vo(this,n||{}),zt.call(this),this.I=!1,this.w&&Pn()&&(this.a=Wi(this.w,this.G,this.o)),this.N=[],this.i=null,this.l=function(t){return new Ji(function(){return t.F(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.h.c-Sa()-3e5;return 0<e?e:0},3e4,96e4,!1)}(this),this.U=f(this.Ga,this);var r=this;this.ha=null,this.ra=function(t){r.na(t.h)},this.W=null,this.R=[],this.qa=function(t){uo(r,t.f)},this.V=null}function so(t,e){t.W&&Vt(t.W,"languageCodeChanged",t.ra),(t.W=e)&&Ft(e,"languageCodeChanged",t.ra)}function uo(t,e){t.R=e,Fr(t.c,wa.SDK_VERSION?Nn(wa.SDK_VERSION,t.R):null)}function co(t,e){t.V&&Vt(t.V,"frameworkChanged",t.qa),(t.V=e)&&Ft(e,"frameworkChanged",t.qa)}function ho(t){try{return wa.app(t.o).auth()}catch(e){throw new Xn("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.o+"'!")}}function lo(t){t.m||t.l.b||(t.l.start(),Vt(t,"tokenChanged",t.U),Ft(t,"tokenChanged",t.U))}function fo(t){Vt(t,"tokenChanged",t.U),Zi(t.l)}function po(t,e){t.pa=e,Gn(t,"_lat",e)}function yo(t){for(var e=[],n=0;n<t.N.length;n++)e.push(t.N[n](t));return function(t){return new H(function(e){var n=t.length,r=[];if(n)for(var i,o=function(t,i,o){n--,r[t]=i?{Ub:!0,value:o}:{Ub:!1,reason:o},0==n&&e(r)},a=0;a<t.length;a++)i=t[a],$(i,p(o,a,!0),p(o,a,!1));else e(r)})}(e).then(function(){return t})}function mo(t){t.a&&!t.I&&(t.I=!0,t.a.subscribe(t))}function vo(t,e){Qn(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new io(e.createdAt,e.lastLoginAt),providerData:[]})}function go(){}function _o(t){return Y().then(function(){if(t.m)throw new Xn("app-deleted")})}function bo(t){return Ua(t.providerData,function(t){return t.providerId})}function wo(t,e){e&&(Eo(t,e.providerId),t.providerData.push(e))}function Eo(t,e){I(t.providerData,function(t){return t.providerId==e})}function To(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Gn(t,e,n)}function Io(t,e){t!=e&&(Qn(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?Gn(t,"metadata",function(t){return new io(t.a,t.b)}(e.metadata)):Gn(t,"metadata",new io),Fa(e.providerData,function(e){wo(t,e)}),t.h=e.h,Gn(t,"refreshToken",t.h.a))}function Co(t){return t.F().then(function(e){var n=t.isAnonymous;return function(t,e){return Xr(t.c,rc,{idToken:e}).then(f(t.kc,t))}(t,e).then(function(){return n||To(t,"isAnonymous",!1),e})})}function So(t,e){e[ju]&&t.pa!=e[ju]&&(eo(t.h,e),Xt(t,new oo("tokenChanged")),po(t,e[ju]),To(t,"refreshToken",t.h.a))}function No(t){return(t=t.providerUserInfo)&&t.length?Ua(t,function(t){return new function(t,e,n,r,i,o){Qn(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}function Ao(t,e){return Co(t).then(function(){if(E(bo(t),e))return yo(t).then(function(){throw new Xn("provider-already-linked")})})}function Ro(t,e,n){var r=Nr(e);return e=er(e),Hn({user:t,credential:r,additionalUserInfo:e,operationType:n})}function Oo(t,e){return So(t,e),t.reload().then(function(){return t})}function Po(t,e,n,r,i){if(!Pn())return J(new Xn("operation-not-supported-in-this-environment"));if(t.i&&!i)return J(t.i);var o=tr(n.providerId),a=Un(t.uid+":::"),s=null;(!Mn()||Tn())&&t.w&&n.isOAuthProvider&&(s=si(t.w,t.G,t.o,e,n,null,a,wa.SDK_VERSION||null));var u=bn(s,o&&o.za,o&&o.ya);return r=r().then(function(){if(ko(t),!i)return t.F().then(function(){})}).then(function(){return qi(t.a,u,e,n,a,!!s)}).then(function(){return new H(function(n,r){t.fa(e,null,new Xn("cancelled-popup-request"),t.g||null),t.f=n,t.v=r,t.g=a,t.b=t.a.Ca(t,e,u,a)})}).then(function(t){return u&&_n(u),t?Hn(t):null}).s(function(t){throw u&&_n(u),t}),Mo(t,r,i)}function Do(t,e,n,r,i){if(!Pn())return J(new Xn("operation-not-supported-in-this-environment"));if(t.i&&!i)return J(t.i);var o=null,a=Un(t.uid+":::");return r=r().then(function(){if(ko(t),!i)return t.F().then(function(){})}).then(function(){return t.Z=a,yo(t)}).then(function(e){return t.ca&&(e=t.ca,e=e.b.set(Uc,t.B(),e.a)),e}).then(function(){return t.a.Aa(e,n,a)}).s(function(e){if(o=e,t.ca)return xo(t.ca);throw o}).then(function(){if(o)throw o}),Mo(t,r,i)}function ko(t){if(!t.a||!t.I){if(t.a&&!t.I)throw new Xn("internal-error");throw new Xn("auth-domain-config-required")}}function Mo(t,e,n){var r=function(t,e,n){return t.i&&!n?(e.cancel(),J(t.i)):e.s(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||Xt(t,new oo("userInvalidated")),t.i=e),e})}(t,e,n);return t.A.push(r),Z(r,function(){T(t.A,r)}),r}function Lo(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[ju]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-Sa())/1e3;var r=new ao(e,n,t);return t.providerData&&Fa(t.providerData,function(t){t&&wo(r,Hn(t))}),t.redirectEventId&&(r.Z=t.redirectEventId),r}function xo(t){return Ci(t.b,Uc,t.a)}function Fo(t,e){this.a=t,this.b=e||Ei(),this.c=null,this.f=function(t){var e=Bo("local"),n=Bo("session"),r=Bo("none");return t.b.get(n,t.a).then(function(i){return i?n:t.b.get(r,t.a).then(function(n){return n?r:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(Bc,t.a).then(function(t){return t?Bo(t):e})})})}).then(function(e){return t.c=e,Uo(t,e.C)}).s(function(){t.c||(t.c=e)})}(this),Si(this.b,Bo("local"),this.a,f(this.g,this))}function Uo(t,e){var n,r=[];for(n in Dc)Dc[n]!==e&&r.push(Ci(t.b,Bo(Dc[n]),t.a));return r.push(Ci(t.b,Bc,t.a)),function(t){return new H(function(e,n){var r=t.length,i=[];if(r)for(var o,a=function(t,n){r--,i[t]=n,0==r&&e(i)},s=function(t){n(t)},u=0;u<t.length;u++)o=t[u],$(o,p(a,u),s);else e(i)})}(r)}function Bo(t){return{name:"authUser",C:t}}function Vo(t,e){return Wo(t,function(){return t.b.set(t.c,e.B(),t.a)})}function qo(t){return Wo(t,function(){return Ci(t.b,t.c,t.a)})}function jo(t,e){return Wo(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),Lo(t||{})})})}function Wo(t,e){return t.f=t.f.then(e,e),t.f}function Ko(t){if(this.l=!1,Gn(this,"app",t),!Jo(this).options||!Jo(this).options.apiKey)throw new Xn("invalid-api-key");t=wa.SDK_VERSION?Nn(wa.SDK_VERSION):null,this.c=new Lr(Jo(this).options&&Jo(this).options.apiKey,$r(Yu),t),this.N=[],this.m=[],this.I=[],this.Kb=wa.INTERNAL.createSubscribe(f(this.ac,this)),this.R=void 0,this.Lb=wa.INTERNAL.createSubscribe(f(this.bc,this)),Xo(this,null),this.h=new Fo(Jo(this).options.apiKey+":"+Jo(this).name),this.G=new function(t){this.a=t,this.b=Ei()}(Jo(this).options.apiKey+":"+Jo(this).name),this.U=ea(this,function(t){var e=Jo(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Uc,t.a).then(function(t){return t&&e&&(t.authDomain=e),Lo(t||{})})}(t.G,Jo(t).options.authDomain).then(function(e){return(t.w=e)&&(e.ca=t.G),xo(t.G)});return ea(t,e)}(t).then(function(){return jo(t.h,e)}).then(function(e){return e?(e.ca=t.G,t.w&&(t.w.Z||null)==(e.Z||null)?e:e.reload().then(function(){return Vo(t.h,e).then(function(){return e})}).s(function(n){return"auth/network-request-failed"==n.code?e:qo(t.h)})):null}).then(function(e){Xo(t,e||null)});return ea(t,n)}(this)),this.i=ea(this,function(t){return t.U.then(function(){return t.aa()}).s(function(){}).then(function(){if(!t.l)return t.ha()}).s(function(){}).then(function(){if(!t.l){t.W=!0;var e=t.h;Si(e.b,Bo("local"),e.a,t.ha)}})}(this)),this.W=!1,this.ha=f(this.yc,this),this.Ga=f(this.ka,this),this.pa=f(this.Tb,this),this.qa=f(this.Zb,this),this.ra=f(this.$b,this),function(t){var e=Jo(t).options.authDomain,n=Jo(t).options.apiKey;e&&Pn()&&(t.Jb=t.U.then(function(){if(!t.l){if(t.a=Wi(e,n,Jo(t).name),t.a.subscribe(t),$o(t)&&mo($o(t)),t.w){mo(t.w);var r=t.w;r.na(t.$()),so(r,t),uo(r=t.w,t.A),co(r,t),t.w=null}return t.a}}))}(this),this.INTERNAL={},this.INTERNAL.delete=f(this.delete,this),this.INTERNAL.logFramework=f(this.gc,this),this.o=0,zt.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.$()},set:function(t){this.na(t)},enumerable:!1}),t.V=null}(this),this.A=[]}function Go(t){Ot.call(this,"languageCodeChanged"),this.h=t}function Qo(t){Ot.call(this,"frameworkChanged"),this.f=t}function Ho(t){return t.Jb||J(new Xn("auth-domain-config-required"))}function zo(t,e){var n={};return n.apiKey=Jo(t).options.apiKey,n.authDomain=Jo(t).options.authDomain,n.appName=Jo(t).name,t.U.then(function(){return function(t,e,n,r){var i=new ao(t,e);return n&&(i.ca=n),r&&uo(i,r),i.reload().then(function(){return i})}(n,e,t.G,t.Ka())}).then(function(e){return $o(t)&&e.uid==$o(t).uid?(Io($o(t),e),t.ka(e)):(Xo(t,e),mo(e),t.ka(e))}).then(function(){ta(t)})}function Xo(t,e){$o(t)&&(function(t,e){I(t.N,function(t){return t==e})}($o(t),t.Ga),Vt($o(t),"tokenChanged",t.pa),Vt($o(t),"userDeleted",t.qa),Vt($o(t),"userInvalidated",t.ra),fo($o(t))),e&&(e.N.push(t.Ga),Ft(e,"tokenChanged",t.pa),Ft(e,"userDeleted",t.qa),Ft(e,"userInvalidated",t.ra),0<t.o&&lo(e)),Gn(t,"currentUser",e),e&&(e.na(t.$()),so(e,t),uo(e,t.A),co(e,t))}function Yo(t,e){var n=null,r=null;return ea(t,e.then(function(e){return n=Nr(e),r=er(e),zo(t,e)}).then(function(){return Hn({user:$o(t),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function Jo(t){return t.app}function $o(t){return t.currentUser}function Zo(t){return $o(t)&&$o(t)._lat||null}function ta(t){if(t.W){for(var e=0;e<t.m.length;e++)t.m[e]&&t.m[e](Zo(t));if(t.R!==t.getUid()&&t.I.length)for(t.R=t.getUid(),e=0;e<t.I.length;e++)t.I[e]&&t.I[e](Zo(t))}}function ea(t,e){return t.N.push(e),Z(e,function(){T(t.N,e)}),e}function na(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new Xn("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=Vc.length)throw new Xn("internal-error","Argument validator received an unsupported number of arguments.");n=Vc[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new Xn("argument-error",t+" failed: "+r)}function ra(e,n){return{name:e||"",K:"a valid string",optional:!!n,M:t}}function ia(){return{name:"opt_forceRefresh",K:"a boolean",optional:!0,M:e}}function oa(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:c}}function aa(t,e){return{name:t||"",K:"a function",optional:!!e,M:u}}function sa(t,e){return{name:t||"",K:"null",optional:!!e,M:o}}function ua(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.wa||!n)}}}function ca(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!!(e&&t(e.type)&&u(e.verify))}}}function ha(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function la(t,e,n,r,i,o){if(Gn(this,"type","recaptcha"),this.b=this.c=null,this.m=!1,this.l=e,this.a=n||{theme:"light",type:"image"},this.g=[],this.a[Wc])throw new Xn("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.h="invisible"===this.a[Kc],!Et(e)||!this.h&&Et(e).hasChildNodes())throw new Xn("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new Lr(t,o||null,i||null),this.o=r||function(){return null};var a=this;this.i=[];var s=this.a[qc];this.a[qc]=function(t){if(fa(a,t),"function"==typeof s)s(t);else if("string"==typeof s){var e=Rn(s,Ta);"function"==typeof e&&e(t)}};var u=this.a[jc];this.a[jc]=function(){if(fa(a,null),"function"==typeof u)u();else if("string"==typeof u){var t=Rn(u,Ta);"function"==typeof t&&t()}}}function fa(t,e){for(var n=0;n<t.i.length;n++)try{t.i[n](e)}catch(t){}}function pa(t,e){return t.g.push(e),Z(e,function(){T(t.g,e)}),e}function da(t){if(t.m)throw new Xn("internal-error","RecaptchaVerifier instance has been destroyed.")}function ya(){return Qc||(Qc=new function(){this.b=Ta.grecaptcha?1/0:0,this.c=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}),Qc}function ma(t,e,n){try{this.f=n||wa.app()}catch(t){throw new Xn("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.f.options||!this.f.options.apiKey)throw new Xn("invalid-api-key");n=this.f.options.apiKey;var r=this,i=null;try{i=this.f.auth().Ka()}catch(t){}i=wa.SDK_VERSION?Nn(wa.SDK_VERSION,i):null,la.call(this,n,t,e,function(){try{var t=r.f.auth().$()}catch(e){t=null}return t},i,$r(Yu))}function va(t,e){for(var n in e){var r=e[n].name;t[r]=_a(r,t[n],e[n].j)}}function ga(t,e,n,r){t[e]=_a(e,n,r)}function _a(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return na(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}var ba,wa=n("qQjo").default,Ea=Ea||{},Ta=this,Ia="closure_uid_"+(1e9*Math.random()>>>0),Ca=0,Sa=Date.now||function(){return+new Date};d(y,Error),y.prototype.name="CustomError";var Na=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Aa=/&/g,Ra=/</g,Oa=/>/g,Pa=/"/g,Da=/'/g,ka=/\x00/g,Ma=/[\x00&<>"']/;d(b,y),b.prototype.name="AssertionError";var La,xa=Array.prototype.indexOf?function(t,e,n){return Array.prototype.indexOf.call(t,e,n)}:function(e,n,r){if(r=null==r?0:0>r?Math.max(0,e.length+r):r,t(e))return t(n)&&1==n.length?e.indexOf(n,r):-1;for(;r<e.length;r++)if(r in e&&e[r]===n)return r;return-1},Fa=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(e,n,r){for(var i=e.length,o=t(e)?e.split(""):e,a=0;a<i;a++)a in o&&n.call(r,o[a],a,e)},Ua=Array.prototype.map?function(t,e,n){return Array.prototype.map.call(t,e,n)}:function(e,n,r){for(var i=e.length,o=Array(i),a=t(e)?e.split(""):e,s=0;s<i;s++)s in a&&(o[s]=n.call(r,a[s],s,e));return o},Ba=Array.prototype.some?function(t,e,n){return Array.prototype.some.call(t,e,n)}:function(e,n,r){for(var i=e.length,o=t(e)?e.split(""):e,a=0;a<i;a++)if(a in o&&n.call(r,o[a],a,e))return!0;return!1};t:{var Va=Ta.navigator;if(Va){var qa=Va.userAgent;if(qa){La=qa;break t}}La=""}var ja="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");L[" "]=r;var Wa,Ka=N("Opera"),Ga=N("Trident")||N("MSIE"),Qa=N("Edge"),Ha=Qa||Ga,za=N("Gecko")&&!(g(La.toLowerCase(),"webkit")&&!N("Edge"))&&!(N("Trident")||N("MSIE"))&&!N("Edge"),Xa=g(La.toLowerCase(),"webkit")&&!N("Edge");t:{var Ya="",Ja=function(){var t=La;return za?/rv\:([^\);]+)(\)|;)/.exec(t):Qa?/Edge\/([\d\.]+)/.exec(t):Ga?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Xa?/WebKit\/(\S+)/.exec(t):Ka?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Ja&&(Ya=Ja?Ja[1]:""),Ga){var $a=x();if(null!=$a&&$a>parseFloat(Ya)){Wa=String($a);break t}}Wa=Ya}var Za,ts={},es=Ta.document;Za=es&&Ga?x()||("CSS1Compat"==es.compatMode?parseInt(Wa,10):5):void 0,V.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var ns=new V(function(){return new W},function(t){t.reset()},100);W.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},W.prototype.reset=function(){this.next=this.b=this.a=null};var rs,is,os=!1,as=new function(){this.b=this.a=null},ss=0,us=2,cs=3;z.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var hs=new V(function(){return new z},function(t){t.reset()},100);H.prototype.then=function(t,e,n){return nt(this,u(t)?t:null,u(e)?e:null,n)},U(H),(ba=H.prototype).s=function(t,e){return nt(this,null,t,e)},ba.cancel=function(t){this.a==ss&&G(function(){tt(this,new ct(t))},this)},ba.Ac=function(t){this.a=ss,rt(this,us,t)},ba.Bc=function(t){this.a=ss,rt(this,cs,t)},ba.Qb=function(){for(var t;t=at(this);)st(this,t,this.a,this.i);this.h=!1};var ls=K;d(ct,y),ct.prototype.name="cancel";var fs=!Ga||9<=Number(Za);ht.prototype.la=!0,ht.prototype.ja=function(){return this.a},ht.prototype.toString=function(){return"Const{"+this.a+"}"};var ps={};ft(""),pt.prototype.la=!0,pt.prototype.ja=function(){return this.a},pt.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var ds=/%{(\w+)}/g,ys=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank(#|$)/i,ms={};mt.prototype.la=!0,mt.prototype.ja=function(){return this.a},mt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var vs=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i,gs={};_t("about:blank"),bt.prototype.la=!0,bt.prototype.ja=function(){return this.a},bt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var _s={};wt("<!DOCTYPE html>"),wt(""),wt("<br>");var bs={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},ws={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Es=/\uffff/.test("")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,Ts=0,Is={};At.prototype.oa=!1,At.prototype.ta=function(){if(this.Fa)for(;this.Fa.length;)this.Fa.shift()()};var Cs=Object.freeze||function(t){return t},Ss=!Ga||9<=Number(Za),Ns=Ga&&!F("9"),As=function(){if(!Ta.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return Ta.addEventListener("test",r,e),Ta.removeEventListener("test",r,e),t}();Ot.prototype.c=function(){this.Bb=!1},d(Pt,Ot);var Rs=Cs({2:"touch",3:"pen",4:"mouse"});Pt.prototype.c=function(){Pt.ib.c.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ns)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},Pt.prototype.g=function(){return this.a};var Os="closure_listenable_"+(1e6*Math.random()|0),Ps=0,Ds="closure_lm_"+(1e6*Math.random()|0),ks={},Ms="__closure_events_fn_"+(1e9*Math.random()>>>0);d(zt,At),zt.prototype[Os]=!0,zt.prototype.removeEventListener=function(t,e,n,r){Vt(this,t,e,n,r)},zt.prototype.ta=function(){if(zt.ib.ta.call(this),this.u){var t,e=this.u;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)0,Dt(n[r]);delete e.a[t],e.b--}}this.Ra=null},ee.prototype.a=null;ee.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||Sa(),this.b=e,delete this.a},re.prototype.toString=function(){return this.name};var Ls=new re("SEVERE",1e3),xs=new re("CONFIG",700),Fs=new re("FINE",500);ne.prototype.log=function(t,e,n){if(t.value>=ie(this).value)for(u(e)&&(e=e()),t=new ee(t,String(e),this.f),n&&(t.a=n),n="log:"+t.b,(t=Ta.console)&&t.timeStamp&&t.timeStamp(n),(t=Ta.msWriteProfilerMark)&&t(n),n=this;n;)n=n.a};var Us={},Bs=null;(ba=ae.prototype).P=function(){se(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ba.S=function(){return se(this),this.a.concat()},ba.clear=function(){this.b={},this.c=this.a.length=0},ba.get=function(t,e){return ue(this.b,t)?this.b[t]:e},ba.set=function(t,e){ue(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ba.forEach=function(t,e){for(var n=this.S(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Vs=null,qs=null;le.prototype.cancel=function(t){if(this.a)this.c instanceof le&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.v?this.v.call(this.o,this):this.u=!0,this.a||(t=new ge,pe(this),fe(this,!1,t))}},le.prototype.m=function(t,e){this.i=!1,fe(this,t,e)},le.prototype.A=function(t){pe(this),fe(this,!0,t)},le.prototype.then=function(t,e,n){var r,i,o=new H(function(t,e){r=t,i=e});return de(this,r,function(t){t instanceof ge?o.cancel():i(t)}),o.then(t,e,n)},U(le),d(ve,y),ve.prototype.message="Deferred has already fired",ve.prototype.name="AlreadyCalledError",d(ge,y),ge.prototype.message="Deferred was canceled",ge.prototype.name="CanceledError",_e.prototype.c=function(){throw delete Ws[this.a],this.b};var js,Ws={};d(be,function(){this.b=-1});for(var Ks=64,Gs=Ks-1,Qs=[],Hs=0;Hs<Gs;Hs++)Qs[Hs]=0;var zs=C(128,Qs);be.prototype.reset=function(){this.g=this.c=0,this.a=Ta.Int32Array?new Int32Array(this.h):S(this.h)};var Xs=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];d(Te,be);var Ys=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Js=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;Se.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Le(e,$s,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Le(e,$s,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.g)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Le(n,"/"==n.charAt(0)?tu:Zs,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Le(n,nu)),t.join("")};var $s=/[#\/\?@]/g,Zs=/[\#\?:]/g,tu=/[\#\?]/g,eu=/[\#\?@]/g,nu=/#/g;(ba=Fe.prototype).clear=function(){this.a=this.c=null,this.b=0},ba.forEach=function(t,e){Ue(this),this.a.forEach(function(n,r){Fa(n,function(n){t.call(e,n,r,this)},this)},this)},ba.S=function(){Ue(this);for(var t=this.a.P(),e=this.a.S(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ba.P=function(e){Ue(this);var n=[];if(t(e))je(this,e)&&(n=C(n,this.a.get(Ke(this,e))));else{e=this.a.P();for(var r=0;r<e.length;r++)n=C(n,e[r])}return n},ba.set=function(t,e){return Ue(this),this.c=null,t=Ke(this,t),je(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ba.get=function(t,e){return 0<(t=t?this.P(t):[]).length?String(t[0]):e},ba.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.S(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.P(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")},Ge.prototype.c=null;var ru;d(He,Ge),He.prototype.a=function(){var t=ze(this);return t?new ActiveXObject(t):new XMLHttpRequest},He.prototype.b=function(){var t={};return ze(this)&&(t[0]=!0,t[1]=!0),t},ru=new He,d(Xe,zt);var iu="",ou=Xe.prototype,au=oe("goog.net.XhrIo");ou.J=au;var su=/^https?$/i,uu=["POST","PUT"];(ba=Xe.prototype).Ea=function(){void 0!==Ea&&this.a&&(this.g="Timed out after "+this.f+"ms, aborting",ce(this.J,an(this,this.g)),Xt(this,"timeout"),this.abort(8))},ba.abort=function(){this.a&&this.b&&(ce(this.J,an(this,"Aborting")),this.b=!1,this.c=!0,this.a.abort(),this.c=!1,Xt(this,"complete"),Xt(this,"abort"),en(this))},ba.ta=function(){this.a&&(this.b&&(this.b=!1,this.c=!0,this.a.abort(),this.c=!1),en(this,!0)),Xe.ib.ta.call(this)},ba.Ab=function(){this.oa||(this.G||this.h||this.c?tn(this):this.jc())},ba.jc=function(){tn(this)},ba.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.l){case iu:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.J;return t&&t.log(Ls,"Response type "+this.l+" is not supported on this browser",void 0),null}catch(t){return ce(this.J,"Can not get response: "+t.message),null}};var cu=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/,hu=0,lu=1;d(hn,y),d(ln,Ge),ln.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new fn;throw Error("Unsupported browser")},ln.prototype.b=function(){return{}},(ba=fn.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},ba.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},ba.abort=function(){this.a.abort()},ba.setRequestHeader=function(){},ba.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},ba.Wb=function(){this.status=200,this.responseText=this.a.responseText,pn(this,4)},ba.xb=function(){this.status=500,this.responseText="",pn(this,4)},ba.Yb=function(){this.xb()},ba.Xb=function(){this.status=200,pn(this,1)},ba.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType};var fu=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pu="Firefox",du="Chrome",yu={Gc:"FirebaseCore-web",Ic:"FirebaseUI-web"};jn.prototype.get=function(){return this.a?this.b:this.c};var mu,vu={};try{var gu={};Object.defineProperty(gu,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(gu,"abcd",{configurable:!0,enumerable:!0,value:2}),mu=2==gu.abcd}catch(t){mu=!1}var _u="email",bu="newEmail",wu="requestType",Eu="email",Tu="fromEmail",Iu="data",Cu="operation";d(Xn,Error),Xn.prototype.B=function(){return{code:this.code,message:this.message}},Xn.prototype.toJSON=function(){return this.B()};var Su="auth/",Nu={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"The user's credential is no longer valid. The user must sign in again.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},Au="android",Ru="handleCodeInApp",Ou="iOS",Pu="url",Du="installApp",ku="minimumVersion",Mu="packageName",Lu="bundleId",xu="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Fu=["client_id","response_type","scope","redirect_uri","state"],Uu={Hc:{Ma:"locale",za:500,ya:600,Na:"facebook.com",$a:Fu},Jc:{Ma:null,za:500,ya:620,Na:"github.com",$a:Fu},Kc:{Ma:"hl",za:515,ya:680,Na:"google.com",$a:Fu},Qc:{Ma:"lang",za:485,ya:705,Na:"twitter.com",$a:xu}},Bu="idToken",Vu="providerId";d(rr,nr),d(ir,rr),d(or,rr),d(ar,rr),d(sr,rr),cr.prototype.wa=function(t){return Gr(t,hr(this))},cr.prototype.b=function(t,e){var n=hr(this);return n.idToken=e,Qr(t,n)},cr.prototype.c=function(t,e){return ur(Hr(t,hr(this)),e)},cr.prototype.B=function(){var t={providerId:this.providerId};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),t},lr.prototype.Ba=function(t){return this.rb=k(t),this},d(fr,lr),fr.prototype.sa=function(t){return E(this.a,t)||this.a.push(t),this},fr.prototype.wb=function(){return S(this.a)},fr.prototype.credential=function(t,e){if(!t&&!e)throw new Xn("argument-error","credential failed: must provide the ID token and/or the access token.");return new cr(this.providerId,{idToken:t||null,accessToken:e||null})},d(pr,fr),Gn(pr,"PROVIDER_ID","facebook.com"),d(yr,fr),Gn(yr,"PROVIDER_ID","github.com"),d(vr,fr),Gn(vr,"PROVIDER_ID","google.com"),d(_r,lr),Gn(_r,"PROVIDER_ID","twitter.com"),wr.prototype.wa=function(t){return Xr(t,vc,{email:this.a,password:this.f})},wr.prototype.b=function(t,e){return Xr(t,lc,{idToken:e,email:this.a,password:this.f})},wr.prototype.c=function(t,e){return ur(this.wa(t),e)},wr.prototype.B=function(){return{email:this.a,password:this.f}},Qn(Er,{PROVIDER_ID:"password"}),Tr.prototype.wa=function(t){return t.Qa(Ir(this))},Tr.prototype.b=function(t,e){var n=Ir(this);return n.idToken=e,Xr(t,_c,n)},Tr.prototype.c=function(t,e){var n=Ir(this);return n.operation="REAUTH",t=Xr(t,bc,n),ur(t,e)},Tr.prototype.B=function(){var t={providerId:"phone"};return this.a.Pa&&(t.verificationId=this.a.Pa),this.a.Oa&&(t.verificationCode=this.a.Oa),this.a.Da&&(t.temporaryProof=this.a.Da),this.a.Y&&(t.phoneNumber=this.a.Y),t},Cr.prototype.Qa=function(e,n){var r=this.a.c;return Y(n.verify()).then(function(i){if(!t(i))throw new Xn("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(n.type){case"recaptcha":return function(t,e){return Xr(t,cc,e)}(r,{phoneNumber:e,recaptchaToken:i}).then(function(t){return"function"==typeof n.reset&&n.reset(),t},function(t){throw"function"==typeof n.reset&&n.reset(),t});default:throw new Xn("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},Qn(Cr,{PROVIDER_ID:"phone"}),Rr.prototype.B=function(){return{type:this.b,eventId:this.c,urlResponse:this.f,sessionId:this.g,error:this.a&&this.a.B()}},d(Pr,Xn),d(Dr,Xn),Dr.prototype.B=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.B();return e&&M(t,e),t},Dr.prototype.toJSON=function(){return this.B()},d(Mr,Ge),Mr.prototype.a=function(){return new this.f},Mr.prototype.b=function(){return{}};var qu,ju="idToken",Wu=new jn(3e4,6e4),Ku={"Content-Type":"application/x-www-form-urlencoded"},Gu=new jn(3e4,6e4),Qu={"Content-Type":"application/json"};Lr.prototype.m=function(t,e,n,r,i,o){var a="Node"==In(),s=Cn()?a?new Xe(this.o):new Xe:new Xe(this.f);if(o){s.f=Math.max(0,o);var u=setTimeout(function(){Xt(s,"timeout")},o)}Yt(s,"complete",function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return ce(t.J,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)}),Jt(s,"ready",function(){u&&clearTimeout(u),Rt(this)}),Jt(s,"timeout",function(){u&&clearTimeout(u),Rt(this),e&&e(null)}),Ye(s,t,n,r,i)};var Hu=ft("https://apis.google.com/js/client.js?onload=%{onload}"),zu="__fcb"+Math.floor(1e6*Math.random()).toString();Lr.prototype.u=function(t,e,n,r,i){var o=this;qu.then(function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},Lr.prototype.gb=function(){return Xr(this,fc,{})},Lr.prototype.kb=function(t,e){return Xr(this,hc,{idToken:t,email:e})},Lr.prototype.lb=function(t,e){return Xr(this,lc,{idToken:t,password:e})};var Xu={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};(ba=Lr.prototype).mb=function(t,e){var n={idToken:t},r=[];return A(Xu,function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),Xr(this,hc,n)},ba.cb=function(t,e){return t={requestType:"PASSWORD_RESET",email:t},M(t,e),Xr(this,oc,t)},ba.bb=function(t,e){return t={requestType:"VERIFY_EMAIL",idToken:t},M(t,e),Xr(this,ic,t)},ba.Qa=function(t){return Xr(this,gc,t)},ba.Ta=function(t,e){return Xr(this,uc,{oobCode:t,newPassword:e})},ba.Ia=function(t){return Xr(this,$u,{oobCode:t})},ba.Sa=function(t){return Xr(this,Ju,{oobCode:t})};var Yu,Ju={endpoint:"setAccountInfo",D:zr,ga:"email"},$u={endpoint:"resetPassword",D:zr,O:function(t){if(!t.email||!t.requestType)throw new Xn("internal-error")}},Zu={endpoint:"signupNewUser",D:function(t){if(Br(t),!t.password)throw new Xn("weak-password")},O:qr,T:!0},tc={endpoint:"createAuthUri"},ec={endpoint:"deleteAccount",ea:["idToken"]},nc={endpoint:"setAccountInfo",ea:["idToken","deleteProvider"],D:function(t){if(!a(t.deleteProvider))throw new Xn("internal-error")}},rc={endpoint:"getAccountInfo"},ic={endpoint:"getOobConfirmationCode",ea:["idToken","requestType"],D:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new Xn("internal-error")},ga:"email"},oc={endpoint:"getOobConfirmationCode",ea:["requestType"],D:function(t){if("PASSWORD_RESET"!=t.requestType)throw new Xn("internal-error");Br(t)},ga:"email"},ac={nb:!0,endpoint:"getProjectConfig",zb:"GET"},sc={nb:!0,endpoint:"getRecaptchaParam",zb:"GET",O:function(t){if(!t.recaptchaSiteKey)throw new Xn("internal-error")}},uc={endpoint:"resetPassword",D:zr,ga:"email"},cc={endpoint:"sendVerificationCode",ea:["phoneNumber","recaptchaToken"],ga:"sessionInfo"},hc={endpoint:"setAccountInfo",ea:["idToken"],D:Vr,T:!0},lc={endpoint:"setAccountInfo",ea:["idToken"],D:function(t){if(Vr(t),!t.password)throw new Xn("weak-password")},O:qr,T:!0},fc={endpoint:"signupNewUser",O:qr,T:!0},pc={endpoint:"verifyAssertion",D:Wr,O:Kr,T:!0},dc={endpoint:"verifyAssertion",D:Wr,O:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new Xn("user-not-found");if(t.errorMessage)throw Yr(t.errorMessage);if(!t[ju])throw new Xn("internal-error")},T:!0},yc={endpoint:"verifyAssertion",D:function(t){if(Wr(t),!t.idToken)throw new Xn("internal-error")},O:Kr,T:!0},mc={endpoint:"verifyCustomToken",D:function(t){if(!t.token)throw new Xn("invalid-custom-token")},O:qr,T:!0},vc={endpoint:"verifyPassword",D:function(t){if(Br(t),!t.password)throw new Xn("wrong-password")},O:qr,T:!0},gc={endpoint:"verifyPhoneNumber",D:jr,O:qr},_c={endpoint:"verifyPhoneNumber",D:function(t){if(!t.idToken)throw new Xn("internal-error");jr(t)},O:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",kr(t);qr(t)}},bc={Pb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",D:jr,O:qr},wc={Mc:{Va:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ab:"https://securetoken.googleapis.com/v1/token",id:"p"},Oc:{Va:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ab:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},Pc:{Va:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ab:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};Yu=$r("__EID__")?"__EID__":void 0;var Ec=ft("https://apis.google.com/js/api.js?onload=%{onload}"),Tc=new jn(3e4,6e4),Ic=new jn(5e3,15e3),Cc=null;ti.prototype.toString=function(){return this.f?Oe(this.a,"v",this.f):qe(this.a.a,"v"),this.b?Oe(this.a,"eid",this.b):qe(this.a.a,"eid"),this.c.length?Oe(this.a,"fw",this.c.join(",")):qe(this.a.a,"fw"),this.a.toString()},ei.prototype.toString=function(){var t=ke(this.m,"/__/auth/handler");if(Oe(t,"apiKey",this.u),Oe(t,"appName",this.c),Oe(t,"authType",this.l),this.a.isOAuthProvider){var e=this.a;try{var n=wa.app(this.c).auth().$()}catch(t){n=null}e.Ua=n,Oe(t,"providerId",this.a.providerId),n=xn((e=this.a).rb);for(var r in n)n[r]=n[r].toString();r=e.rc,n=k(n);for(var i=0;i<r.length;i++){var o=r[i];o in n&&delete n[o]}e.Wa&&e.Ua&&!n[e.Wa]&&(n[e.Wa]=e.Ua),P(n)||Oe(t,"customParameters",Ln(n))}if("function"==typeof this.a.wb&&(e=this.a.wb()).length&&Oe(t,"scopes",e.join(",")),this.h?Oe(t,"redirectUrl",this.h):qe(t.a,"redirectUrl"),this.g?Oe(t,"eventId",this.g):qe(t.a,"eventId"),this.i?Oe(t,"v",this.i):qe(t.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Pe(t,a)&&Oe(t,a,this.b[a]);return this.f?Oe(t,"eid",this.f):qe(t.a,"eid"),(a=ni(this.c)).length&&Oe(t,"fw",a.join(",")),t.toString()},(ba=ri.prototype).Ca=function(t,e,n){var r=new Xn("popup-closed-by-user"),i=new Xn("web-storage-unsupported"),o=this,a=!1;return this.ba().then(function(){ui(o).then(function(n){n||(t&&_n(t),e(i),a=!0)})}).s(function(){}).then(function(){if(!a)return function(t){return new H(function(e){function n(){te(2e3).then(function(){if(t&&!t.closed)return n();e()})}return n()})}(t)}).then(function(){if(!a)return te(n).then(function(){e(r)})})},ba.Db=function(){var t=An();return!Mn(t)&&!Bn(t)},ba.yb=function(){return!1},ba.vb=function(t,e,n,r,i,o,a){if(!t)return J(new Xn("popup-blocked"));if(a&&!Mn())return this.ba().s(function(e){_n(t),i(e)}),r(),Y();this.a||(this.a=ii(ai(this)));var s=this;return this.a.then(function(){var e=s.ba().s(function(e){throw _n(t),i(e),e});return r(),e}).then(function(){if(Ar(n),!a){mn(si(s.u,s.f,s.b,e,n,null,o,s.c,void 0,s.h),t)}}).s(function(t){throw"auth/network-request-failed"==t.code&&(s.a=null),t})},ba.Aa=function(t,e,n){this.a||(this.a=ii(ai(this)));var r=this;return this.a.then(function(){Ar(e);mn(si(r.u,r.f,r.b,t,e,yn(),n,r.c,void 0,r.h))}).s(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},ba.ba=function(){var t=this;return oi(this).then(function(){return t.i.Ya}).s(function(){throw t.a=null,new Xn("network-request-failed")})},ba.Hb=function(){return!0},ba.ua=function(t){this.g.push(t)},ba.Ja=function(t){I(this.g,function(e){return e==t})},(ba=ci.prototype).get=function(t){return Y(this.a.getItem(t)).then(function(t){return t&&Fn(t)})},ba.set=function(t,e){return Y(this.a.setItem(t,Ln(e)))},ba.X=function(t){return Y(this.a.removeItem(t))},ba.ia=function(){},ba.da=function(){},(ba=hi.prototype).get=function(t){return Y(this.a[t])},ba.set=function(t,e){return this.a[t]=e,Y()},ba.X=function(t){return delete this.a[t],Y()},ba.ia=function(){},ba.da=function(){};var Sc;(ba=li.prototype).set=function(t,e){var n,r=!1,i=this;return Z(fi(this).then(function(e){return n=e,e=pi(i,di(i,n,!0)),yi(e.get(t))}).then(function(o){var a=pi(i,di(i,n,!0));return o?(o.value=e,yi(a.put(o))):(i.a++,r=!0,o={},o[i.g]=t,o[i.l]=e,yi(a.add(o)))}).then(function(){i.f[t]=e}),function(){r&&i.a--})},ba.get=function(t){var e=this;return fi(this).then(function(n){return yi(pi(e,di(e,n,!1)).get(t))}).then(function(t){return t&&t.value})},ba.X=function(t){var e=!1,n=this;return Z(fi(this).then(function(r){return e=!0,n.a++,yi(pi(n,di(n,r,!0)).delete(t))}).then(function(){delete n.f[t]}),function(){e&&n.a--})},ba.zc=function(){var t=this;return fi(this).then(function(e){var n=pi(t,di(t,e,!1));return n.getAll?yi(n.getAll()):new H(function(t,e){var r=[],i=n.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){e(Error(t.target.errorCode))}})}).then(function(e){var n={},r=[];if(0==t.a){for(r=0;r<e.length;r++)n[e[r][t.g]]=e[r][t.l];r=vn(t.f,n),t.f=n}return r})},ba.ia=function(t){0==this.c.length&&function(t){function e(){return t.b=te(800).then(f(t.zc,t)).then(function(e){0<e.length&&Fa(t.c,function(t){t(e)})}).then(e).s(function(t){"STOP_EVENT"!=t.message&&e()}),t.b}t.b&&t.b.cancel("STOP_EVENT"),e()}(this),this.c.push(t)},ba.da=function(t){I(this.c,function(e){return e==t}),0==this.c.length&&this.b&&this.b.cancel("STOP_EVENT")},(ba=mi.prototype).get=function(t){var e=this;return Y().then(function(){return Fn(e.a.getItem(t))})},ba.set=function(t,e){var n=this;return Y().then(function(){var r=Ln(e);null===r?n.X(t):n.a.setItem(t,r)})},ba.X=function(t){var e=this;return Y().then(function(){e.a.removeItem(t)})},ba.ia=function(t){Ta.window&&Ft(Ta.window,"storage",t)},ba.da=function(t){Ta.window&&Vt(Ta.window,"storage",t)},(ba=gi.prototype).get=function(){return Y(null)},ba.set=function(){return Y()},ba.X=function(){return Y()},ba.ia=function(){},ba.da=function(){},(ba=_i.prototype).get=function(t){var e=this;return Y().then(function(){return Fn(e.a.getItem(t))})},ba.set=function(t,e){var n=this;return Y().then(function(){var r=Ln(e);null===r?n.X(t):n.a.setItem(t,r)})},ba.X=function(t){var e=this;return Y().then(function(){e.a.removeItem(t)})},ba.ia=function(){},ba.da=function(){};var Nc,Ac,Rc={C:mi,jb:_i},Oc={C:mi,jb:_i},Pc={C:ci,jb:gi},Dc={Lc:"local",NONE:"none",Nc:"session"};wi.prototype.get=function(t,e){return Ti(this,t.C).get(Ii(this,t,e))},wi.prototype.set=function(t,e,n){var r=Ii(this,t,n),i=this,o=Ti(this,t.C);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.C&&(i.b[r]=e)})},wi.prototype.m=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=Ta.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.c(n))}else if(0==e.indexOf(this.i+this.g)&&this.a[e]){if(void 0!==t.a.a?Ti(this,"local").da(this.h):Ai(this),this.A)if(n=Ta.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?Ta.localStorage.setItem(e,r):Ta.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===Ta.localStorage.getItem(e)||(o.b[e]=Ta.localStorage.getItem(e),o.c(e))},Ga&&Za&&10==Za&&Ta.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else Fa(t,f(this.c,this))},wi.prototype.c=function(t){this.a[t]&&Fa(this.a[t],function(t){t()})};var kc={name:"authEvent",C:"local"};(ba=Ri.prototype).ba=function(){return this.xa?this.xa:this.xa=(En(void 0)?wn().then(function(){return new H(function(t,e){var n=Ta.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):J(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof Rn("universalLinks.subscribe",Ta))throw Oi("cordova-universal-links-plugin is not installed");if(void 0===Rn("BuildInfo.packageName",Ta))throw Oi("cordova-plugin-buildinfo is not installed");if("function"!=typeof Rn("cordova.plugins.browsertab.openUrl",Ta))throw Oi("cordova-plugin-browsertab is not installed");if("function"!=typeof Rn("cordova.InAppBrowser.open",Ta))throw Oi("cordova-plugin-inappbrowser is not installed")},function(){throw new Xn("cordova-not-ready")})},ba.Ca=function(t,e){return e(new Xn("operation-not-supported-in-this-environment")),Y()},ba.vb=function(){return J(new Xn("operation-not-supported-in-this-environment"))},ba.Hb=function(){return!1},ba.Db=function(){return!0},ba.yb=function(){return!0},ba.Aa=function(t,e,n){if(this.c)return J(new Xn("redirect-operation-pending"));var r=this,i=Ta.document,o=null,a=null,s=null,u=null;return this.c=Z(Y().then(function(){return Ar(e),Mi(r)}).then(function(){return Di(r,t,e,n)}).then(function(){return new H(function(t,e){a=function(){var e=Rn("cordova.plugins.browsertab.close",Ta);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.ua(a),s=function(){o||(o=te(r.w).then(function(){e(new Xn("redirect-cancelled-by-user"))}))},u=function(){Wn()&&s()},i.addEventListener("resume",s,!1),An().toLowerCase().match(/android/)||i.addEventListener("visibilitychange",u,!1)}).s(function(t){return Li(r).then(function(){throw t})})}),function(){s&&i.removeEventListener("resume",s,!1),u&&i.removeEventListener("visibilitychange",u,!1),o&&o.cancel(),a&&r.Ja(a),r.c=null})},ba.ua=function(t){this.b.push(t),Mi(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Rr("unknown",null,null,null,new Xn("no-auth-event")),t(e))})},ba.Ja=function(t){I(this.b,function(e){return e==t})};var Mc={name:"pendingRedirect",C:"session"};Fi.prototype.reset=function(){this.f=!1,this.a.Ja(this.i),this.a=Ui(this.v,this.l,this.u)},Fi.prototype.subscribe=function(t){if(E(this.h,t)||this.h.push(t),!this.f){var e=this;(function(t){return t.b.get(Mc,t.a).then(function(t){return"pending"==t})})(this.g).then(function(t){t?xi(e.g).then(function(){Bi(e).s(function(t){var n=new Rr("unknown",null,null,null,new Xn("operation-not-supported-in-this-environment"));ji(t)&&e.m(n)})}):Vi(e)}).s(function(){Vi(e)})}},Fi.prototype.unsubscribe=function(t){I(this.h,function(e){return e==t})},Fi.prototype.m=function(t){if(!t)throw new Xn("invalid-auth-event");for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.ob(t.b,t.c)){(e=this.b[t.b])&&e.h(t,r),e=!0;break}}return Gi(this.c),e};var Lc=new jn(2e3,1e4),xc=new jn(3e4,6e4);Fi.prototype.aa=function(){return this.c.aa()},Fi.prototype.Aa=function(t,e,n){var r,i=this;return function(t){return t.b.set(Mc,"pending",t.a)}(this.g).then(function(){return i.a.Aa(t,e,n).s(function(t){if(ji(t))throw new Xn("operation-not-supported-in-this-environment");return r=t,xi(i.g).then(function(){throw r})}).then(function(){return i.a.Hb()?new H(function(){}):xi(i.g).then(function(){return i.aa()}).then(function(){}).s(function(){})})})},Fi.prototype.Ca=function(t,e,n,r){return this.a.Ca(n,function(n){t.fa(e,null,n,r)},Lc.get())};var Fc={};Ki.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Ki.prototype.h=function(t,e){if(!t)return J(new Xn("invalid-auth-event"));this.reset(),this.g=!0;var n=t.b,r=t.c,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;return"unknown"!=n||i||o?t.a?(Hi(this,!0,null,t.a),t=Y()):t=e.va(n,r)?function(t,e,n){n=n.va(e.b,e.c);var r=e.f,i=e.g,o=!!e.b.match(/Redirect$/);return n(r,i).then(function(e){Hi(t,o,e,null)}).s(function(e){Hi(t,o,null,e)})}(this,t,e):J(new Xn("invalid-auth-event")):(Hi(this,!1,null,null),t=Y()),t},Ki.prototype.aa=function(){var t=this;return new H(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new Xn("timeout");t.a&&t.a.cancel(),t.a=te(xc.get()).then(function(){t.b||Hi(t,!0,null,e)})}(t))})},zi.prototype.h=function(t,e){if(!t)return J(new Xn("invalid-auth-event"));var n=t.b,r=t.c;return t.a?(e.fa(t.b,null,t.a,t.c),t=Y()):t=e.va(n,r)?function(t,e){var n=t.c,r=t.b;return e.va(r,n)(t.f,t.g).then(function(t){e.fa(r,t,null,n)}).s(function(t){e.fa(r,null,t,n)})}(t,e):J(new Xn("invalid-auth-event")),t},Xi.prototype.confirm=function(t){return t=Sr(this.verificationId,t),this.a(t)},Ji.prototype.start=function(){this.a=this.c,$i(this,!0)},to.prototype.B=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},to.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?J(new Xn("user-token-expired")):t||!this.b||Sa()>this.c-3e4?this.a?ro(this,{grant_type:"refresh_token",refresh_token:this.a}):Y(null):Y({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},io.prototype.B=function(){return{lastLoginAt:this.b,createdAt:this.a}},d(oo,Ot),d(ao,zt),ao.prototype.na=function(t){this.ha=t,xr(this.c,t)},ao.prototype.$=function(){return this.ha},ao.prototype.Ka=function(){return S(this.R)},ao.prototype.Ga=function(){this.l.b&&(Zi(this.l),this.l.start())},Gn(ao.prototype,"providerId","firebase"),(ba=ao.prototype).reload=function(){var t=this;return Mo(this,_o(this).then(function(){return Co(t).then(function(){return yo(t)}).then(go)}))},ba.F=function(t){var e=this;return Mo(this,_o(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new Xn("internal-error");return t.accessToken!=e.pa&&(po(e,t.accessToken),Xt(e,new oo("tokenChanged"))),To(e,"refreshToken",t.refreshToken),t.accessToken}))},ba.getToken=function(t){return vu["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]||(vu["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead.")),this.F(t)},ba.kc=function(t){if(!(t=t.users)||!t.length)throw new Xn("internal-error");vo(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=No(t),n=0;n<e.length;n++)wo(this,e[n]);To(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},ba.Za=function(t){var e=this,n=null;return Mo(this,t.c(this.c,this.uid).then(function(t){return So(e,t),n=Ro(e,t,"reauthenticate"),e.i=null,e.reload()}).then(function(){return n}),!0)},ba.mc=function(t){return this.Za(t).then(function(){})},ba.Xa=function(t){var e=this,n=null;return Mo(this,Ao(this,t.providerId).then(function(){return e.F()}).then(function(n){return t.b(e.c,n)}).then(function(t){return n=Ro(e,t,"link"),Oo(e,t)}).then(function(){return n}))},ba.cc=function(t){return this.Xa(t).then(function(t){return t.user})},ba.dc=function(t,e){var n=this;return Mo(this,Ao(this,"phone").then(function(){return Yi(ho(n),t,e,f(n.Xa,n))}))},ba.nc=function(t,e){var n=this;return Mo(this,Y().then(function(){return Yi(ho(n),t,e,f(n.Za,n))}),!0)},ba.kb=function(t){var e=this;return Mo(this,this.F().then(function(n){return e.c.kb(n,t)}).then(function(t){return So(e,t),e.reload()}))},ba.Dc=function(t){var e=this;return Mo(this,this.F().then(function(n){return t.b(e.c,n)}).then(function(t){return So(e,t),e.reload()}))},ba.lb=function(t){var e=this;return Mo(this,this.F().then(function(n){return e.c.lb(n,t)}).then(function(t){return So(e,t),e.reload()}))},ba.mb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return _o(this);var e=this;return Mo(this,this.F().then(function(n){return e.c.mb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return So(e,t),To(e,"displayName",t.displayName||null),To(e,"photoURL",t.photoUrl||null),Fa(e.providerData,function(t){"password"===t.providerId&&(Gn(t,"displayName",e.displayName),Gn(t,"photoURL",e.photoURL))}),yo(e)}).then(go))},ba.Cc=function(t){var e=this;return Mo(this,Co(this).then(function(n){return E(bo(e),t)?function(t,e,n){return Xr(t,nc,{idToken:e,deleteProvider:n})}(e.c,n,[t]).then(function(t){var n={};return Fa(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),Fa(bo(e),function(t){n[t]||Eo(e,t)}),n[Cr.PROVIDER_ID]||Gn(e,"phoneNumber",null),yo(e)}):yo(e).then(function(){throw new Xn("no-such-provider")})}))},ba.delete=function(){var t=this;return Mo(this,this.F().then(function(e){return Xr(t.c,ec,{idToken:e})}).then(function(){Xt(t,new oo("userDeleted"))})).then(function(){for(var e=0;e<t.A.length;e++)t.A[e].cancel("app-deleted");so(t,null),co(t,null),t.A=[],t.m=!0,fo(t),Gn(t,"refreshToken",null),t.a&&t.a.unsubscribe(t)})},ba.ob=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.Z||null)==e||"reauthViaRedirect"==t&&(this.Z||null)==e)},ba.fa=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},ba.va=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?f(this.tb,this):"reauthViaPopup"==t&&e==(this.g||null)?f(this.ub,this):"linkViaRedirect"==t&&(this.Z||null)==e?f(this.tb,this):"reauthViaRedirect"==t&&(this.Z||null)==e?f(this.ub,this):null},ba.ec=function(t){var e=this;return Po(this,"linkViaPopup",t,function(){return Ao(e,t.providerId).then(function(){return yo(e)})},!1)},ba.oc=function(t){return Po(this,"reauthViaPopup",t,function(){return Y()},!0)},ba.fc=function(t){var e=this;return Do(this,"linkViaRedirect",t,function(){return Ao(e,t.providerId)},!1)},ba.pc=function(t){return Do(this,"reauthViaRedirect",t,function(){return Y()},!0)},ba.tb=function(t,e){var n=this;this.b&&(this.b.cancel(),this.b=null);var r=null;return Mo(this,this.F().then(function(r){return Qr(n.c,{requestUri:t,sessionId:e,idToken:r})}).then(function(t){return r=Ro(n,t,"link"),Oo(n,t)}).then(function(){return r}))},ba.ub=function(t,e){var n=this;this.b&&(this.b.cancel(),this.b=null);var r=null;return Mo(this,Y().then(function(){return ur(Hr(n.c,{requestUri:t,sessionId:e}),n.uid)}).then(function(t){return r=Ro(n,t,"reauthenticate"),So(n,t),n.i=null,n.reload()}).then(function(){return r}),!0)},ba.bb=function(t){var e=this,n=null;return Mo(this,this.F().then(function(e){return n=e,void 0===t||P(t)?{}:$n(new Jn(t))}).then(function(t){return e.c.bb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},ba.toJSON=function(){return this.B()},ba.B=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.G,appName:this.o,authDomain:this.w,stsTokenManager:this.h.B(),redirectEventId:this.Z||null};return this.metadata&&M(t,this.metadata.B()),Fa(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),t};var Uc={name:"redirectUser",C:"session"};Fo.prototype.g=function(){var t=this,e=Bo("local");Wo(this,function(){return Y().then(function(){return t.c&&"local"!=t.c.C?t.b.get(e,t.a):null}).then(function(n){if(n)return Uo(t,"local").then(function(){t.c=e})})})};var Bc={name:"persistence",C:"session"};Fo.prototype.eb=function(t){var e=null,n=this;return function(t){var e=new Xn("invalid-persistence-type"),n=new Xn("unsupported-persistence-type");t:{for(r in Dc)if(Dc[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(In()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!On()&&"none"!==t)throw n}}(t),Wo(this,function(){return t!=n.c.C?n.b.get(n.c,n.a).then(function(r){return e=r,Uo(n,t)}).then(function(){if(n.c=Bo(t),e)return n.b.set(n.c,e,n.a)}):Y()})},d(Ko,zt),d(Go,Ot),d(Qo,Ot),(ba=Ko.prototype).eb=function(t){return t=this.h.eb(t),ea(this,t)},ba.na=function(t){this.V===t||this.l||(this.V=t,xr(this.c,this.V),Xt(this,new Go(this.$())))},ba.$=function(){return this.V},ba.Ec=function(){var t=Ta.navigator;this.na(t?t.languages&&t.languages[0]||t.language||t.userLanguage||null:null)},ba.gc=function(t){this.A.push(t),Fr(this.c,wa.SDK_VERSION?Nn(wa.SDK_VERSION,this.A):null),Xt(this,new Qo(this.A))},ba.Ka=function(){return S(this.A)},ba.toJSON=function(){return{apiKey:Jo(this).options.apiKey,authDomain:Jo(this).options.authDomain,appName:Jo(this).name,currentUser:$o(this)&&$o(this).B()}},ba.ob=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},ba.fa=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},ba.va=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?f(this.Sb,this):null},ba.Sb=function(t,e){var n=this;t={requestUri:t,sessionId:e},this.b&&(this.b.cancel(),this.b=null);var r=null,i=null,o=Gr(n.c,t).then(function(t){return r=Nr(t),i=er(t),t});return t=n.U.then(function(){return o}).then(function(t){return zo(n,t)}).then(function(){return Hn({user:$o(n),credential:r,additionalUserInfo:i,operationType:"signIn"})}),ea(this,t)},ba.wc=function(t){if(!Pn())return J(new Xn("operation-not-supported-in-this-environment"));var e=this,n=tr(t.providerId),r=Un(),i=null;(!Mn()||Tn())&&Jo(this).options.authDomain&&t.isOAuthProvider&&(i=si(Jo(this).options.authDomain,Jo(this).options.apiKey,Jo(this).name,"signInViaPopup",t,null,r,wa.SDK_VERSION||null));var o=bn(i,n&&n.za,n&&n.ya);return n=Ho(this).then(function(e){return qi(e,o,"signInViaPopup",t,r,!!i)}).then(function(){return new H(function(t,n){e.fa("signInViaPopup",null,new Xn("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=r,e.b=e.a.Ca(e,"signInViaPopup",o,r)})}).then(function(t){return o&&_n(o),t?Hn(t):null}).s(function(t){throw o&&_n(o),t}),ea(this,n)},ba.xc=function(t){if(!Pn())return J(new Xn("operation-not-supported-in-this-environment"));var e=this;return ea(this,Ho(this).then(function(){return function(t){return Wo(t,function(){return t.b.set(Bc,t.c.C,t.a)})}(e.h)}).then(function(){return e.a.Aa("signInViaRedirect",t)}))},ba.aa=function(){if(!Pn())return J(new Xn("operation-not-supported-in-this-environment"));var t=this;return ea(this,Ho(this).then(function(){return t.a.aa()}).then(function(t){return t?Hn(t):null}))},ba.hb=function(){var t=this;return ea(this,this.i.then(function(){return $o(t)?(Xo(t,null),qo(t.h).then(function(){ta(t)})):Y()}))},ba.yc=function(){var t=this;return jo(this.h,Jo(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=$o(t)&&e){n=$o(t).uid;var r=e.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return Io($o(t),e),$o(t).F();($o(t)||e)&&(Xo(t,e),e&&(mo(e),e.ca=t.G),t.a&&t.a.subscribe(t),ta(t))}})},ba.ka=function(t){return Vo(this.h,t)},ba.Tb=function(){ta(this),this.ka($o(this))},ba.Zb=function(){this.hb()},ba.$b=function(){this.hb()},ba.ac=function(t){var e=this;this.addAuthTokenListener(function(){t.next($o(e))})},ba.bc=function(t){var e=this;!function(t,e){t.I.push(e),ea(t,t.i.then(function(){!t.l&&E(t.I,e)&&t.R!==t.getUid()&&(t.R=t.getUid(),e(Zo(t)))}))}(this,function(){t.next($o(e))})},ba.ic=function(t,e,n){var r=this;return this.W&&wa.Promise.resolve().then(function(){u(t)?t($o(r)):u(t.next)&&t.next($o(r))}),this.Kb(t,e,n)},ba.hc=function(t,e,n){var r=this;return this.W&&wa.Promise.resolve().then(function(){r.R=r.getUid(),u(t)?t($o(r)):u(t.next)&&t.next($o(r))}),this.Lb(t,e,n)},ba.Vb=function(t){var e=this;return ea(this,this.i.then(function(){return $o(e)?$o(e).F(t).then(function(t){return{accessToken:t}}):null}))},ba.tc=function(t){return this.Eb(t).then(function(t){return t.user})},ba.Eb=function(t){var e=this;return this.i.then(function(){return Yo(e,Xr(e.c,mc,{token:t}))}).then(function(t){var n=t.user;return To(n,"isAnonymous",!1),e.ka(n),t})},ba.Fb=function(t,e){var n=this;return this.i.then(function(){return Yo(n,Xr(n.c,vc,{email:t,password:e}))})},ba.uc=function(t,e){return this.Fb(t,e).then(function(t){return t.user})},ba.Ob=function(t,e){return this.qb(t,e).then(function(t){return t.user})},ba.qb=function(t,e){var n=this;return this.i.then(function(){return Yo(n,Xr(n.c,Zu,{email:t,password:e}))})},ba.sc=function(t){return this.fb(t).then(function(t){return t.user})},ba.fb=function(t){var e=this;return this.i.then(function(){return Yo(e,t.wa(e.c))})},ba.gb=function(){return this.Gb().then(function(t){return t.user})},ba.Gb=function(){var t=this;return this.i.then(function(){var e=$o(t);if(e&&e.isAnonymous){return Hn({user:e,credential:null,additionalUserInfo:Hn({providerId:null,isNewUser:!1}),operationType:"signIn"})}return Yo(t,t.c.gb()).then(function(e){var n=e.user;return To(n,"isAnonymous",!0),t.ka(n),e})})},ba.getUid=function(){return $o(this)&&$o(this).uid||null},ba.Mb=function(t){this.addAuthTokenListener(t),this.o++,0<this.o&&$o(this)&&lo($o(this))},ba.qc=function(t){var e=this;Fa(this.m,function(n){n==t&&e.o--}),0>this.o&&(this.o=0),0==this.o&&$o(this)&&fo($o(this)),this.removeAuthTokenListener(t)},ba.addAuthTokenListener=function(t){var e=this;this.m.push(t),ea(this,this.i.then(function(){e.l||E(e.m,t)&&t(Zo(e))}))},ba.removeAuthTokenListener=function(t){I(this.m,function(e){return e==t})},ba.delete=function(){this.l=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel("app-deleted");return this.N=[],this.h&&(t=this.h,Ni(t.b,t.a,this.ha)),this.a&&this.a.unsubscribe(this),wa.Promise.resolve()},ba.Rb=function(t){return ea(this,function(t,e){return Xr(t,tc,{identifier:e,continueUri:Dn()?yn():"http://localhost"}).then(function(t){return t.allProviders||[]})}(this.c,t))},ba.Fc=function(t){return this.Ia(t).then(function(t){return t.data.email})},ba.Ta=function(t,e){return ea(this,this.c.Ta(t,e).then(function(){}))},ba.Ia=function(t){return ea(this,this.c.Ia(t).then(function(t){return new function(t){var e={},n=t[_u],r=t[bu];if(t=t[wu],!n||!t)throw Error("Invalid provider user info!");e[Tu]=r||null,e[Eu]=n,Gn(this,Cu,t),Gn(this,Iu,zn(e))}(t)}))},ba.Sa=function(t){return ea(this,this.c.Sa(t).then(function(){}))},ba.cb=function(t,e){var n=this;return ea(this,Y().then(function(){return void 0===e||P(e)?{}:$n(new Jn(e))}).then(function(e){return n.c.cb(t,e)}).then(function(){}))},ba.vc=function(t,e){return ea(this,Yi(this,t,e,f(this.fb,this)))};var Vc="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" "),qc="callback",jc="expired-callback",Wc="sitekey",Kc="size";(ba=la.prototype).xa=function(){var t=this;return this.c?this.c:this.c=pa(this,Y().then(function(){if(Dn())return wn();throw new Xn("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return function(t,e){return new H(function(n,r){qn()?!Ta.grecaptcha||e!==t.c&&!t.b?(Ta[t.a]=function(){if(Ta.grecaptcha){t.c=e;var i=Ta.grecaptcha.render;Ta.grecaptcha.render=function(e,n){return e=i(e,n),t.b++,e},n()}else r(new Xn("internal-error"));delete Ta[t.a]},Y(sn(yt(Gc,{onload:t.a,hl:e||""}))).s(function(){r(new Xn("internal-error","Unable to load external reCAPTCHA dependencies!"))})):n():r(new Xn("network-request-failed"))})}(ya(),t.o())}).then(function(){return Xr(t.u,sc,{})}).then(function(e){t.a[Wc]=e.recaptchaSiteKey}).s(function(e){throw t.c=null,e}))},ba.render=function(){da(this);var t=this;return pa(this,this.xa().then(function(){if(null===t.b){var e=t.l;if(!t.h){var n=Et(e);e=It("DIV"),n.appendChild(e)}t.b=grecaptcha.render(e,t.a)}return t.b}))},ba.verify=function(){da(this);var t=this;return pa(this,this.render().then(function(e){return new H(function(n){var r=grecaptcha.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){I(t.i,function(t){return t==e})}(t,i),n(e))};t.i.push(i),t.h&&grecaptcha.execute(t.b)}})}))},ba.reset=function(){da(this),null!==this.b&&grecaptcha.reset(this.b)},ba.clear=function(){da(this),this.m=!0,ya().b--;for(var t=0;t<this.g.length;t++)this.g[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.h){t=Et(this.l);for(var e;e=t.firstChild;)t.removeChild(e)}};var Gc=ft("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Qc=null;d(ma,la),va(Ko.prototype,{Sa:{name:"applyActionCode",j:[ra("code")]},Ia:{name:"checkActionCode",j:[ra("code")]},Ta:{name:"confirmPasswordReset",j:[ra("code"),ra("newPassword")]},Ob:{name:"createUserWithEmailAndPassword",j:[ra("email"),ra("password")]},qb:{name:"createUserAndRetrieveDataWithEmailAndPassword",j:[ra("email"),ra("password")]},Rb:{name:"fetchProvidersForEmail",j:[ra("email")]},aa:{name:"getRedirectResult",j:[]},hc:{name:"onAuthStateChanged",j:[ha(oa(),aa(),"nextOrObserver"),aa("opt_error",!0),aa("opt_completed",!0)]},ic:{name:"onIdTokenChanged",j:[ha(oa(),aa(),"nextOrObserver"),aa("opt_error",!0),aa("opt_completed",!0)]},cb:{name:"sendPasswordResetEmail",j:[ra("email"),ha(oa("opt_actionCodeSettings",!0),sa(null,!0),"opt_actionCodeSettings",!0)]},eb:{name:"setPersistence",j:[ra("persistence")]},fb:{name:"signInAndRetrieveDataWithCredential",j:[ua()]},gb:{name:"signInAnonymously",j:[]},Gb:{name:"signInAnonymouslyAndRetrieveData",j:[]},sc:{name:"signInWithCredential",j:[ua()]},tc:{name:"signInWithCustomToken",j:[ra("token")]},Eb:{name:"signInAndRetrieveDataWithCustomToken",j:[ra("token")]},uc:{name:"signInWithEmailAndPassword",j:[ra("email"),ra("password")]},Fb:{name:"signInAndRetrieveDataWithEmailAndPassword",j:[ra("email"),ra("password")]},vc:{name:"signInWithPhoneNumber",j:[ra("phoneNumber"),ca()]},wc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},xc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},hb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[ra(null,!0)]},Ec:{name:"useDeviceLanguage",j:[]},Fc:{name:"verifyPasswordResetCode",j:[ra("code")]}}),function(t,e){for(var n in e){var r=e[n].name;if(r!==n){var i=e[n].Nb;Object.defineProperty(t,r,{get:function(){return this[n]},set:function(t){na(r,[i],[t],!0),this[n]=t},enumerable:!0})}}}(Ko.prototype,{lc:{name:"languageCode",Nb:ha(ra(),sa(),"languageCode")}}),(Ko.Persistence=Dc).LOCAL="local",Ko.Persistence.SESSION="session",Ko.Persistence.NONE="none",va(ao.prototype,{delete:{name:"delete",j:[]},F:{name:"getIdToken",j:[ia()]},getToken:{name:"getToken",j:[ia()]},Xa:{name:"linkAndRetrieveDataWithCredential",j:[ua()]},cc:{name:"linkWithCredential",j:[ua()]},dc:{name:"linkWithPhoneNumber",j:[ra("phoneNumber"),ca()]},ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Za:{name:"reauthenticateAndRetrieveDataWithCredential",j:[ua()]},mc:{name:"reauthenticateWithCredential",j:[ua()]},nc:{name:"reauthenticateWithPhoneNumber",j:[ra("phoneNumber"),ca()]},oc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},pc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},bb:{name:"sendEmailVerification",j:[ha(oa("opt_actionCodeSettings",!0),sa(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[ra(null,!0)]},Cc:{name:"unlink",j:[ra("provider")]},kb:{name:"updateEmail",j:[ra("email")]},lb:{name:"updatePassword",j:[ra("password")]},Dc:{name:"updatePhoneNumber",j:[ua("phone")]},mb:{name:"updateProfile",j:[oa("profile")]}}),va(H.prototype,{s:{name:"catch"},then:{name:"then"}}),va(Xi.prototype,{confirm:{name:"confirm",j:[ra("verificationCode")]}}),ga(Er,"credential",function(t,e){return new wr(t,e)},[ra("email"),ra("password")]),va(pr.prototype,{sa:{name:"addScope",j:[ra("scope")]},Ba:{name:"setCustomParameters",j:[oa("customOAuthParameters")]}}),ga(pr,"credential",dr,[ha(ra(),oa(),"token")]),va(yr.prototype,{sa:{name:"addScope",j:[ra("scope")]},Ba:{name:"setCustomParameters",j:[oa("customOAuthParameters")]}}),ga(yr,"credential",mr,[ha(ra(),oa(),"token")]),va(vr.prototype,{sa:{name:"addScope",j:[ra("scope")]},Ba:{name:"setCustomParameters",j:[oa("customOAuthParameters")]}}),ga(vr,"credential",gr,[ha(ra(),ha(oa(),sa()),"idToken"),ha(ra(),sa(),"accessToken",!0)]),va(_r.prototype,{Ba:{name:"setCustomParameters",j:[oa("customOAuthParameters")]}}),ga(_r,"credential",br,[ha(ra(),oa(),"token"),ra("secret",!0)]),va(fr.prototype,{sa:{name:"addScope",j:[ra("scope")]},credential:{name:"credential",j:[ha(ra(),sa(),"idToken",!0),ha(ra(),sa(),"accessToken",!0)]},Ba:{name:"setCustomParameters",j:[oa("customOAuthParameters")]}}),ga(Cr,"credential",Sr,[ra("verificationId"),ra("verificationCode")]),va(Cr.prototype,{Qa:{name:"verifyPhoneNumber",j:[ra("phoneNumber"),ca()]}}),va(Xn.prototype,{toJSON:{name:"toJSON",j:[ra(null,!0)]}}),va(Dr.prototype,{toJSON:{name:"toJSON",j:[ra(null,!0)]}}),va(Pr.prototype,{toJSON:{name:"toJSON",j:[ra(null,!0)]}}),va(ma.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if(void 0===wa||!wa.INTERNAL||!wa.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:Ko,Error:Xn};ga(t,"EmailAuthProvider",Er,[]),ga(t,"FacebookAuthProvider",pr,[]),ga(t,"GithubAuthProvider",yr,[]),ga(t,"GoogleAuthProvider",vr,[]),ga(t,"TwitterAuthProvider",_r,[]),ga(t,"OAuthProvider",fr,[ra("providerId")]),ga(t,"PhoneAuthProvider",Cr,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof Ko)}}]),ga(t,"RecaptchaVerifier",ma,[ha(ra(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),oa("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof wa.app.App)}}]),wa.INTERNAL.registerService("auth",function(t,e){return t=new Ko(t),e({INTERNAL:{getUid:f(t.getUid,t),getToken:f(t.Vb,t),addAuthTokenListener:f(t.Mb,t),removeAuthTokenListener:f(t.qc,t)}}),t},t,function(t,e){if("create"===t)try{e.auth()}catch(t){}}),wa.INTERNAL.extendNamespace({User:ao})}()}).call(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(e,n("DuR2"))},"RMj/":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5");e.nextPushId=function(){var t="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",e=0,n=[];return function(i){var o=i===e;e=i;var a,s=new Array(8);for(a=7;a>=0;a--)s[a]=t.charAt(i%64),i=Math.floor(i/64);r.assert(0===i,"Cannot push at time == 0");var u=s.join("");if(o){for(a=11;a>=0&&63===n[a];a--)n[a]=0;n[a]++}else for(a=0;a<12;a++)n[a]=Math.floor(64*Math.random());for(a=0;a<12;a++)u+=t.charAt(n[a]);return r.assert(20===u.length,"nextPushId: Length should be 20."),u}}()},RcG9:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}();e.ServerActions=r},RlcV:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("rd4o"),i=n("rd4o"),o=Math.log(2),a=function(){function t(t){this.count=function(t){return parseInt(Math.log(t)/o,10)}(t+1),this.current_=this.count-1;var e=function(t){return parseInt(Array(t+1).join("1"),2)}(this.count);this.bits_=t+1&e}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}();e.buildChildSet=function(t,e,n,o){t.sort(e);var s=function(e,i){var o,a,u=i-e;if(0==u)return null;if(1==u)return o=t[e],a=n?n(o):o,new r.LLRBNode(a,o.node,r.LLRBNode.BLACK,null,null);var c=parseInt(u/2,10)+e,h=s(e,c),l=s(c+1,i);return o=t[c],a=n?n(o):o,new r.LLRBNode(a,o.node,r.LLRBNode.BLACK,h,l)},u=function(e){for(var i=null,o=null,a=t.length,u=function(e,i){var o=a-e,u=a;a-=e;var h=s(o+1,u),l=t[o],f=n?n(l):l;c(new r.LLRBNode(f,l.node,i,null,h))},c=function(t){i?(i.left=t,i=t):(o=t,i=t)},h=0;h<e.count;++h){var l=e.nextBitIsOne(),f=Math.pow(2,e.count-(h+1));l?u(f,r.LLRBNode.BLACK):(u(f,r.LLRBNode.BLACK),u(f,r.LLRBNode.RED))}return o}(new a(t.length));return new i.SortedMap(o||e,u)}},SUTf:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("CWxw"),i=(n.n(r),n("YsRl")),o=(n.n(i),n("ZV5m"));n.n(o)},SenR:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var n=1;n<e.blockSize;++n)e.pad_[n]=0;return e.reset(),e}return r(e,t),e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),a=1518500249):(o=u^c^h,a=1859775393):r<60?(o=u&c|h&(u|c),a=2400959708):(o=u^c^h,a=3395469782);i=(s<<5|s>>>27)+o+l+a+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},e.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0==o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},e.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},e}(n("TGDM").Hash);e.Sha1=i},TGDM:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(){this.blockSize=-1}}();e.Hash=r},TroR:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}();e.CacheNode=r},U1HK:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5");!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(e.OperationType||(e.OperationType={}));var i=function(){function t(t,e,n,i){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=i,r.assert(!i||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}();e.OperationSource=i},"Vu+o":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PROTOCOL_VERSION="5",e.VERSION_PARAM="v",e.TRANSPORT_SESSION_PARAM="s",e.REFERER_PARAM="r",e.FORGE_REF="f",e.FORGE_DOMAIN="firebaseio.com",e.LAST_SESSION_PARAM="ls",e.WEBSOCKET="websocket",e.LONG_POLLING="long_polling"},Xiq3:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("U1HK"),i=n("mnK5"),o=n("/WFI"),a=n("lscU"),s=n("n1q+"),u=n("ytZ3"),c=n("6m+W"),h=n("KbSj"),l=n("gfrZ"),f=function(){return function(t,e){this.viewCache=t,this.changes=e}}();e.ProcessorResult=f;var p=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){i.assert(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),i.assert(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,a,s){var u,c,h=new o.ChildChangeAccumulator;if(n.type===r.OperationType.OVERWRITE){var l=n;l.source.fromUser?u=this.applyUserOverwrite_(e,l.path,l.snap,a,s,h):(i.assert(l.source.fromServer,"Unknown source."),c=l.source.tagged||e.getServerCache().isFiltered()&&!l.path.isEmpty(),u=this.applyServerOverwrite_(e,l.path,l.snap,a,s,c,h))}else if(n.type===r.OperationType.MERGE){var p=n;p.source.fromUser?u=this.applyUserMerge_(e,p.path,p.children,a,s,h):(i.assert(p.source.fromServer,"Unknown source."),c=p.source.tagged||e.getServerCache().isFiltered(),u=this.applyServerMerge_(e,p.path,p.children,a,s,c,h))}else if(n.type===r.OperationType.ACK_USER_WRITE){var d=n;u=d.revert?this.revertUserWrite_(e,d.path,a,s,h):this.ackUserWrite_(e,d.path,d.affectedTree,a,s,h)}else{if(n.type!==r.OperationType.LISTEN_COMPLETE)throw i.assertionError("Unknown operation type: "+n.type);u=this.listenComplete_(e,n.path,a,h)}var y=h.getChanges();return t.maybeAddValueEvent_(e,u,y),new f(u,y)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(a.Change.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,o){var a=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var u=void 0,c=void 0;if(e.isEmpty())if(i.assert(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var h=t.getCompleteServerSnap(),l=h instanceof s.ChildrenNode?h:s.ChildrenNode.EMPTY_NODE,f=n.calcCompleteEventChildren(l);u=this.filter_.updateFullNode(t.getEventCache().getNode(),f,o)}else{var p=n.calcCompleteEventCache(t.getCompleteServerSnap());u=this.filter_.updateFullNode(t.getEventCache().getNode(),p,o)}else{var d=e.getFront();if(".priority"==d){i.assert(1==e.getLength(),"Can't have a priority with additional path components");var y=a.getNode();c=t.getServerCache().getNode();var m=n.calcEventCacheAfterServerOverwrite(e,y,c);u=null!=m?this.filter_.updatePriority(y,m):a.getNode()}else{var v=e.popFront(),g=void 0;if(a.isCompleteForChild(d)){c=t.getServerCache().getNode();var _=n.calcEventCacheAfterServerOverwrite(e,a.getNode(),c);g=null!=_?a.getNode().getImmediateChild(d).updateChild(v,_):a.getNode().getImmediateChild(d)}else g=n.calcCompleteChild(d,t.getServerCache());u=null!=g?this.filter_.updateChild(a.getNode(),d,g,v,r,o):a.getNode()}}return t.updateEventSnap(u,a.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,a){var s,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())s=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var h=u.getNode().updateChild(e,n);s=c.updateFullNode(u.getNode(),h,null)}else{var f=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var p=e.popFront(),d=u.getNode().getImmediateChild(f).updateChild(p,n);s=".priority"==f?c.updatePriority(u.getNode(),d):c.updateChild(u.getNode(),f,d,p,l.NO_COMPLETE_CHILD_SOURCE,null)}var y=t.updateServerSnap(s,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),m=new l.WriteTreeCompleteChildSource(r,y,i);return this.generateEventCacheAfterServerEvent_(y,e,r,m,a)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var a,u,c=t.getEventCache(),h=new l.WriteTreeCompleteChildSource(r,t,i);if(e.isEmpty())u=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),a=t.updateEventSnap(u,!0,this.filter_.filtersNodes());else{var f=e.getFront();if(".priority"===f)u=this.filter_.updatePriority(t.getEventCache().getNode(),n),a=t.updateEventSnap(u,c.isFullyInitialized(),c.isFiltered());else{var p=e.popFront(),d=c.getNode().getImmediateChild(f),y=void 0;if(p.isEmpty())y=n;else{var m=h.getCompleteChild(f);y=null!=m?".priority"===p.getBack()&&m.getChild(p.parent()).isEmpty()?m:m.updateChild(p,n):s.ChildrenNode.EMPTY_NODE}if(d.equals(y))a=t;else{var v=this.filter_.updateChild(c.getNode(),f,y,p,h,o);a=t.updateEventSnap(v,c.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,a){var s=this,u=e;return r.foreach(function(r,c){var h=n.child(r);t.cacheHasChild_(e,h.getFront())&&(u=s.applyUserOverwrite_(u,h,c,i,o,a))}),r.foreach(function(r,c){var h=n.child(r);t.cacheHasChild_(e,h.getFront())||(u=s.applyUserOverwrite_(u,h,c,i,o,a))}),u},t.prototype.applyMerge_=function(t,e){return e.foreach(function(e,n){t=t.updateChild(e,n)}),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,a){var s=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,l=t;u=e.isEmpty()?n:c.ImmutableTree.Empty.setTree(e,n);var f=t.getServerCache().getNode();return u.children.inorderTraversal(function(e,n){if(f.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),c=s.applyMerge_(u,n);l=s.applyServerOverwrite_(l,new h.Path(e),c,r,i,o,a)}}),u.children.inorderTraversal(function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!f.hasChild(e)&&!u){var c=t.getServerCache().getNode().getImmediateChild(e),p=s.applyMerge_(c,n);l=s.applyServerOverwrite_(l,new h.Path(e),p,r,i,o,a)}}),l},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var a=t.getServerCache().isFiltered(),s=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,s.getNode().getChild(e),r,i,a,o);if(e.isEmpty()){var l=c.ImmutableTree.Empty;return s.getNode().forEachChild(u.KEY_INDEX,function(t,e){l=l.set(new h.Path(t),e)}),this.applyServerMerge_(t,e,l,r,i,a,o)}return t}var f=c.ImmutableTree.Empty;return n.foreach(function(t,n){var r=e.child(t);s.isCompleteForPath(r)&&(f=f.set(t,s.getNode().getChild(r)))}),this.applyServerMerge_(t,e,f,r,i,a,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,l.NO_COMPLETE_CHILD_SOURCE,r)},t.prototype.revertUserWrite_=function(t,e,n,r,o){var a;if(null!=n.shadowingWrite(e))return t;var u=new l.WriteTreeCompleteChildSource(n,t,r),c=t.getEventCache().getNode(),f=void 0;if(e.isEmpty()||".priority"===e.getFront()){var p=void 0;if(t.getServerCache().isFullyInitialized())p=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var d=t.getServerCache().getNode();i.assert(d instanceof s.ChildrenNode,"serverChildren would be complete if leaf node"),p=n.calcCompleteEventChildren(d)}p=p,f=this.filter_.updateFullNode(c,p,o)}else{var y=e.getFront(),m=n.calcCompleteChild(y,t.getServerCache());null==m&&t.getServerCache().isCompleteForChild(y)&&(m=c.getImmediateChild(y)),(f=null!=m?this.filter_.updateChild(c,y,m,e.popFront(),u,o):t.getEventCache().getNode().hasChild(y)?this.filter_.updateChild(c,y,s.ChildrenNode.EMPTY_NODE,e.popFront(),u,o):c).isEmpty()&&t.getServerCache().isFullyInitialized()&&(a=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(f=this.filter_.updateFullNode(f,a,o))}return a=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(h.Path.Empty),t.updateEventSnap(f,a,this.filter_.filtersNodes())},t}();e.ViewProcessor=p},Xlzd:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n("mnK5"),o=n("ytZ3"),a=n("sC/S"),s=n("i9Ll"),u=n("Izak"),c=n("Amoq"),h=n("KbSj"),l=n("Fx72"),f=n("mnK5"),p=n("adKw"),d=n("mnK5"),y=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return i.assert(r,"Reference.ts has not been loaded"),r},set:function(t){r=t},enumerable:!0,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===o.KEY_INDEX){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",h="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!=c.MIN_NAME)throw new Error(r);if("string"!=typeof e)throw new Error(h)}if(t.hasEnd()){if(t.getIndexEndName()!=c.MAX_NAME)throw new Error(r);if("string"!=typeof n)throw new Error(h)}}else if(t.getIndex()===a.PRIORITY_INDEX){if(null!=e&&!l.isValidPriority(e)||null!=n&&!l.isValidPriority(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(i.assert(t.getIndex()instanceof u.PathIndex||t.getIndex()===s.VALUE_INDEX,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return f.validateArgCount("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){f.validateArgCount("Query.on",2,4,arguments.length),l.validateEventType("Query.on",1,e,!1),f.validateCallback("Query.on",2,n,!1);var o=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[e]=n,this.onChildEvent(a,o.cancel,o.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new p.ValueEventRegistration(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new p.ChildEventRegistration(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){f.validateArgCount("Query.off",0,3,arguments.length),l.validateEventType("Query.off",1,t,!0),f.validateCallback("Query.off",2,e,!0),f.validateContextObject("Query.off",3,n,!0);var r=null,i=null;if("value"===t){var o=e||null;r=new p.ValueEventRegistration(o,null,n||null)}else t&&(e&&((i={})[t]=e),r=new p.ChildEventRegistration(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},t.prototype.once=function(e,n,r,i){var o=this;f.validateArgCount("Query.once",1,4,arguments.length),l.validateEventType("Query.once",1,e,!1),f.validateCallback("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),s=!0,u=new d.Deferred;u.promise.catch(function(){});var c=function(t){s&&(s=!1,o.off(e,c),n&&n.bind(a.context)(t),u.resolve(t))};return this.on(e,c,function(t){o.off(e,c),a.cancel&&a.cancel.bind(a.context)(t),u.reject(t)}),u.promise},t.prototype.limitToFirst=function(e){if(f.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(f.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(f.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');l.validatePathString("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new h.Path(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new u.PathIndex(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){f.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(o.KEY_INDEX);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){f.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(a.PRIORITY_INDEX);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){f.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(s.VALUE_INDEX);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),f.validateArgCount("Query.startAt",0,2,arguments.length),l.validateFirebaseDataArg("Query.startAt",1,e,this.path,!0),l.validateKey("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),f.validateArgCount("Query.endAt",0,2,arguments.length),l.validateFirebaseDataArg("Query.endAt",1,e,this.path,!0),l.validateKey("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(f.validateArgCount("Query.equalTo",1,2,arguments.length),l.validateFirebaseDataArg("Query.equalTo",1,t,this.path,!1),l.validateKey("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return f.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return f.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=c.ObjectToUniqueKey(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(f.validateArgCount("Query.isEqual",1,1,arguments.length),!(e instanceof t)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var n=this.repo===e.repo,r=this.path.equals(e.path),i=this.queryIdentifier()===e.queryIdentifier();return n&&r&&i},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,f.validateCallback(t,3,r.cancel,!0),r.context=n,f.validateContextObject(t,4,r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error(f.errorPrefix(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}();e.Query=y},XpTC:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n("qQjo"),o=n("mnK5"),a=n("mnK5"),s=n("mnK5"),u=n("Amoq"),c=n("KbSj"),h=n("h+Q5"),l=n("pI3a"),f=n("mnK5"),p=n("AmnR"),d=n("mnK5"),y=n("mnK5"),m=1e3,v=3e5,g=function(t){function e(n,r,i,o,a,s){var c=t.call(this)||this;if(c.repoInfo_=n,c.onDataUpdate_=r,c.onConnectStatus_=i,c.onServerInfoUpdate_=o,c.authTokenProvider_=a,c.authOverride_=s,c.id=e.nextPersistentConnectionId_++,c.log_=u.logWrapper("p:"+c.id+":"),c.interruptReasons_={},c.listens_={},c.outstandingPuts_=[],c.outstandingPutCount_=0,c.onDisconnectRequestQueue_=[],c.connected_=!1,c.reconnectDelay_=m,c.maxReconnectDelay_=v,c.securityDebugCallback_=null,c.lastSessionId=null,c.establishConnectionTimer_=null,c.visible_=!1,c.requestCBHash_={},c.requestNumber_=0,c.realtime_=null,c.authToken_=null,c.forceTokenRefresh_=!1,c.invalidAuthTokenCount_=0,c.firstConnection_=!0,c.lastConnectionAttemptTime_=null,c.lastConnectionEstablishedTime_=null,s&&!y.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return c.scheduleConnect_(0),h.VisibilityMonitor.getInstance().on("visible",c.onVisible_,c),-1===n.host.indexOf("fblocal")&&l.OnlineMonitor.getInstance().on("online",c.onOnline_,c),c}return r(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(a.stringify(i)),s.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),o=t.path.toString();this.log_("Listen called for "+o+" "+i),this.listens_[o]=this.listens_[o]||{},s.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),s.assert(!this.listens_[o][i],"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens_[o][i]=a,this.connected_&&this.sendListen_(a)},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r.queryObject(),a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r);(n.listens_[i]&&n.listens_[i][o])===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))})},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&o.contains(t,"w")){var n=o.safeGet(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();u.warn("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||f.isAdmin(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=f.isValidFormat(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))})}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),s.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,function(t){r&&setTimeout(function(){r(t.s,t.d)},Math.floor(0))})},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)})},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}})}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+a.stringify(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):u.error("Unrecognized action received from server: "+a.stringify(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;s.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){e.establishConnectionTimer_=null,e.establishConnection_()},Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=m,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=m,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=m),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,o=this,a=this.lastSessionId,c=!1,h=null,l=function(){h?h.close():(c=!0,r())},f=function(t){s.assert(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(t)};this.realtime_={close:l,sendRequest:f};var y=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(y).then(function(e){c?u.log("getToken() completed but was canceled"):(u.log("getToken() completed. Creating connection."),o.authToken_=e&&e.accessToken,h=new p.Connection(i,o.repoInfo_,t,n,r,function(t){u.warn(t+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")},a))}).then(null,function(t){o.log_("Failed to get token: "+t),c||(d.CONSTANTS.NODE_ADMIN&&u.warn(t),l())})}},e.prototype.interrupt=function(t){u.log("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){u.log("Resuming connection for reason: "+t),delete this.interruptReasons_[t],o.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=m,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map(function(t){return u.ObjectToUniqueKey(t)}).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new c.Path(t).toString();return void 0!==this.listens_[r]?(n=this.listens_[r][e],delete this.listens_[r][e],0===o.getCount(this.listens_[r])&&delete this.listens_[r]):n=void 0,n},e.prototype.onAuthRevoked_=function(t,e){u.log("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&"undefined"!=typeof console&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t=this;this.tryAuth(),o.forEach(this.listens_,function(e,n){o.forEach(n,function(e,n){t.sendListen_(n)})});for(var e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){var n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}},e.prototype.sendConnectStats_=function(){var t={},e="js";d.CONSTANTS.NODE_ADMIN?e="admin_node":d.CONSTANTS.NODE_CLIENT&&(e="node"),t["sdk."+e+"."+i.default.SDK_VERSION.replace(/\./g,"-")]=1,y.isMobileCordova()?t["framework.cordova"]=1:y.isReactNative()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=l.OnlineMonitor.getInstance().currentlyOnline();return o.isEmpty(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(n("RcG9").ServerActions);e.PersistentConnection=g},Y7ra:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=function(){function t(){this.set={}}return t.prototype.add=function(t,e){this.set[t]=null===e||e},t.prototype.contains=function(t){return r.contains(this.set,t)},t.prototype.get=function(t){return this.contains(t)?this.set[t]:void 0},t.prototype.remove=function(t){delete this.set[t]},t.prototype.clear=function(){this.set={}},t.prototype.isEmpty=function(){return r.isEmpty(this.set)},t.prototype.count=function(){return r.getCount(this.set)},t.prototype.each=function(t){r.forEach(this.set,function(e,n){return t(e,n)})},t.prototype.keys=function(){var t=[];return r.forEach(this.set,function(e){t.push(e)}),t},t}();e.CountedSet=i},"YR+7":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("Fx72"),o=n("KbSj"),a=n("sC/S"),s=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return r.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return r.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return r.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return r.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){r.validateArgCount("DataSnapshot.child",0,1,arguments.length),e=String(e),i.validatePathString("DataSnapshot.child",1,e,!1);var n=new o.Path(e),s=this.ref_.child(n);return new t(this.node_.getChild(n),s,a.PRIORITY_INDEX)},t.prototype.hasChild=function(t){r.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),i.validatePathString("DataSnapshot.hasChild",1,t,!1);var e=new o.Path(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return r.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;if(r.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),r.validateCallback("DataSnapshot.forEach",1,e,!1),this.node_.isLeafNode())return!1;return!!this.node_.forEachChild(this.index_,function(r,i){return e(new t(i,n.ref_.child(r),a.PRIORITY_INDEX))})},t.prototype.hasChildren=function(){return r.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),t.prototype.numChildren=function(){return r.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return r.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}();e.DataSnapshot=s},YiEk:function(t,e,n){var r=n("niZR");n("RFlV"),n("fsyv"),n("u48Y"),n("bvzA"),t.exports=r},YsRl:function(t,e){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=e[i];if(t.call(r,o,i,e))return o;i++}}})},ZV5m:function(t,e){Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=e[i];if(t.call(r,o,i,e))return i;i++}return-1}})},ZZsk:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("KbSj"),i=n("sC/S"),o=n("Y7ra"),a=function(){function t(){this.value_=null,this.children_=null}return t.prototype.find=function(t){if(null!=this.value_)return this.value_.getChild(t);if(t.isEmpty()||null==this.children_)return null;var e=t.getFront();if(t=t.popFront(),this.children_.contains(e)){return this.children_.get(e).find(t)}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value_=n,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(e,n);else{null==this.children_&&(this.children_=new o.CountedSet);var r=e.getFront();this.children_.contains(r)||this.children_.add(r,new t);var i=this.children_.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var e=this.value_;this.value_=null;var n=this;return e.forEachChild(i.PRIORITY_INDEX,function(t,e){n.remember(new r.Path(t),e)}),this.forget(t)}if(null!==this.children_){var o=t.getFront();if(t=t.popFront(),this.children_.contains(o)){this.children_.get(o).forget(t)&&this.children_.remove(o)}return!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},t.prototype.forEachTree=function(t,e){null!==this.value_?e(t,this.value_):this.forEachChild(function(n,i){var o=new r.Path(t.toString()+"/"+n);i.forEachTree(o,e)})},t.prototype.forEachChild=function(t){null!==this.children_&&this.children_.each(function(e,n){t(e,n)})},t}();e.SparseSnapshotTree=a},adKw:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("YR+7"),i=n("mPFP"),o=n("mnK5"),a=n("mnK5"),s=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new i.DataEvent("value",this,new r.DataSnapshot(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){a.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new i.CancelEvent(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}();e.ValueEventRegistration=s;var u=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,o.contains(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new i.CancelEvent(this,t,e):null},t.prototype.createEvent=function(t,e){a.assert(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),o=e.getQueryParams().getIndex();return new i.DataEvent(t.type,this,new r.DataSnapshot(t.snapshotNode,n,o),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){a.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var n=o.getCount(e.callbacks_);if(n===o.getCount(this.callbacks_)){if(1===n){var r=o.getAnyKey(e.callbacks_),i=o.getAnyKey(this.callbacks_);return!(i!==r||e.callbacks_[r]&&this.callbacks_[i]&&e.callbacks_[r]!==this.callbacks_[i])}return o.every(this.callbacks_,function(t,n){return e.callbacks_[t]===n})}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}();e.ChildEventRegistration=u},bEdf:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Amoq"),i=n("Y7ra"),o=n("fvGg"),a=n("GhMr"),s=n("Vu+o"),u=n("mnK5"),c=n("mnK5");e.FIREBASE_LONGPOLL_START_PARAM="start",e.FIREBASE_LONGPOLL_CLOSE_COMMAND="close",e.FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",e.FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",e.FIREBASE_LONGPOLL_ID_PARAM="id",e.FIREBASE_LONGPOLL_PW_PARAM="pw",e.FIREBASE_LONGPOLL_SERIAL_PARAM="ser",e.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",e.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",e.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",e.FIREBASE_LONGPOLL_DATA_PARAM="d",e.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM="disconn",e.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe";var h=function(){function t(t,e,n,i){this.connId=t,this.repoInfo=e,this.transportSessionId=n,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=r.logWrapper(t),this.stats_=o.StatsManager.getCollection(e),this.urlFn=function(t){return e.connectionURL(s.LONG_POLLING,t)}}return t.prototype.open=function(t,n){var i=this;this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new a.PacketReceiver(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){i.log_("Timed out trying to connect."),i.onClosed_(),i.connectTimeoutTimer_=null},Math.floor(3e4)),r.executeWhenDOMReady(function(){if(!i.isClosed_){i.scriptTagHolder=new l(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t[0],o=t[1],a=t[2];t[3],t[4];if(i.incrementIncomingBytes_(t),i.scriptTagHolder)if(i.connectTimeoutTimer_&&(clearTimeout(i.connectTimeoutTimer_),i.connectTimeoutTimer_=null),i.everConnected_=!0,r==e.FIREBASE_LONGPOLL_START_PARAM)i.id=o,i.password=a;else{if(r!==e.FIREBASE_LONGPOLL_CLOSE_COMMAND)throw new Error("Unrecognized command received: "+r);o?(i.scriptTagHolder.sendNewPolls=!1,i.myPacketOrderer.closeAfter(o,function(){i.onClosed_()})):i.onClosed_()}},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],r=t[1];i.incrementIncomingBytes_(t),i.myPacketOrderer.handleResponse(n,r)},function(){i.onClosed_()},i.urlFn);var t={};t[e.FIREBASE_LONGPOLL_START_PARAM]="t",t[e.FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(1e8*Math.random()),i.scriptTagHolder.uniqueCallbackIdentifier&&(t[e.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=i.scriptTagHolder.uniqueCallbackIdentifier),t[s.VERSION_PARAM]=s.PROTOCOL_VERSION,i.transportSessionId&&(t[s.TRANSPORT_SESSION_PARAM]=i.transportSessionId),i.lastSessionId&&(t[s.LAST_SESSION_PARAM]=i.lastSessionId),!c.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(s.FORGE_DOMAIN)&&(t[s.REFERER_PARAM]=s.FORGE_REF);var n=i.urlFn(t);i.log_("Connecting via long-poll to "+n),i.scriptTagHolder.addTag(n,function(){})}})},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return t.forceAllow_||!t.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!r.isChromeExtensionContentScript()&&!r.isWindowsStoreApp()&&!c.isNodeSdk()},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=u.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=u.base64Encode(e),i=r.splitStringBySize(n,1840),o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,n){if(!c.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var r={};r[e.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",r[e.FIREBASE_LONGPOLL_ID_PARAM]=t,r[e.FIREBASE_LONGPOLL_PW_PARAM]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=u.stringify(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}();e.BrowserPollConnection=h;var l=function(){function t(n,o,a,s){if(this.onDisconnect=a,this.urlFn=s,this.outstandingRequests=new i.CountedSet,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,c.isNodeSdk())this.commandCB=n,this.onMessageCB=o;else{this.uniqueCallbackIdentifier=r.LUIDGenerator(),window[e.FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=n,window[e.FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=o,this.myIFrame=t.createIFrame_();var u="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){u='<script>document.domain="'+document.domain+'";<\/script>'}var h="<html><body>"+u+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(h),this.myIFrame.doc.close()}catch(t){r.log("frame writing exception"),t.stack&&r.log(t.stack),r.log(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||r.log("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var n=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==n.myIFrame&&(document.body.removeChild(n.myIFrame),n.myIFrame=null)},Math.floor(0))),c.isNodeSdk()&&this.myID){var r={};r[e.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM]="t",r[e.FIREBASE_LONGPOLL_ID_PARAM]=this.myID,r[e.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW;var i=this.urlFn(r);t.nodeRestRequest(i)}var o=this.onDisconnect;o&&(this.onDisconnect=null,o())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t[e.FIREBASE_LONGPOLL_ID_PARAM]=this.myID,t[e.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,t[e.FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;for(var n=this.urlFn(t),r="",i=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+r.length<=1870))break;var o=this.pendingSegs.shift();r=r+"&"+e.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+i+"="+o.seg+"&"+e.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+i+"="+o.ts+"&"+e.FIREBASE_LONGPOLL_DATA_PARAM+i+"="+o.d,i++}return n+=r,this.addLongPollTag_(n,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e,1);var r=function(){n.outstandingRequests.remove(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,function(){clearTimeout(i),r()})},t.prototype.addTag=function(t,e){var n=this;c.isNodeSdk()?this.doNodeLongPoll(t,e):setTimeout(function(){try{if(!n.sendNewPolls)return;var i=n.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){var t=i.readyState;t&&"loaded"!==t&&"complete"!==t||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),e())},i.onerror=function(){r.log("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(i)}catch(t){}},Math.floor(1))},t}();e.FirebaseIFrameScriptHolder=l},bvzA:function(t,e,n){n("hchG")},cBKv:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("KbSj"),o=n("mnK5"),a=function(){return function(){this.children={},this.childCount=0,this.value=null}}();e.TreeNode=a;var s=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new a),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n,r=e instanceof i.Path?e:new i.Path(e),s=this;null!==(n=r.getFront());){s=new t(n,s,o.safeGet(s.node_.children,n)||new a),r=r.popFront()}return s},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){r.assert(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;o.forEach(this.node_.children,function(r,i){e(new t(r,n,i))})},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild(function(e){e.forEachDescendant(t,!0,n)}),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild(function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)})},t.prototype.path=function(){return new i.Path(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=o.contains(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}();e.Tree=s},eIZu:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("KbSj"),i=n("ovUe"),o=n("Amoq");e.parseRepoInfo=function(t){var n=e.parseURL(t),a=n.subdomain;"firebase"===n.domain&&o.fatal(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),a&&"undefined"!=a||o.fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||o.warnIfPageIsSecure();var s="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new i.RepoInfo(n.host,n.secure,a,s),path:new r.Path(n.pathString)}},e.parseURL=function(t){var e="",n="",r="",i="",o=!0,a="https",s=443;if("string"==typeof t){var u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));var c=t.indexOf("/");-1===c&&(c=t.length),e=t.substring(0,c),i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(c));var h=e.split(".");3===h.length?(n=h[1],r=h[0].toLowerCase()):2===h.length&&(n=h[0]),(u=e.indexOf(":"))>=0&&(o="https"===a||"wss"===a,s=parseInt(e.substring(u+1),10))}return{host:e,port:s,domain:n,subdomain:r,secure:o,scheme:a,pathString:i}}},fIBc:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n("qQjo"),i=n("mnK5"),o=n("Amoq"),a=n("fvGg"),s=n("Vu+o"),u=n("mnK5"),c=n("nf05"),h=n("mnK5"),l=n("mnK5"),f=null;"undefined"!=typeof MozWebSocket?f=MozWebSocket:"undefined"!=typeof WebSocket&&(f=WebSocket),e.setWebSocketImpl=function(t){f=t};var p=function(){function e(t,n,r,i){this.connId=t,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=o.logWrapper(this.connId),this.stats_=a.StatsManager.getCollection(n),this.connURL=e.connectionURL_(n,r,i)}return e.connectionURL_=function(t,e,n){var r={};return r[s.VERSION_PARAM]=s.PROTOCOL_VERSION,!l.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(s.FORGE_DOMAIN)&&(r[s.REFERER_PARAM]=s.FORGE_REF),e&&(r[s.TRANSPORT_SESSION_PARAM]=e),n&&(r[s.LAST_SESSION_PARAM]=n),t.connectionURL(s.WEBSOCKET,r)},e.prototype.open=function(e,n){var i=this;this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,c.PersistentStorage.set("previous_websocket_failure",!0);try{if(l.isNodeSdk()){var o=u.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",a={headers:{"User-Agent":"Firebase/"+s.PROTOCOL_VERSION+"/"+r.default.SDK_VERSION+"/"+t.platform+"/"+o}},h=Object({NODE_ENV:"production"}),p=0==this.connURL.indexOf("wss://")?h.HTTPS_PROXY||h.https_proxy:h.HTTP_PROXY||h.http_proxy;p&&(a.proxy={origin:p}),this.mySock=new f(this.connURL,[],a)}else this.mySock=new f(this.connURL)}catch(t){this.log_("Error instantiating WebSocket.");var d=t.message||t.data;return d&&this.log_(d),void this.onClosed_()}this.mySock.onopen=function(){i.log_("Websocket connected."),i.everConnected_=!0},this.mySock.onclose=function(){i.log_("Websocket connection was disconnected."),i.mySock=null,i.onClosed_()},this.mySock.onmessage=function(t){i.handleIncomingFrame(t)},this.mySock.onerror=function(t){i.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&i.log_(e),i.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==f&&!e.forceDisallow_},e.previouslyFailed=function(){return c.PersistentStorage.isInMemoryStorage||!0===c.PersistentStorage.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){c.PersistentStorage.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length==this.totalFrames){var e=this.frames.join("");this.frames=null;var n=h.jsonEval(e);this.onMessage(n)}},e.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},e.prototype.extractFrameCount_=function(t){if(i.assert(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},e.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},e.prototype.send=function(t){this.resetKeepAlive();var e=h.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=o.splitStringBySize(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()},Math.floor(45e3))},e.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}();e.WebSocketConnection=p}).call(e,n("W2nU"))},fsyv:function(t,e,n){t.exports=n("rASK")},fvGg:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("ht/+"),i=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new r.StatsCollection),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}();e.StatsManager=i},gfrZ:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("TroR"),i=function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}();e.NoCompleteChildSource_=i,e.NO_COMPLETE_CHILD_SOURCE=new i;var o=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new r.CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}();e.WriteTreeCompleteChildSource=o},"h+Q5":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n("k6UL"),o=n("mnK5"),a=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))},!1),r}return r(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return o.assert("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(i.EventEmitter);e.VisibilityMonitor=a},hchG:function(t,e,n){"use strict";function r(t){return"storage/"+t}function i(){return new dt(yt.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function o(){return new dt(yt.CANCELED,"User canceled the upload/download.")}function a(){return new dt(yt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function s(t,e,n){return new dt(yt.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function u(){return new dt(yt.APP_DELETED,"The Firebase app was deleted.")}function c(t,e){return new dt(yt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function h(t){throw new dt(yt.INTERNAL_ERROR,"Internal error: "+t)}function l(t){switch(t){case mt.RAW:case mt.BASE64:case mt.BASE64URL:case mt.DATA_URL:return;default:throw"Expected one of the event types: ["+mt.RAW+", "+mt.BASE64+", "+mt.BASE64URL+", "+mt.DATA_URL+"]."}}function f(t,e){switch(t){case mt.RAW:return new vt(p(e));case mt.BASE64:case mt.BASE64URL:return new vt(d(t,e));case mt.DATA_URL:return new vt(function(t){var e=new gt(t);return e.base64?d(mt.BASE64,e.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw c(mt.DATA_URL,"Malformed data URL.")}return p(e)}(e.rest)}(e),function(t){return new gt(t).contentType}(e))}throw i()}function p(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else e.push(239,191,189)}else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function d(t,e){switch(t){case mt.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r){throw c(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break;case mt.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o){throw c(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?")}e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(e){throw c(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}function y(t){switch(t){case bt.RUNNING:case bt.PAUSING:case bt.CANCELING:return wt.RUNNING;case bt.PAUSED:return wt.PAUSED;case bt.SUCCESS:return wt.SUCCESS;case bt.CANCELED:return wt.CANCELED;case bt.ERROR:default:return wt.ERROR}}function m(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function v(t,e){for(var n in t)m(t,n)&&e(n,t[n])}function g(t){if(null==t)return{};var e={};return v(t,function(t,n){e[t]=n}),e}function _(t){return new Promise(t)}function b(t){return Promise.resolve(t)}function w(t){return null!=t}function E(t){return void 0!==t}function T(t){return"function"==typeof t}function I(t){return"object"==typeof t}function C(t){return I(t)&&null!==t}function S(t){return"string"==typeof t||t instanceof String}function N(t){return A()&&t instanceof Blob}function A(){return"undefined"!=typeof Blob}function R(t){var e;try{e=JSON.parse(t)}catch(t){return null}return function(t){return I(t)&&!Array.isArray(t)}(e)?e:null}function O(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function P(t){return at+ut+t}function D(t){return at+ct+t}function k(t){var e=encodeURIComponent,n="?";return v(t,function(t,r){var i=e(t)+"="+e(r);n=n+i+"&"}),n=n.slice(0,-1)}function M(){if(St)return St;var t=[];t.push(new Ct("bucket")),t.push(new Ct("generation")),t.push(new Ct("metageneration")),t.push(new Ct("name","fullPath",!0));var e=new Ct("name");e.xform=function(t,e){return function(t){return!S(t)||t.length<2?t:(t=t,O(t))}(e)},t.push(e);var n=new Ct("size");return n.xform=function(t,e){return w(e)?+e:e},t.push(n),t.push(new Ct("timeCreated")),t.push(new Ct("updated")),t.push(new Ct("md5Hash",null,!0)),t.push(new Ct("cacheControl",null,!0)),t.push(new Ct("contentDisposition",null,!0)),t.push(new Ct("contentEncoding",null,!0)),t.push(new Ct("contentLanguage",null,!0)),t.push(new Ct("contentType",null,!0)),t.push(new Ct("metadata","customMetadata",!0)),t.push(new Ct("downloadTokens","downloadURLs",!1,function(t,e){if(!(S(e)&&e.length>0))return[];var n=encodeURIComponent;return e.split(",").map(function(e){var r=t.bucket,i=t.fullPath;return function(t){return st+ut+t}("/b/"+n(r)+"/o/"+n(i))+k({alt:"media",token:e})})})),St=t}function L(t,e,n){var r={};r.type="file";for(var i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new It(n,r);return e.makeStorageReference(i)}})}(r,t),r}function x(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function F(t){if(!(t&&I(t)))throw"Expected Metadata object.";for(var e in t){var n=t[e];if("customMetadata"===e){if(!I(n))throw"Expected object for 'customMetadata' mapping."}else if(C(n))throw"Mapping for '"+e+"' cannot be an object."}}function U(t,e,n){for(var r=e.length,i=e.length,o=0;o<e.length;o++)if(e[o].optional){r=o;break}if(!(r<=n.length&&n.length<=i))throw function(t,e,n,r){var i,o;return t===e?(i=t,o=1===t?"argument":"arguments"):(i="between "+t+" and "+e,o="arguments"),new dt(yt.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+i+" "+o+", received "+r+".")}(r,i,t,n.length);for(o=0;o<n.length;o++)try{e[o].validator(n[o])}catch(e){throw e instanceof Error?s(o,t,e.message):s(o,t,e)}}function B(t,e){function n(t){if(!S(t))throw"Expected string."}var r;return r=t?function(t,e){return function(n){t(n),e(n)}}(n,t):n,new Nt(r,e)}function V(t){return new Nt(F,t)}function q(){return new Nt(function(t){if(!(function(t){return"number"==typeof t||t instanceof Number}(t)&&t>=0))throw"Expected a number 0 or greater."})}function j(t,e){return new Nt(function(e){if(!(null===e||w(e)&&e instanceof Object))throw"Expected an Object.";void 0!==t&&null!==t&&t(e)},e)}function W(t){return new Nt(function(t){if(null!==t&&!T(t))throw"Expected a Function."},t)}function K(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(A())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}function G(t,e){return-1!==t.indexOf(e)}function Q(t){if(!t)throw i()}function H(t,e){return function(n,r){var i=function(t,e,n){var r=R(e);return null===r?null:L(t,r,n)}(t,r,e);return Q(null!==i),i}}function z(t){return function(e,n){var r;return(r=401===e.getStatus()?new dt(yt.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?function(t){return new dt(yt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(t.bucket):403===e.getStatus()?function(t){return new dt(yt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}(t.path):n).setServerResponseProp(n.serverResponseProp()),r}}function X(t){var e=z(t);return function(n,r){var i=e(n,r);return 404===n.getStatus()&&(i=function(t){return new dt(yt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}(t.path)),i.setServerResponseProp(r.serverResponseProp()),i}}function Y(t,e,n){var r=P(e.fullServerUrl()),i=t.maxOperationRetryTime(),o=new Rt(r,"GET",H(t,n),i);return o.errorHandler=X(e),o}function J(t,e,n){var r=g(n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}function $(t,e){var n;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){Q(!1)}return Q(G(e||["active"],n)),n}function Z(t,e,n,r,i,o,s,u){var c=new Ot(0,0);if(s?(c.current=s.current,c.total=s.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw new dt(yt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var h=c.total-c.current,l=h;i>0&&(l=Math.min(l,i));var f=c.current,p=f+l,d={"X-Goog-Upload-Command":l===h?"upload, finalize":"upload","X-Goog-Upload-Offset":c.current},y=r.slice(f,p);if(null===y)throw a();var m=e.maxUploadRetryTime(),v=new Rt(n,"POST",function(t,n){var i,a=$(t,["active","final"]),s=c.current+l,u=r.size();return i="final"===a?H(e,o)(t,n):null,new Ot(s,u,"final"===a,i)},m);return v.headers=d,v.body=y.uploadData(),v.progressCallback=u||null,v.errorHandler=z(t),v}function tt(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];b(!0).then(function(){t.apply(null,e)})}}function et(t,e,n){var r=k(t.urlParams),i=t.url+r,o=g(t.headers);return function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(o,e),function(t){var e=void 0!==ot.default?ot.default.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}(o),new Ut(i,t.method,o,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,n)}function nt(t,e,n){return new Vt(t,new Tt,n)}function rt(t){var e={TaskState:wt,TaskEvent:_t,StringFormat:mt,Storage:Vt,Reference:Mt};t.INTERNAL.registerService(jt,nt,e,void 0,!0)}Object.defineProperty(e,"__esModule",{value:!0});var it,ot=n("qQjo"),at="https://firebasestorage.googleapis.com",st="https://firebasestorage.googleapis.com",ut="/v0",ct="/v0",ht="storageBucket",lt=12e4,ft=6e4,pt=-9007199254740991,dt=function(){function t(t,e){this.code_=r(t),this.message_="Firebase Storage: "+e,this.serverResponse_=null,this.name_="FirebaseError"}return t.prototype.codeProp=function(){return this.code},t.prototype.codeEquals=function(t){return r(t)===this.codeProp()},t.prototype.serverResponseProp=function(){return this.serverResponse_},t.prototype.setServerResponseProp=function(t){this.serverResponse_=t},Object.defineProperty(t.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),t}(),yt={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"},mt={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},vt=function(){return function(t,e){this.data=t,this.contentType=e||null}}(),gt=function(){return function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw c(mt.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=function(t,e){return!!(t.length>=e.length)&&t.substring(t.length-e.length)===e}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1)}}(),_t={STATE_CHANGED:"state_changed"},bt={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},wt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(it||(it={}));var Et=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=it.NO_ERROR,this.sendPromise_=_(function(e,n){t.xhr_.addEventListener("abort",function(n){t.errorCode_=it.ABORT,e(t)}),t.xhr_.addEventListener("error",function(n){t.errorCode_=it.NETWORK_ERROR,e(t)}),t.xhr_.addEventListener("load",function(n){e(t)})})}return t.prototype.send=function(t,e,n,r){var i=this;if(this.sent_)throw h("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),w(r)){v(r,function(t,e){i.xhr_.setRequestHeader(t,e.toString())})}return w(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw h("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw h("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw h("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){w(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){w(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}(),Tt=function(){function t(){}return t.prototype.createXhrIo=function(){return new Et},t}(),It=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(n){return new t(e,"")}if(""===n.path)return n;throw function(t){return new dt(yt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}(e)},t.makeFromUrl=function(e){for(var n=null,r=[{regex:new RegExp("^gs://([A-Za-z0-9.\\-]+)(/(.*))?$","i"),indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://firebasestorage\\.googleapis\\.com/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:function(t){t.path_=decodeURIComponent(t.path)}}],i=0;i<r.length;i++){var o=r[i],a=o.regex.exec(e);if(a){var s=a[o.indices.bucket],u=a[o.indices.path];u||(u=""),n=new t(s,u),o.postModify(n);break}}if(null==n)throw function(t){return new dt(yt.INVALID_URL,"Invalid URL '"+t+"'.")}(e);return n},t}(),Ct=function(){return function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||function(t,e){return e}}}(),St=null,Nt=function(){return function(t,e){var n=this;this.validator=function(e){n.optional&&!E(e)||t(e)},this.optional=!!e}}(),At=function(){function t(t,e){var n=0,r="";N(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(N(this.data_)){var r=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===r?null:new t(r)}return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(A()){var r=e.map(function(e){return e instanceof t?e.data_:e});return new t(K.apply(null,r))}var i=e.map(function(t){return S(t)?f(mt.RAW,t).data:t.data_}),o=0;i.forEach(function(t){o+=t.byteLength});var a=new Uint8Array(o),s=0;return i.forEach(function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]}),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}(),Rt=function(){return function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}(),Ot=function(){return function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null}}(),Pt=function(){return function(t,e,n){if(T(t)||w(e)||w(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}}}(),Dt=function(){function t(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o}return Object.defineProperty(t.prototype,"downloadURL",{get:function(){if(null!==this.metadata){var t=this.metadata.downloadURLs;return null!=t&&null!=t[0]?t[0]:null}return null},enumerable:!0,configurable:!0}),t}(),kt=function(){function t(t,e,n,r,i,o){void 0===o&&(o=null);var a=this;this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.authWrapper_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=bt.RUNNING,this.errorHandler_=function(t){a.request_=null,a.chunkMultiplier_=1,t.codeEquals(yt.CANCELED)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=t,a.transition_(bt.ERROR))},this.metadataErrorHandler_=function(t){a.request_=null,t.codeEquals(yt.CANCELED)?a.completeTransitions_():(a.error_=t,a.transition_(bt.ERROR))},this.promise_=_(function(t,e){a.resolve_=t,a.reject_=e,a.start_()}),this.promise_.then(null,function(){})}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n,r){t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return t.size()>262144},t.prototype.start_=function(){this.state_===bt.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.authWrapper_.getAuthToken().then(function(n){switch(e.state_){case bt.RUNNING:t(n);break;case bt.CANCELING:e.transition_(bt.CANCELED);break;case bt.PAUSING:e.transition_(bt.PAUSED)}})},t.prototype.createResumable_=function(){var t=this;this.resolveToken_(function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=J(e,r,i),s={name:a.fullPath},u=D(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},h=x(a,n),l=t.maxUploadRetryTime(),f=new Rt(u,"POST",function(t,e){$(t);var n;try{n=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){Q(!1)}return Q(S(n)),n},l);return f.urlParams=s,f.headers=c,f.body=h,f.errorHandler=z(e),f}(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()},t.errorHandler_)})},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_(function(n){var r=function(t,e,n,r){var i=t.maxUploadRetryTime(),o=new Rt(n,"POST",function(t,e){var n,i=$(t,["active","final"]);try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){Q(!1)}var o=parseInt(n,10);return Q(!isNaN(o)),new Ot(o,r.size(),"final"===i)},i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=z(e),o}(t.authWrapper_,t.location_,e,t.blob_),i=t.authWrapper_.makeRequest(r,n);t.request_=i,i.getPromise().then(function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()},t.errorHandler_)})},t.prototype.continueUpload_=function(){var t=this,e=262144*this.chunkMultiplier_,n=new Ot(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_(function(i){var o;try{o=Z(t.location_,t.authWrapper_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(e){return t.error_=e,void t.transition_(bt.ERROR)}var a=t.authWrapper_.makeRequest(o,i);t.request_=a,a.getPromise().then(function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_(bt.SUCCESS)):t.completeTransitions_()},t.errorHandler_)})},t.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_(function(e){var n=Y(t.authWrapper_,t.location_,t.mappings_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.transition_(bt.SUCCESS)},t.metadataErrorHandler_)})},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_(function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"},u=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();s["Content-Type"]="multipart/related; boundary="+u;var c=J(e,r,i),h="--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+x(c,n)+"\r\n--"+u+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",l="\r\n--"+u+"--",f=At.getBlob(h,r,l);if(null===f)throw a();var p={name:c.fullPath},d=D(o),y=t.maxUploadRetryTime(),m=new Rt(d,"POST",H(t,n),y);return m.urlParams=p,m.headers=s,m.body=f.uploadData(),m.errorHandler=z(e),m}(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_(bt.SUCCESS)},t.errorHandler_)})},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case bt.CANCELING:case bt.PAUSING:this.state_=t,null!==this.request_&&this.request_.cancel();break;case bt.RUNNING:var e=this.state_===bt.PAUSED;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case bt.PAUSED:this.state_=t,this.notifyObservers_();break;case bt.CANCELED:this.error_=o(),this.state_=t,this.notifyObservers_();break;case bt.ERROR:case bt.SUCCESS:this.state_=t,this.notifyObservers_()}},t.prototype.completeTransitions_=function(){switch(this.state_){case bt.PAUSING:this.transition_(bt.PAUSED);break;case bt.CANCELING:this.transition_(bt.CANCELED);break;case bt.RUNNING:this.start_()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=y(this.state_);return new Dt(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){function i(t){try{return void s(t)}catch(t){}try{u(t);if(!(E(t.next)||E(t.error)||E(t.complete)))throw"";return}catch(t){throw a}}function o(t){return function(e,n,i){null!==t&&U("on",t,arguments);var o=new Pt(e,n,r);return c.addObserver_(o),function(){c.removeObserver_(o)}}}void 0===e&&(e=void 0),void 0===n&&(n=void 0),void 0===r&&(r=void 0);var a="Expected a function or an Object with one of `next`, `error`, `complete` properties.",s=W(!0).validator,u=j(null,!0).validator;U("on",[B(function(e){if(t!==_t.STATE_CHANGED)throw"Expected one of the event types: ["+_t.STATE_CHANGED+"]."}),j(i,!0),W(!0),W(!0)],arguments);var c=this,h=[j(function(t){if(null===t)throw a;i(t)}),W(!0),W(!0)];return!(E(e)||E(n)||E(r))?o(h):o(null)(e,n,r)},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){!function(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}(this.observers_,t)},t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_();(function(t){return Array.prototype.slice.call(t)})(this.observers_).forEach(function(e){t.notifyObserver_(e)})},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(y(this.state_)){case wt.SUCCESS:tt(this.resolve_.bind(null,this.snapshot))();break;case wt.CANCELED:case wt.ERROR:tt(this.reject_.bind(null,this.error_))();break;default:t=!1}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){switch(y(this.state_)){case wt.RUNNING:case wt.PAUSED:null!==t.next&&tt(t.next.bind(t,this.snapshot))();break;case wt.SUCCESS:null!==t.complete&&tt(t.complete.bind(t))();break;case wt.CANCELED:case wt.ERROR:null!==t.error&&tt(t.error.bind(t,this.error_))();break;default:null!==t.error&&tt(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){U("resume",[],arguments);var t=this.state_===bt.PAUSED||this.state_===bt.PAUSING;return t&&this.transition_(bt.RUNNING),t},t.prototype.pause=function(){U("pause",[],arguments);var t=this.state_===bt.RUNNING;return t&&this.transition_(bt.PAUSING),t},t.prototype.cancel=function(){U("cancel",[],arguments);var t=this.state_===bt.RUNNING||this.state_===bt.PAUSING;return t&&this.transition_(bt.CANCELING),t},t}(),Mt=function(){function t(t,e){this.authWrapper=t,this.location=e instanceof It?e:It.makeFromUrl(e)}return t.prototype.toString=function(){return U("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return M()},t.prototype.child=function(t){U("child",[B()],arguments);var e=function(t,e){var n=e.split("/").filter(function(t){return t.length>0}).join("/");return 0===t.length?n:t+"/"+n}(this.location.path,t),n=new It(this.location.bucket,e);return this.newRef(this.authWrapper,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=function(t){if(0==t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this.location.path);if(null===t)return null;var e=new It(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new It(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return O(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),U("put",[new Nt(function(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||A()&&t instanceof Blob))throw"Expected Blob or File."}),V(!0)],arguments),this.throwIfRoot_("put"),new kt(this,this.authWrapper,this.location,this.mappings(),new At(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=mt.RAW),U("putString",[B(),B(l,!0),V(!0)],arguments),this.throwIfRoot_("putString");var r=f(e,t),i=g(n);return!w(i.contentType)&&w(r.contentType)&&(i.contentType=r.contentType),new kt(this,this.authWrapper,this.location,this.mappings(),new At(r.data,!0),i)},t.prototype.delete=function(){U("delete",[],arguments),this.throwIfRoot_("delete");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=function(t,e){var n=P(e.fullServerUrl()),r=t.maxOperationRetryTime(),i=new Rt(n,"DELETE",function(t,e){},r);return i.successCodes=[200,204],i.errorHandler=X(e),i}(t.authWrapper,t.location);return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.getMetadata=function(){U("getMetadata",[],arguments),this.throwIfRoot_("getMetadata");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=Y(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.updateMetadata=function(t){U("updateMetadata",[V()],arguments),this.throwIfRoot_("updateMetadata");var e=this;return this.authWrapper.getAuthToken().then(function(n){var r=function(t,e,n,r){var i=P(e.fullServerUrl()),o=x(n,r),a=t.maxOperationRetryTime(),s=new Rt(i,"PATCH",H(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=X(e),s}(e.authWrapper,e.location,t,e.mappings());return e.authWrapper.makeRequest(r,n).getPromise()})},t.prototype.getDownloadURL=function(){return U("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.getMetadata().then(function(t){var e=t.downloadURLs[0];if(w(e))return e;throw new dt(yt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")})},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw function(t){return new dt(yt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)},t}(),Lt=function(){function t(t){this.promise_=function(t){return Promise.reject(t)}(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){void 0===t&&(t=!1)},t}(),xt=function(){function t(){this.map_={},this.id_=pt}return t.prototype.addRequest=function(t){function e(){delete r.map_[n]}var n=this.id_;this.id_++,this.map_[n]=t;var r=this;t.getPromise().then(e,e)},t.prototype.clear=function(){v(this.map_,function(t,e){e&&e.cancel(!0)}),this.map_={}},t}(),Ft=function(){function t(e,n,r,i,o){if(this.bucket_=null,this.deleted_=!1,this.app_=e,null!==this.app_){var a=this.app_.options;w(a)&&(this.bucket_=t.extractBucket_(a))}this.storageRefMaker_=n,this.requestMaker_=r,this.pool_=o,this.service_=i,this.maxOperationRetryTime_=lt,this.maxUploadRetryTime_=ft,this.requestMap_=new xt}return t.extractBucket_=function(t){var e=t[ht]||null;if(null==e)return null;return It.makeFromBucketSpec(e).bucket},t.prototype.getAuthToken=function(){return null!==this.app_&&w(this.app_.INTERNAL)&&w(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then(function(t){return null!==t?t.accessToken:null},function(t){return null}):b(null)},t.prototype.bucket=function(){if(this.deleted_)throw u();return this.bucket_},t.prototype.service=function(){return this.service_},t.prototype.makeStorageReference=function(t){return this.storageRefMaker_(this,t)},t.prototype.makeRequest=function(t,e){if(this.deleted_)return new Lt(u());var n=this.requestMaker_(t,e,this.pool_);return this.requestMap_.addRequest(n),n},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},t.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},t.prototype.setMaxUploadRetryTime=function(t){this.maxUploadRetryTime_=t},t.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},t.prototype.setMaxOperationRetryTime=function(t){this.maxOperationRetryTime_=t},t}(),Ut=function(){function t(t,e,n,r,i,o,a,s,u,c,h){this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=h;var l=this;this.promise_=_(function(t,e){l.resolve_=t,l.reject_=e,l.start_()})}return t.prototype.start_=function(){function t(t,e){function r(t){var e=t.loaded,r=t.lengthComputable?t.total:-1;null!==n.progressCallback_&&n.progressCallback_(e,r)}if(e)t(!1,new Bt(!1,null,!0));else{var i=n.pool_.createXhrIo();n.pendingXhr_=i,null!==n.progressCallback_&&i.addUploadProgressListener(r),i.send(n.url_,n.method_,n.body_,n.headers_).then(function(e){null!==n.progressCallback_&&e.removeUploadProgressListener(r),n.pendingXhr_=null;var i=(e=e).getErrorCode()===it.NO_ERROR,o=e.getStatus();if(i&&!n.isRetryStatusCode_(o)){var a=G(n.successCodes_,o);t(!0,new Bt(a,e))}else{var s=e.getErrorCode()===it.ABORT;t(!1,new Bt(!1,null,s))}})}}function e(t,e){var r=n.resolve_,a=n.reject_,s=e.xhr;if(e.wasSuccessCode)try{var c=n.callback_(s,s.getResponseText());E(c)?r(c):r()}catch(t){a(t)}else if(null!==s){(h=i()).setServerResponseProp(s.getResponseText()),n.errorCallback_?a(n.errorCallback_(s,h)):a(h)}else if(e.canceled){a(h=n.appDelete_?u():o())}else{var h;a(h=new dt(yt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))}}var n=this;this.canceled_?e(0,new Bt(!1,null,!0)):this.backoffId_=function(t,e,n){function r(){return 2===l}function i(){f||(f=!0,e.apply(null,arguments))}function o(e){c=setTimeout(function(){c=null,t(a,r())},e)}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!f)if(t)i.apply(null,arguments);else if(r()||h)i.apply(null,arguments);else{u<64&&(u*=2);var a;1===l?(l=2,a=0):a=1e3*(u+Math.random()),o(a)}}function s(t){p||(p=!0,f||(null!==c?(t||(l=2),clearTimeout(c),o(0)):t||(l=1)))}var u=1,c=null,h=!1,l=0,f=!1,p=!1;return o(0),setTimeout(function(){h=!0,s(!0)},n),s}(t,e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=G([408,429],t),r=G(this.additionalRetryCodes_,t);return e||n||r},t}(),Bt=function(){return function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n}}(),Vt=function(){function t(t,e,n){if(this.bucket_=null,this.authWrapper_=new Ft(t,function(t,e){return new Mt(t,e)},et,this,e),this.app_=t,null!=n)this.bucket_=It.makeFromBucketSpec(n);else{var r=this.authWrapper_.bucket();null!=r&&(this.bucket_=new It(r,""))}this.internals_=new qt(this)}return t.prototype.ref=function(t){if(U("ref",[B(function(t){if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."},!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var e=new Mt(this.authWrapper_,this.bucket_);return null!=t?e.child(t):e},t.prototype.refFromURL=function(t){return U("refFromURL",[B(function(t){if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{It.makeFromUrl(t)}catch(t){throw"Expected valid full URL but got an invalid one."}},!1)],arguments),new Mt(this.authWrapper_,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){U("setMaxUploadRetryTime",[q()],arguments),this.authWrapper_.setMaxUploadRetryTime(t)},Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this.authWrapper_.maxOperationRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxOperationRetryTime=function(t){U("setMaxOperationRetryTime",[q()],arguments),this.authWrapper_.setMaxOperationRetryTime(t)},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),t}(),qt=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),b(void 0)},t}();e.registerStorage=rt;var jt="storage";rt(ot.default)},"ht/+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("mnK5"),o=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),i.contains(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return r.deepCopy(this.counters_)},t}();e.StatsCollection=o},i9Ll:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n("2/he"),o=n("NxJK"),a=n("Amoq"),s=n("4AKd"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?a.nameCompare(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return o.NamedNode.MIN},e.prototype.maxPost=function(){return o.NamedNode.MAX},e.prototype.makePost=function(t,e){var n=s.nodeFromJSON(t);return new o.NamedNode(e,n)},e.prototype.toString=function(){return".value"},e}(i.Index);e.ValueIndex=u,e.VALUE_INDEX=new u},iZj6:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),r.stringify(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:r.jsonEval(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}();e.DOMStorageWrapper=i},icUp:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("KbSj"),i=n("U1HK"),o=function(){function t(t,e){this.source=t,this.path=e,this.type=i.OperationType.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,r.Path.Empty):new t(this.source,this.path.popFront())},t}();e.ListenComplete=o},"j+dX":function(t,e,n){"use strict";function r(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:var n=e;return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var i in e)e.hasOwnProperty(i)&&(t[i]=r(t[i],e[i]));return t}Object.defineProperty(e,"__esModule",{value:!0}),e.deepCopy=function(t){return r(void 0,t)},e.deepExtend=r,e.patchProperty=function(t,e,n){t[e]=n}},joCY:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("Amoq"),o=n("1et+"),a=1e4,s=3e4,u=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new o.StatsListener(t);var n=a+(s-a)*Math.random();i.setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},o=!1;r.forEach(e,function(e,i){i>0&&r.contains(t.statsToReport_,e)&&(n[e]=i,o=!0)}),o&&this.server_.reportStats(n),i.setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}();e.StatsReporter=u},k6UL:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=function(){function t(t){this.allowedEvents_=t,this.listeners_={},r.assert(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=this.listeners_[t].slice(),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){r.assert(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},t}();e.EventEmitter=i},kawy:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("bEdf"),i=n("fIBc"),o=n("Amoq"),a=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[r.BrowserPollConnection,i.WebSocketConnection]},enumerable:!0,configurable:!0}),t.prototype.initTransports_=function(e){var n=i.WebSocketConnection&&i.WebSocketConnection.isAvailable(),r=n&&!i.WebSocketConnection.previouslyFailed();if(e.webSocketOnly&&(n||o.warn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[i.WebSocketConnection];else{var a=this.transports_=[];o.each(t.ALL_TRANSPORTS,function(t,e){e&&e.isAvailable()&&a.push(e)})}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}();e.TransportManager=a},lscU:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}();e.Change=r},m6le:function(t,e,n){"use strict";function r(){}Object.defineProperty(e,"__esModule",{value:!0}),e.createSubscribe=function(t,e){var n=new i(t,e);return n.subscribe.bind(n)};var i=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var i,o=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(i=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(i.next=r),void 0===i.error&&(i.error=r),void 0===i.complete&&(i.complete=r);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{o.finalError?i.error(o.finalError):i.complete()}catch(t){}}),this.observers.push(i),a},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){t.apply(void 0,n)}).catch(function(t){e&&e(t)})}}},mPFP:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+r.stringify(this.snapshot.exportVal())},t}();e.DataEvent=i;var o=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}();e.CancelEvent=o},maYl:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("3al8");e.stringToByteArray=function(t){for(var e=[],n=0,i=0;i<t.length;i++){var o=t.charCodeAt(i);if(o>=55296&&o<=56319){var a=o-55296;i++,r.assert(i<t.length,"Surrogate pair missing trail surrogate.");o=65536+(a<<10)+(t.charCodeAt(i)-56320)}o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):o<65536?(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128)}return e},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e}},mnK5:function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n("3al8")),r(n("7Oow")),r(n("MUsR")),r(n("j+dX")),r(n("rapL")),r(n("9BlA")),r(n("MB0S")),r(n("DUiD")),r(n("HW/i")),r(n("9fSs")),r(n("Fi7B")),r(n("SenR")),r(n("m6le")),r(n("L7k2")),r(n("maYl"))},n1Uv:function(t,e,n){"use strict";function r(){return It}function i(t){It=t}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(It<=wt.DEBUG){var i=(new Date).toISOString(),o=n.map(s);console.log.apply(console,["Firestore ("+Tt+") "+i+" ["+t+"]: "+e].concat(o))}}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(It<=wt.ERROR){var r=(new Date).toISOString(),i=e.map(s);console.error.apply(console,["Firestore ("+Tt+") "+r+": "+t].concat(i))}}function s(t){if("string"==typeof t)return t;var e=Ct.getPlatform();try{return e.formatJSON(t)}catch(e){return t}}function u(t){var e="FIRESTORE ("+Tt+") INTERNAL ASSERTION FAILED: "+t;throw a(e),new Error(e)}function c(t,e){t||u(e)}function h(){return Ct.getPlatform().emptyByteString}function l(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new At(Nt.INVALID_ARGUMENT,t)}n.prototype=t.prototype;for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function f(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function p(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=parseInt(n,10);isNaN(r)||e(r,t[n])}}function d(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function y(t){c(null!=t&&"object"==typeof t,"isEmpty() expects object parameter.");for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function m(t){c(t&&"object"==typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function v(t,e,n){if(e.length!==n)throw new At(Nt.INVALID_ARGUMENT,"Function "+t+"() requires "+P(n,"argument")+", but was called with "+P(e.length,"argument")+".")}function g(t,e,n){if(e.length<n)throw new At(Nt.INVALID_ARGUMENT,"Function "+t+"() requires at least "+P(n,"argument")+", but was called with "+P(e.length,"argument")+".")}function _(t,e,n,r){if(e.length<n||e.length>r)throw new At(Nt.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+P(e.length,"argument")+".")}function b(t,e,n,r){I(t,e,O(n)+" argument",r)}function w(t,e,n,r){void 0!==r&&b(t,e,n,r)}function E(t,e,n,r){I(t,e,n+" option",r)}function T(t,e,n,r){void 0!==r&&E(t,e,n,r)}function I(t,e,n,r){if(typeof r!==e||"object"===e&&!C(r)){var i=S(r);throw new At(Nt.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function C(t){return"object"==typeof t&&null!==t&&Object.getPrototypeOf(t)===Object.prototype}function S(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/,n=e.exec(t.constructor.toString());if(n&&n.length>1)return n[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":u("Unknown wrong type: "+typeof t)}function N(t,e,n){if(void 0===n)throw new At(Nt.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+O(e)+" argument, but it was undefined.")}function A(t,e,n){d(e,function(e,r){if(n.indexOf(e)<0)throw new At(Nt.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function R(t,e,n,r){var i=S(r);return new At(Nt.INVALID_ARGUMENT,"Function "+t+"() requires its "+O(n)+" argument to be a "+e+", but it was: "+i)}function O(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function P(t,e){return t+" "+e+(1===t?"":"s")}function D(t,e){return t<e?-1:t>e?1:0}function k(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}function M(){if("undefined"==typeof Uint8Array)throw new At(Nt.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function L(){if(!Ct.getPlatform().base64Available)throw new At(Nt.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function x(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}function F(t){return null===t||void 0===t}function U(t){switch(t){case Nt.OK:return u("Treated status OK as error");case Nt.CANCELLED:case Nt.UNKNOWN:case Nt.DEADLINE_EXCEEDED:case Nt.RESOURCE_EXHAUSTED:case Nt.INTERNAL:case Nt.UNAVAILABLE:case Nt.UNAUTHENTICATED:return!1;case Nt.INVALID_ARGUMENT:case Nt.NOT_FOUND:case Nt.ALREADY_EXISTS:case Nt.PERMISSION_DENIED:case Nt.FAILED_PRECONDITION:case Nt.ABORTED:case Nt.OUT_OF_RANGE:case Nt.UNIMPLEMENTED:case Nt.DATA_LOSS:return!0;default:return u("Unknown status code: "+t)}}function B(t){if(void 0===t)return a("GRPC error has no .code"),Nt.UNKNOWN;switch(t){case Le.OK:return Nt.OK;case Le.CANCELLED:return Nt.CANCELLED;case Le.UNKNOWN:return Nt.UNKNOWN;case Le.DEADLINE_EXCEEDED:return Nt.DEADLINE_EXCEEDED;case Le.RESOURCE_EXHAUSTED:return Nt.RESOURCE_EXHAUSTED;case Le.INTERNAL:return Nt.INTERNAL;case Le.UNAVAILABLE:return Nt.UNAVAILABLE;case Le.UNAUTHENTICATED:return Nt.UNAUTHENTICATED;case Le.INVALID_ARGUMENT:return Nt.INVALID_ARGUMENT;case Le.NOT_FOUND:return Nt.NOT_FOUND;case Le.ALREADY_EXISTS:return Nt.ALREADY_EXISTS;case Le.PERMISSION_DENIED:return Nt.PERMISSION_DENIED;case Le.FAILED_PRECONDITION:return Nt.FAILED_PRECONDITION;case Le.ABORTED:return Nt.ABORTED;case Le.OUT_OF_RANGE:return Nt.OUT_OF_RANGE;case Le.UNIMPLEMENTED:return Nt.UNIMPLEMENTED;case Le.DATA_LOSS:return Nt.DATA_LOSS;default:return u("Unknown status code: "+t)}}function V(){return Ge}function q(){return Qe}function j(){return He}function W(){return ze}function K(t,e){e.length>0&&(t.resumeToken=e)}function G(t,e){c(!F(t),e+" is missing")}function Q(t){return"number"==typeof t?t:"string"==typeof t?parseInt(t,10):u("can't parse "+t)}function H(t,e,n){return e===n||!e&&n in t}function z(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=X(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=Wn+Gn;break;case Wn:n+=Wn+Qn;break;default:n+=o}}return n}(t.get(n),e);return X(e)}function X(t){return t+Wn+Kn}function Y(t){var e=t.length;if(c(e>=2,"Invalid path "+t),2===e)return c(t.charAt(0)===Wn&&t.charAt(1)===Kn,"Non-empty path "+t+" had length 2"),Ut.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(Wn,o);(a<0||a>n)&&u('Invalid encoded resource path: "'+t+'"');switch(t.charAt(a+1)){case Kn:var s=t.substring(o,a),h=void 0;0===i.length?h=s:(h=i+=s,i=""),r.push(h);break;case Gn:i+=t.substring(o,a),i+="\0";break;case Qn:i+=t.substring(o,a+1);break;default:u('Invalid encoded resource path: "'+t+'"')}o=a+2}return new Ut(r)}function J(t,e){c(0===e,"Unexpected upgrade from version "+e),t.createObjectStore(Xn.store,{keyPath:Xn.keyPath}),t.createObjectStore(Yn.store,{keyPath:Yn.keyPath});t.createObjectStore(er.store,{keyPath:er.keyPath}).createIndex(er.documentTargetsIndex,er.documentTargetsKeyPath,{unique:!0});t.createObjectStore(tr.store,{keyPath:tr.keyPath}).createIndex(tr.queryTargetsIndexName,tr.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Jn.store),t.createObjectStore(Zn.store),t.createObjectStore(zn.store),t.createObjectStore(nr.store)}function $(t){return new Nn(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){n(t.target.error)}})}function Z(t){return c("string"==typeof t,"Persisting non-string stream token not supported."),t}function tt(t){return rt(t,Yn.store)}function et(t){return rt(t,Jn.store)}function nt(t){return rt(t,Xn.store)}function rt(t,e){return t instanceof sr?t.store(e):u("Invalid transaction object provided!")}function it(t){return st(t,tr.store)}function ot(t){return st(t,nr.store)}function at(t){return st(t,er.store)}function st(t,e){return t instanceof sr?t.store(e):u("Invalid transaction object provided!")}function ut(t){return t instanceof sr?t.store(Zn.store):u("Invalid transaction object provided!")}function ct(t){return t.path.toArray()}function ht(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t,["next","error","complete"])}function lt(t){switch(t){case Ar.Set:case Ar.MergeSet:case Ar.Update:return!0;case Ar.QueryValue:return!1;default:throw u("Unexpected case for UserDataSource: "+t)}}function ft(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Dt||t instanceof Ot||t instanceof ri||t instanceof Xr)}function pt(t,e,n){if(!ft(n)||!C(n)){var r=S(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function dt(t,e){if(e instanceof mn)return e._internalPath;if("string"==typeof e)return yt(t,e);throw new At(Nt.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function yt(t,e){try{return function(t){if(t.search(vn)>=0)throw new At(Nt.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(mn.bind.apply(mn,[void 0].concat(t.split("."))))}catch(e){throw new At(Nt.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e)._internalPath}catch(e){var n=mt(e);throw new At(Nt.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function mt(t){return t instanceof Error?t.message:t.toString()}function vt(t,e){return void 0===e?{merge:!1}:(A(t,e,["merge"]),T(t,"boolean","merge",e.merge),e)}function gt(t,e,n){if(e instanceof pi){if(e.firestore!==n)throw new At(Nt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw R(t,"DocumentReference",1,e)}function _t(t,e){if(e.oldDocs.isEmpty()){var n,r=0;return e.docChanges.map(function(i){var o=new di(t,i.doc.key,i.doc,e.fromCache);return c(i.type===gn.Added,"Invalid event type for first snapshot"),c(!n||e.query.docComparator(n,i.doc)<0,"Got added events in wrong order"),n=i.doc,{type:"added",doc:o,oldIndex:-1,newIndex:r++}})}var i=e.oldDocs;return e.docChanges.map(function(n){var r=new di(t,n.doc.key,n.doc,e.fromCache),o=-1,a=-1;return n.type!==gn.Added&&(c((o=i.indexOf(n.doc.key))>=0,"Index for document not found"),i=i.delete(n.doc.key)),n.type!==gn.Removed&&(a=(i=i.add(n.doc)).indexOf(n.doc.key)),{type:function(t){switch(t){case gn.Added:return"added";case gn.Modified:case gn.Metadata:return"modified";case gn.Removed:return"removed";default:return u("Unknown change type: "+t)}}(n.type),doc:r,oldIndex:o,newIndex:a}})}function bt(t){!function(t){t.INTERNAL.registerService("firestore",function(t){return new hi(t)},m(Si))}(t)}Object.defineProperty(e,"__esModule",{value:!0});var wt,Et=n("qQjo"),Tt=Et.default.SDK_VERSION;!function(t){t[t.DEBUG=0]="DEBUG",t[t.ERROR=1]="ERROR",t[t.SILENT=2]="SILENT"}(wt||(wt={}));var It=wt.ERROR,Ct=function(){function t(){}return t.setPlatform=function(e){t.platform&&u("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||u("Platform not set"),t.platform},t}(),St=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},At=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return St(e,t),e}(Error),Rt=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return c(20===e.length,"Invalid auto ID: "+e),e},t}(),Ot=function(){function t(t){L(),this._binaryString=t}return t.fromBase64String=function(e){v("Blob.fromBase64String",arguments,1),b("Blob.fromBase64String","string",1,e),L();try{return new t(Ct.getPlatform().atob(e))}catch(t){throw new At(Nt.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},t.fromUint8Array=function(e){if(v("Blob.fromUint8Array",arguments,1),M(),!(e instanceof Uint8Array))throw R("Blob.fromUint8Array","Uint8Array",1,e);return new t(Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join(""))},t.prototype.toBase64=function(){return v("Blob.toBase64",arguments,0),L(),Ct.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){v("Blob.toUint8Array",arguments,0),M();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype._equals=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return D(this._binaryString,t._binaryString)},t}(),Pt=l(Ot,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Dt=function(){function t(t,e){if(v("GeoPoint",arguments,2),b("GeoPoint","number",1,t),b("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new At(Nt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new At(Nt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype._equals=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return D(this._lat,t._lat)||D(this._long,t._long)},t}(),kt=function(){return function(t,e,n,r){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r}}(),Mt="(default)",Lt=function(){function t(t,e){this.projectId=t,this.database=e||Mt}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===Mt},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return D(this.projectId,t.projectId)||D(this.database,t.database)},t}(),xt=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ft=function(){function t(t,e,n){this.init(t,e,n)}return t.prototype.init=function(t,e,n){void 0===e?e=0:e>t.length&&u("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&u("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n},t.prototype.construct=function(t,e,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(t,e,n),r},Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):"string"==typeof e?n.push(e):u("Unknown parameter type for Path.child(): "+e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,c(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return c(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return c(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return c(!this.isEmpty(),"Can't call lastSegment() on empty path"),this.segments[this.limit()-1]},t.prototype.get=function(t){return c(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return xt(e,t),e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new At(Nt.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return t.length>0}))},e.EMPTY_PATH=new e([]),e}(Ft),Bt=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return xt(e,t),e.isValidIdentifier=function(t){return Bt.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new At(Nt.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new At(Nt.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new At(Nt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new At(Nt.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(Ft),qt=function(){function t(e){this.path=e,c(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.equals=function(t){return null!==t&&0===Ut.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return Ut.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new Ut(e.slice()))},t.fromPathString=function(e){return new t(Ut.fromString(e))},t.EMPTY=new t(new Ut([])),t}(),jt=function(){function t(t,e,n,r){this.key=t,this.version=e,this.data=n,this.hasLocalMutations=r.hasLocalMutations}return t.prototype.field=function(t){return this.data.field(t)},t.prototype.fieldValue=function(t){var e=this.field(t);return e?e.value():void 0},t.prototype.value=function(){return this.data.value()},t.prototype.equals=function(e){return e instanceof t&&this.key.equals(e.key)&&this.version.equals(e.version)&&this.data.equals(e.data)&&this.hasLocalMutations===e.hasLocalMutations},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"})"},t.compareByKey=function(t,e){return qt.comparator(t.key,e.key)},t.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return void 0!==r&&void 0!==i?r.compareTo(i):u("Trying to compare documents on fields that don't exist")},t}(),Wt=function(){function t(t,e){this.key=t,this.version=e}return t.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},t.prototype.equals=function(t){return t&&t.version.equals(this.version)&&t.key.equals(this.key)},t.compareByKey=function(t,e){return qt.comparator(t.key,e.key)},t}(),Kt=function(){function t(t,e){this.comparator=t,this.root=e||Qt.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Qt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qt.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e=this.root,n=null;!e.isEmpty();){var r=this.comparator(t,e.key);if(0===r){if(e.left.isEmpty())return n?n.key:null;for(e=e.left;!e.right.isEmpty();)e=e.right;return e.key}r<0?e=e.left:r>0&&(n=e,e=e.right)}throw u("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Gt(this.root,null,this.comparator,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Gt(this.root,t,this.comparator,!1,e)},t.prototype.getReverseIterator=function(t){return new Gt(this.root,null,this.comparator,!0,t)},t.prototype.getReverseIteratorFrom=function(t,e){return new Gt(this.root,t,this.comparator,!0,e)},t}(),Gt=function(){function t(t,e,n,r,i){this.resultGenerator=i||null,this.isReverse=r,this.nodeStack=[];for(var o=1;!t.isEmpty();)if(o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(0===o){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){c(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t,e=this.nodeStack.pop();if(t=this.resultGenerator?this.resultGenerator(e.key,e.value):{key:e.key,value:e.value},this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return this.resultGenerator?this.resultGenerator(t.key,t.value):{key:t.key,value:t.value}},t}(),Qt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw u("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw u("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw u("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),Ht=function(){function t(){this.size=0}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Qt(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();Qt.EMPTY=new Ht;var zt,Xt=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){t[t.NullValue=0]="NullValue",t[t.BooleanValue=1]="BooleanValue",t[t.NumberValue=2]="NumberValue",t[t.TimestampValue=3]="TimestampValue",t[t.StringValue=4]="StringValue",t[t.BlobValue=5]="BlobValue",t[t.RefValue=6]="RefValue",t[t.GeoPointValue=7]="GeoPointValue",t[t.ArrayValue=8]="ArrayValue",t[t.ObjectValue=9]="ObjectValue"}(zt||(zt={}));var Yt,Jt=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){c(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type.");return D(this.typeOrder,t.typeOrder)},t}(),$t=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=zt.NullValue,e.internalValue=null,e}return Xt(e,t),e.prototype.value=function(){return null},e.prototype.equals=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(Jt),Zt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=zt.BooleanValue,n}return Xt(e,t),e.prototype.value=function(){return this.internalValue},e.prototype.equals=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?D(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(Jt),te=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=zt.NumberValue,n}return Xt(e,t),e.prototype.value=function(){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?function(t,e){return t<e?-1:t>e?1:t===e?0:isNaN(t)?isNaN(e)?0:-1:1}(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Jt),ee=function(t){function e(e){return t.call(this,e)||this}return Xt(e,t),e.prototype.equals=function(t){return t instanceof e&&x(this.internalValue,t.internalValue)},e}(te),ne=function(t){function e(e){var n=t.call(this,e)||this;return n.internalValue=e,n}return Xt(e,t),e.prototype.equals=function(t){return t instanceof e&&x(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(te),re=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=zt.StringValue,n}return Xt(e,t),e.prototype.value=function(){return this.internalValue},e.prototype.equals=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?D(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Jt),ie=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=zt.TimestampValue,n}return Xt(e,t),e.prototype.value=function(){return this.internalValue.toDate()},e.prototype.equals=function(t){return t instanceof e&&this.internalValue.equals(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue.compareTo(t.internalValue):t instanceof oe?-1:this.defaultCompareTo(t)},e}(Jt),oe=function(t){function e(e){var n=t.call(this)||this;return n.localWriteTime=e,n.typeOrder=zt.TimestampValue,n}return Xt(e,t),e.prototype.value=function(){return null},e.prototype.equals=function(t){return t instanceof e&&this.localWriteTime.equals(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime.compareTo(t.localWriteTime):t instanceof ie?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(Jt),ae=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=zt.BlobValue,n}return Xt(e,t),e.prototype.value=function(){return this.internalValue},e.prototype.equals=function(t){return t instanceof e&&this.internalValue._equals(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Jt),se=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=zt.RefValue,r}return Xt(e,t),e.prototype.value=function(){return this.key},e.prototype.equals=function(t){return t instanceof e&&(this.key.equals(t.key)&&this.databaseId.equals(t.databaseId))},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:qt.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(Jt),ue=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=zt.GeoPointValue,n}return Xt(e,t),e.prototype.value=function(){return this.internalValue},e.prototype.equals=function(t){return t instanceof e&&this.internalValue._equals(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Jt),ce=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=zt.ObjectValue,n}return Xt(e,t),e.prototype.value=function(){var t={};return this.internalValue.inorderTraversal(function(e,n){t[e]=n.value()}),t},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.equals=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.equals(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=D(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return D(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(c(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(c(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return void 0!==this.field(t)},e.prototype.field=function(t){c(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach(function(t){n=n instanceof e?n.internalValue.get(t)||void 0:void 0}),n},e.prototype.toString=function(){return JSON.stringify(this.value())},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new Kt(D)),e}(Jt),he=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=zt.ArrayValue,n}return Xt(e,t),e.prototype.value=function(){return this.internalValue.map(function(t){return t.value()})},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.equals=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].equals(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return D(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return JSON.stringify(this.value())},e}(Jt),le=Number,fe=le.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),pe=le.MAX_SAFE_INTEGER||Math.pow(2,53)-1,de=le.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},ye=function(){function t(t,e,n,r,i,o){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.path=t,this.explicitOrderBy=e,this.filters=n,this.limit=r,this.startAt=i,this.endAt=o,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[Te]:this.memoizedOrderBy=[new Ee(t),Te];else{c(null===t||null!==e&&t.equals(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:be.ASCENDING;this.memoizedOrderBy.push(a===be.ASCENDING?Te:Ie)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){c(null==this.getInequalityFilterField()||!(e instanceof ve)||!e.isInequality()||e.field.equals(this.getInequalityFilterField()),"Query must only have one inequality field."),c(!qt.isDocumentKey(this.path),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){c(!qt.isDocumentKey(this.path),"No ordering allowed for document query"),c(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.withLimit=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();t+="|f:";for(var e=0,n=this.filters;e<n.length;e++){t+=n[e].canonicalId(),t+=","}t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++){t+=i[r].canonicalId(),t+=","}F(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t="Query("+this.path.canonicalString();return this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),F(this.limit)||(t+=", limit: "+this.limit),this.explicitOrderBy.length>0&&(t+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),t+")"},t.prototype.equals=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].equals(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].equals(t.filters[e]))return!1;return!!this.path.equals(t.path)&&(!(null!==this.startAt?!this.startAt.equals(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.equals(t.endAt):null===t.endAt))},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return c(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesAncestor(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimit=function(){return!F(this.limit)},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof ve&&n.isInequality())return n.field}return null},t.prototype.isDocumentQuery=function(){return qt.isDocumentKey(this.path)&&0===this.filters.length},t.prototype.matchesAncestor=function(t){var e=t.key.path;return qt.isDocumentKey(this.path)?this.path.equals(e):this.path.isPrefixOf(e)&&this.path.length===e.length-1},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&void 0===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++){if(!n[e].matches(t))return!1}return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t))&&(!this.endAt||!this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){c(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),me=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;default:return u("Unknown relation: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.equals=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t}(),ve=function(){function t(t,e,n){this.field=t,this.op=e,this.value=n}return t.prototype.matches=function(t){if(this.field.isKeyField()){c(this.value instanceof se,"Comparing on key, but filter value not a RefValue");var e=this.value,n=qt.comparator(t.key,e.key);return this.matchesComparison(n)}var r=t.field(this.field);return void 0!==r&&this.matchesValue(r)},t.prototype.matchesValue=function(t){return this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},t.prototype.matchesComparison=function(t){switch(this.op){case me.LESS_THAN:return t<0;case me.LESS_THAN_OR_EQUAL:return t<=0;case me.EQUAL:return 0===t;case me.GREATER_THAN:return t>0;case me.GREATER_THAN_OR_EQUAL:return t>=0;default:return u("Unknown relation op"+this.op)}},t.prototype.isInequality=function(){return this.op!==me.EQUAL},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},t.prototype.equals=function(e){return e instanceof t&&(this.op.equals(e.op)&&this.field.equals(e.field)&&this.value.equals(e.value))},t.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},t}(),ge=function(){function t(t){this.field=t}return t.prototype.matches=function(t){var e=t.field(this.field);return void 0!==e&&null===e.value()},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS null"},t.prototype.toString=function(){return this.field.canonicalString()+" IS null"},t.prototype.equals=function(e){return e instanceof t&&this.field.equals(e.field)},t}(),_e=function(){function t(t){this.field=t}return t.prototype.matches=function(t){var e=t.field(this.field).value();return"number"==typeof e&&isNaN(e)},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.toString=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.equals=function(e){return e instanceof t&&this.field.equals(e.field)},t}(),be=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),we=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++){t+=n[e].toString()}return t},t.prototype.sortsBeforeDocument=function(t,e){c(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())c(o instanceof se,"Bound has a non-key value where the key path is being used."),n=qt.comparator(o.key,e.key);else{var a=e.field(i.field);c(void 0!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===be.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.equals=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];return n.equals(r)}return!0},t}(),Ee=function(){function t(t,e){this.field=t,void 0===e&&(e=be.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?jt.compareByKey(t,e):jt.compareByField(this.field,t,e);switch(this.dir){case be.ASCENDING:return n;case be.DESCENDING:return-1*n;default:return u("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.equals=function(t){return this.dir===t.dir&&this.field.equals(t.field)},t}(),Te=new Ee(Vt.keyField(),be.ASCENDING),Ie=new Ee(Vt.keyField(),be.DESCENDING),Ce=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/),Se=function(){function t(t,e){this.seconds=t,this.nanos=e,c(e>=0,"timestamp nanoseconds out of range: "+e),c(e<1e9,"timestamp nanoseconds out of range"+e),c(t>=-62135596800,"timestamp seconds out of range: "+t),c(t<253402300800,"timestamp seconds out of range"+t)}return t.now=function(){return t.fromEpochMilliseconds(Date.now())},t.fromDate=function(e){return t.fromEpochMilliseconds(e.getTime())},t.fromEpochMilliseconds=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.fromISOString=function(e){var n=0,r=Ce.exec(e);if(c(!!r,"invalid timestamp: "+e),r[1]){var i=r[1];i=(i+"000000000").substr(0,9),n=parseInt(i,10)}var o=new Date(e);return new t(Math.floor(o.getTime()/1e3),n)},t.prototype.toDate=function(){return new Date(this.toEpochMilliseconds())},t.prototype.toEpochMilliseconds=function(){return 1e3*this.seconds+this.nanos/1e6},t.prototype.compareTo=function(t){return this.seconds===t.seconds?D(this.nanos,t.nanos):D(this.seconds,t.seconds)},t.prototype.equals=function(t){return t.seconds===this.seconds&&t.nanos===this.nanos},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanos="+this.nanos+")"},t}(),Ne=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new Se(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp.compareTo(t.timestamp)},t.prototype.equals=function(t){return this.timestamp.equals(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanos/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new Se(0,0)),t}();!function(t){t[t.Listen=0]="Listen",t[t.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",t[t.LimboResolution=2]="LimboResolution"}(Yt||(Yt={}));var Ae,Re=function(){function t(t,e,n,r,i){void 0===r&&(r=Ne.MIN),void 0===i&&(i=h()),this.query=t,this.targetId=e,this.purpose=n,this.snapshotVersion=r,this.resumeToken=i}return t.prototype.update=function(e){return new t(this.query,this.targetId,this.purpose,e.snapshotVersion,e.resumeToken)},t.prototype.equals=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.snapshotVersion.equals(t.snapshotVersion)&&this.resumeToken===t.resumeToken&&this.query.equals(t.query)},t}(),Oe=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pe=function(){function t(t){this.fields=t}return t.prototype.equals=function(t){return k(this.fields,t.fields)},t}(),De=function(){function t(){}return t.prototype.equals=function(e){return e instanceof t},t.instance=new t,t}(),ke=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.equals=function(t){return this.field.equals(t.field)&&this.transform.equals(t.transform)},t}(),Me=function(){return function(t,e){this.version=t,this.transformResults=e}}();!function(t){t[t.Set=0]="Set",t[t.Patch=1]="Patch",t[t.Transform=2]="Transform",t[t.Delete=3]="Delete"}(Ae||(Ae={}));var Le,xe=function(){function t(t,e){this.updateTime=t,this.exists=e,c(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof jt&&t.version.equals(this.updateTime):void 0!==this.exists?this.exists?t instanceof jt:null===t||t instanceof Wt:(c(this.isNone,"Precondition should be empty"),!0)},t.prototype.equals=function(t){return function(t,e){return null!==t&&void 0!==t?!(!e||!t.equals(e)):t===e}(this.updateTime,t.updateTime)&&this.exists===t.exists},t.NONE=new t,t}(),Fe=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&c(t.key.equals(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof jt?t.version:Ne.MIN},t}(),Ue=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=Ae.Set,i}return Oe(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by SetMutation.");var n=Fe.getPostMutationVersion(t);return new jt(this.key,n,this.value,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var n=Fe.getPostMutationVersion(t);return new jt(this.key,n,this.value,{hasLocalMutations:!0})},e.prototype.equals=function(t){return t instanceof e&&this.key.equals(t.key)&&this.value.equals(t.value)&&this.precondition.equals(t.precondition)},e}(Fe),Be=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=Ae.Patch,o}return Oe(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return t;var n=Fe.getPostMutationVersion(t),r=this.patchDocument(t);return new jt(this.key,n,r,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var n=Fe.getPostMutationVersion(t),r=this.patchDocument(t);return new jt(this.key,n,r,{hasLocalMutations:!0})},e.prototype.equals=function(t){return t instanceof e&&this.key.equals(t.key)&&this.fieldMask.equals(t.fieldMask)&&this.precondition.equals(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof jt?t.data:ce.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){for(var e=0,n=this.fieldMask.fields;e<n.length;e++){var r=n[e],i=this.data.field(r);t=void 0!==i?t.set(r,i):t.delete(r)}return t},e}(Fe),Ve=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=Ae.Transform,r.precondition=xe.exists(!0),r}return Oe(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),c(null!=e.transformResults,"Transform results missing for TransformMutation.");var n=e.transformResults;if(!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.transformObject(r.data,n);return new jt(this.key,r.version,i,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var n=this.requireDocument(t),r=this.localTransformResults(e),i=this.transformObject(n.data,r);return new jt(this.key,n.version,i,{hasLocalMutations:!0})},e.prototype.equals=function(t){return t instanceof e&&this.key.equals(t.key)&&k(this.fieldTransforms,t.fieldTransforms)&&this.precondition.equals(t.precondition)},e.prototype.requireDocument=function(t){c(t instanceof jt,"Unknown MaybeDocument type "+t);var e=t;return c(e.key.equals(this.key),"Can only transform a document with the same key"),e},e.prototype.localTransformResults=function(t){for(var e=[],n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n].transform;if(!(i instanceof De))return u("Encountered unknown transform: "+i);e.push(new oe(t))}return e},e.prototype.transformObject=function(t,e){c(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n],i=r.transform,o=r.field;if(!(i instanceof De))return u("Encountered unknown transform: "+i);t=t.set(o,e[n])}return t},e}(Fe),qe=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=Ae.Delete,r}return Oe(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by DeleteMutation."),new Wt(this.key,Ne.MIN)},e.prototype.applyToLocalView=function(t,e){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&c(t.key.equals(this.key),"Can only apply mutation to document with same key"),new Wt(this.key,Ne.forDeletedDoc())):t},e.prototype.equals=function(t){return t instanceof e&&this.key.equals(t.key)&&this.precondition.equals(t.precondition)},e}(Fe),je=function(){function t(t){this.count=t}return t.prototype.equals=function(t){return t&&t.count===this.count},t}();!function(t){t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS"}(Le||(Le={}));var We,Ke=function(){function t(t){this.comparator=t,this.data=new Kt(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();){if(!t(n.getNext().key))return}},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.equals=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Ge=new Kt(qt.comparator),Qe=new Kt(qt.comparator),He=new Kt(qt.comparator),ze=new Ke(qt.comparator),Xe=function(){function t(t,e,n){this.snapshotVersion=t,this.targetChanges=e,this.documentUpdates=n}return t.prototype.addDocumentUpdate=function(t){this.documentUpdates=this.documentUpdates.insert(t.key,t)},t.prototype.handleExistenceFilterMismatch=function(t){this.targetChanges[t]={mapping:new $e,snapshotVersion:Ne.MIN,currentStatusUpdate:We.MarkNotCurrent,resumeToken:h()}},t}();!function(t){t[t.None=0]="None",t[t.MarkNotCurrent=1]="MarkNotCurrent",t[t.MarkCurrent=2]="MarkCurrent"}(We||(We={}));var Ye,Je=W(),$e=function(){function t(){this.docs=Je}return Object.defineProperty(t.prototype,"documents",{get:function(){return this.docs},enumerable:!0,configurable:!0}),t.prototype.add=function(t){this.docs=this.docs.add(t)},t.prototype.delete=function(t){this.docs=this.docs.delete(t)},t.prototype.equals=function(t){return null!==t&&this.docs.equals(t.docs)},t}(),Ze=function(){function t(){this.addedDocuments=Je,this.removedDocuments=Je}return t.prototype.applyToKeySet=function(t){var e=t;return this.addedDocuments.forEach(function(t){return e=e.add(t)}),this.removedDocuments.forEach(function(t){return e=e.delete(t)}),e},t.prototype.add=function(t){this.addedDocuments=this.addedDocuments.add(t),this.removedDocuments=this.removedDocuments.delete(t)},t.prototype.delete=function(t){this.addedDocuments=this.addedDocuments.delete(t),this.removedDocuments=this.removedDocuments.add(t)},t.prototype.equals=function(t){return null!==t&&this.addedDocuments.equals(t.addedDocuments)&&this.removedDocuments.equals(t.removedDocuments)},t}(),tn=function(){return function(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r}}(),en=function(){return function(t,e){this.targetId=t,this.existenceFilter=e}}();!function(t){t[t.NoChange=0]="NoChange",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Current=3]="Current",t[t.Reset=4]="Reset"}(Ye||(Ye={}));var nn=function(){return function(t,e,n,r){void 0===n&&(n=h()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}(),rn=function(){function t(t,e,n){this.snapshotVersion=t,this.listenTargets=e,this.existenceFilters={},this.targetChanges={},this.documentUpdates=V(),this.frozen=!1,this.pendingTargetResponses=m(n)}return t.prototype.add=function(t){c(!this.frozen,"Trying to modify frozen WatchChangeAggregator."),t instanceof tn?this.addDocumentChange(t):t instanceof nn?this.addTargetChange(t):t instanceof en?this.addExistenceFilterChange(t):u("Unknown watch change: "+t)},t.prototype.addChanges=function(t){var e=this;c(!this.frozen,"Trying to modify frozen WatchChangeAggregator."),t.forEach(function(t){return e.add(t)})},t.prototype.createRemoteEvent=function(){var t=this,e=this.targetChanges;return p(this.targetChanges,function(n){t.isActiveTarget(n)||delete e[n]}),this.frozen=!0,new Xe(this.snapshotVersion,e,this.documentUpdates)},t.prototype.ensureTargetChange=function(t){var e=this.targetChanges[t];return e||(e={currentStatusUpdate:We.None,snapshotVersion:this.snapshotVersion,mapping:new Ze,resumeToken:h()},this.targetChanges[t]=e),e},t.prototype.isActiveTarget=function(t){return!f(this.pendingTargetResponses,t)&&f(this.listenTargets,t)},t.prototype.addDocumentChange=function(t){for(var e=!1,n=0,r=t.updatedTargetIds;n<r.length;n++){var i=r[n];if(this.isActiveTarget(i)){this.ensureTargetChange(i).mapping.add(t.key),e=!0}}for(var o=0,a=t.removedTargetIds;o<a.length;o++){i=a[o];if(this.isActiveTarget(i)){this.ensureTargetChange(i).mapping.delete(t.key),e=!0}}t.newDoc&&e&&(this.documentUpdates=this.documentUpdates.insert(t.key,t.newDoc))},t.prototype.addTargetChange=function(t){var e=this;t.targetIds.forEach(function(n){var r=e.ensureTargetChange(n);switch(t.state){case Ye.NoChange:e.isActiveTarget(n)&&K(r,t.resumeToken);break;case Ye.Added:e.recordTargetResponse(n),f(e.pendingTargetResponses,n)||(r.mapping=new Ze,r.currentStatusUpdate=We.None,delete e.existenceFilters[n]),K(r,t.resumeToken);break;case Ye.Removed:e.recordTargetResponse(n),c(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case Ye.Current:e.isActiveTarget(n)&&(r.currentStatusUpdate=We.MarkCurrent,K(r,t.resumeToken));break;case Ye.Reset:e.isActiveTarget(n)&&(r.mapping=new $e,K(r,t.resumeToken));break;default:u("Unknown target watch change state: "+t.state)}})},t.prototype.recordTargetResponse=function(t){var e=(this.pendingTargetResponses[t]||0)-1;0===e?delete this.pendingTargetResponses[t]:this.pendingTargetResponses[t]=e},t.prototype.addExistenceFilterChange=function(t){this.isActiveTarget(t.targetId)&&(this.existenceFilters[t.targetId]=t.existenceFilter)},t}(),on=function(){var t={};return t[be.ASCENDING.name]="ASCENDING",t[be.DESCENDING.name]="DESCENDING",t}(),an=function(){var t={};return t[me.LESS_THAN.name]="LESS_THAN",t[me.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",t[me.GREATER_THAN.name]="GREATER_THAN",t[me.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",t[me.EQUAL.name]="EQUAL",t}(),sn=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?Nt.UNKNOWN:B(t.code);return new At(e,t.message||"")},t.prototype.toInt32Value=function(t){return F(t)?void 0:{value:t}},t.prototype.fromInt32Value=function(t){var e;return e="object"==typeof t?t.value:t,F(e)?null:e},t.prototype.toTimestamp=function(t){return{seconds:t.seconds,nanos:t.nanos}},t.prototype.fromTimestamp=function(t){if("string"==typeof t)return Se.fromISOString(t);c(!!t,"Cannot deserialize null or undefined timestamp.");var e=Q(t.seconds||"0"),n=t.nanos||0;return new Se(e,n)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"==typeof t?(c(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),Ot.fromBase64String(t)):(c(!this.options.useProto3Json,"Expected bytes to be passed in as string, but got something else instead."),Ot.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return c(!!t,"Trying to deserialize version that isn't set"),Ne.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=Ut.fromString(t);return c(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return c(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),c(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new qt(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return 0===t.length?this.encodedDatabaseId:this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?Ut.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new Ut(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new Ut(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return c(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof $t)return{nullValue:"NULL_VALUE"};if(t instanceof Zt)return{booleanValue:t.value()};if(t instanceof ee)return{integerValue:""+t.value()};if(t instanceof ne){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof re?{stringValue:t.value()}:t instanceof ce?{mapValue:this.toMapValue(t)}:t instanceof he?{arrayValue:this.toArrayValue(t)}:t instanceof ie?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof ue?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof ae?{bytesValue:this.toBytes(t.value())}:t instanceof se?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:u("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this,n=t.value_type;if(H(t,n,"nullValue"))return $t.INSTANCE;if(H(t,n,"booleanValue"))return Zt.of(t.booleanValue);if(H(t,n,"integerValue"))return new ee(Q(t.integerValue));if(H(t,n,"doubleValue")){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return ne.NAN;if("Infinity"===t.doubleValue)return ne.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return ne.NEGATIVE_INFINITY}return new ne(t.doubleValue)}if(H(t,n,"stringValue"))return new re(t.stringValue);if(H(t,n,"mapValue"))return this.fromFields(t.mapValue.fields||{});if(H(t,n,"arrayValue")){G(t.arrayValue,"arrayValue");var r=t.arrayValue.values||[];return new he(r.map(function(t){return e.fromValue(t)}))}if(H(t,n,"timestampValue"))return G(t.timestampValue,"timestampValue"),new ie(this.fromTimestamp(t.timestampValue));if(H(t,n,"geoPointValue")){G(t.geoPointValue,"geoPointValue");var i=t.geoPointValue.latitude||0,o=t.geoPointValue.longitude||0;return new ue(new Dt(i,o))}if(H(t,n,"bytesValue")){G(t.bytesValue,"bytesValue");var a=this.fromBlob(t.bytesValue);return new ae(a)}if(H(t,n,"referenceValue")){G(t.referenceValue,"referenceValue");var s=this.fromResourceName(t.referenceValue),c=new Lt(s.get(1),s.get(3)),h=new qt(this.extractLocalPathFromResourceName(s));return new se(c,h)}return u("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return c(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t){return new jt(this.fromName(t.name),this.fromVersion(t.updateTime),this.fromFields(t.fields||{}),{hasLocalMutations:!1})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=t,r=ce.EMPTY;return d(n,function(t,n){r=r.set(new Vt([t]),e.fromValue(n))}),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){c(!!t.found,"Tried to deserialize a found document from a missing document."),G(t.found.name,"doc.found.name"),G(t.found.updateTime,"doc.found.updateTime");var e=this.fromName(t.found.name),n=this.fromVersion(t.found.updateTime),r=this.fromFields(t.found.fields||{});return new jt(e,n,r,{hasLocalMutations:!1})},t.prototype.fromMissing=function(t){c(!!t.missing,"Tried to deserialize a missing document from a found document."),c(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new Wt(e,n)},t.prototype.fromMaybeDocument=function(t){var e=t.result;return H(t,e,"found")?this.fromFound(t):H(t,e,"missing")?this.fromMissing(t):u("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case Ye.Added:return"ADD";case Ye.Current:return"CURRENT";case Ye.NoChange:return"NO_CHANGE";case Ye.Removed:return"REMOVE";case Ye.Reset:return"RESET";default:return u("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof en)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof tn){if(t.newDoc instanceof jt){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof Wt){e=t.newDoc;return{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof nn){var n=void 0;return t.cause&&(n={code:function(t){if(void 0===t)return Le.OK;switch(t){case Nt.OK:return Le.OK;case Nt.CANCELLED:return Le.CANCELLED;case Nt.UNKNOWN:return Le.UNKNOWN;case Nt.DEADLINE_EXCEEDED:return Le.DEADLINE_EXCEEDED;case Nt.RESOURCE_EXHAUSTED:return Le.RESOURCE_EXHAUSTED;case Nt.INTERNAL:return Le.INTERNAL;case Nt.UNAVAILABLE:return Le.UNAVAILABLE;case Nt.UNAUTHENTICATED:return Le.UNAUTHENTICATED;case Nt.INVALID_ARGUMENT:return Le.INVALID_ARGUMENT;case Nt.NOT_FOUND:return Le.NOT_FOUND;case Nt.ALREADY_EXISTS:return Le.ALREADY_EXISTS;case Nt.PERMISSION_DENIED:return Le.PERMISSION_DENIED;case Nt.FAILED_PRECONDITION:return Le.FAILED_PRECONDITION;case Nt.ABORTED:return Le.ABORTED;case Nt.OUT_OF_RANGE:return Le.OUT_OF_RANGE;case Nt.UNIMPLEMENTED:return Le.UNIMPLEMENTED;case Nt.DATA_LOSS:return Le.DATA_LOSS;default:return u("Unknown status code: "+t)}}(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return u("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e,n=t.response_type;if(H(t,n,"targetChange")){G(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),a=t.targetChange.cause,s=a&&this.fromRpcStatus(a);e=new nn(r,i,o,s||null)}else if(H(t,n,"documentChange")){G(t.documentChange,"documentChange"),G(t.documentChange.document,"documentChange.name"),G(t.documentChange.document.name,"documentChange.document.name"),G(t.documentChange.document.updateTime,"documentChange.document.updateTime");var c=t.documentChange,h=this.fromName(c.document.name),l=this.fromVersion(c.document.updateTime),f=this.fromFields(c.document.fields||{}),p=new jt(h,l,f,{hasLocalMutations:!1}),d=c.targetIds||[],y=c.removedTargetIds||[];e=new tn(d,y,p.key,p)}else if(H(t,n,"documentDelete")){G(t.documentDelete,"documentDelete"),G(t.documentDelete.document,"documentDelete.document");var m=t.documentDelete;h=this.fromName(m.document),l=m.readTime?this.fromVersion(m.readTime):Ne.forDeletedDoc(),p=new Wt(h,l),y=m.removedTargetIds||[];e=new tn([],y,p.key,p)}else if(H(t,n,"documentRemove")){G(t.documentRemove,"documentRemove"),G(t.documentRemove.document,"documentRemove");var v=t.documentRemove;h=this.fromName(v.document),y=v.removedTargetIds||[];e=new tn([],y,h,null)}else{if(!H(t,n,"filter"))return u("Unknown change type "+JSON.stringify(t));G(t.filter,"filter"),G(t.filter.targetId,"filter.targetId");var g=t.filter,_=g.count||0,b=new je(_),w=g.targetId;e=new en(w,b)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?Ye.NoChange:"ADD"===t?Ye.Added:"REMOVE"===t?Ye.Removed:"CURRENT"===t?Ye.Current:"RESET"===t?Ye.Reset:u("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!H(t,t.response_type,"targetChange"))return Ne.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?Ne.MIN:e.readTime?this.fromVersion(e.readTime):Ne.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof Ue)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof qe)e={delete:this.toName(t.key)};else if(t instanceof Be)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof Ve))return u("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):xe.NONE;if(t.update){G(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new Be(r,i,o,n)}return new Ue(r,i,n)}if(t.delete){r=this.fromName(t.delete);return new qe(r,n)}if(t.transform){r=this.fromName(t.transform.document);var a=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return c(!0===n.exists,'Transforms only support precondition "exists == true"'),new Ve(r,a)}return u("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return c(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:u("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?xe.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?xe.exists(t.exists):xe.NONE},t.prototype.fromWriteResult=function(t){var e=this,n=t.updateTime?this.fromVersion(t.updateTime):null,r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults.map(function(t){return e.fromValue(t)})),new Me(n,r)},t.prototype.fromWriteResults=function(t){var e=this;return(t||[]).map(function(t){return e.fromWriteResult(t)})},t.prototype.toFieldTransform=function(t){return c(t.transform instanceof De,"Unknown transform: "+t.transform),{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"}},t.prototype.fromFieldTransform=function(t){c("REQUEST_TIME"===t.setToServerValue,"Unknown transform proto: "+JSON.stringify(t));var e=Vt.fromServerFormat(t.fieldPath);return new ke(e,De.instance)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;c(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return ye.atPath(this.fromQueryPath(n))},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}};if(t.path.isEmpty())e.parent=this.toQueryPath(Ut.EMPTY_PATH);else{var n=t.path;c(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]}var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return void 0!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0;if(r>0){c(1===r,"StructuredQuery.from with more than one collection is not supported.");var i=n.from[0];e=e.child(i.collectionId)}var o=[];n.where&&(o=this.fromFilter(n.where));var a=[];n.orderBy&&(a=this.fromOrder(n.orderBy));var s=null;n.limit&&(s=this.fromInt32Value(n.limit));var u=null;n.startAt&&(u=this.fromCursor(n.startAt));var h=null;return n.endAt&&(h=this.fromCursor(n.endAt)),new ye(e,a,o,s,u,h)},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case Yt.Listen:return null;case Yt.ExistenceFilterMismatch:return"existence-filter-mismatch";case Yt.LimboResolution:return"limbo-document";default:return u("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.query;return e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)},e.targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof ve?e.toRelationFilter(t):e.toUnaryFilter(t)});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromRelationFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):u("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new we(r,n)},t.prototype.toDirection=function(t){return on[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return be.ASCENDING;case"DESCENDING":return be.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return an[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return me.EQUAL;case"GREATER_THAN":return me.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return me.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return me.LESS_THAN;case"LESS_THAN_OR_EQUAL":return me.LESS_THAN_OR_EQUAL;case"OPERATOR_UNSPECIFIED":return u("Unspecified relation");default:return u("Unknown relation")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return Vt.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new Ee(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.toRelationFilter=function(t){return t instanceof ve?{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}:u("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromRelationFilter=function(t){return new ve(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryFilter=function(t){return t instanceof _e?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}}:t instanceof ge?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}:u("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return new _e(e);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return new ge(n);case"OPERATOR_UNSPECIFIED":return u("Unspecified filter");default:return u("Unknown filter")}},t.prototype.toDocumentMask=function(t){return{fieldPaths:t.fields.map(function(t){return t.canonicalString()})}},t.prototype.fromDocumentMask=function(t){var e=(t.fieldPaths||[]).map(function(t){return Vt.fromServerFormat(t)});return new Pe(e)},t}(),un=n("IIoC"),cn=function(){function t(t){this.wrappedOnOpen=null,this.wrappedOnClose=null,this.wrappedOnMessage=null,this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){c(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){c(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){c(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){c(null!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){c(null!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){c(null!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),hn="Connection",ln={BatchGetDocuments:"batchGet",Commit:"commit"},fn="gl-js/ fire/"+Tt,pn=function(){function t(t){this.databaseId=t.databaseId,this.pool=new un.XhrIoPool;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=fn,t["google-cloud-resource-prefix"]="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(a,s){r.pool.getObject(function(c){c.listenOnce(un.EventType.COMPLETE,function(){try{switch(c.getLastErrorCode()){case un.ErrorCode.NO_ERROR:var e=c.getResponseJson();o(hn,"XHR received:",JSON.stringify(e)),a(e);break;case un.ErrorCode.TIMEOUT:o(hn,'RPC "'+t+'" timed out'),s(new At(Nt.DEADLINE_EXCEEDED,"Request time out"));break;case un.ErrorCode.HTTP_ERROR:var n=c.getStatus();o(hn,'RPC "'+t+'" failed with status:',n,"response text:",c.getResponseText()),n>0?s(new At(function(t){switch(t){case 200:return Nt.OK;case 400:return Nt.INVALID_ARGUMENT;case 401:return Nt.UNAUTHENTICATED;case 403:return Nt.PERMISSION_DENIED;case 404:return Nt.NOT_FOUND;case 409:return Nt.ABORTED;case 416:return Nt.OUT_OF_RANGE;case 429:return Nt.RESOURCE_EXHAUSTED;case 499:return Nt.CANCELLED;case 500:return Nt.UNKNOWN;case 501:return Nt.UNIMPLEMENTED;case 503:return Nt.UNAVAILABLE;case 504:return Nt.DEADLINE_EXCEEDED;default:return t>=200&&t<300?Nt.OK:t>=400&&t<500?Nt.FAILED_PRECONDITION:t>=500&&t<600?Nt.INTERNAL:Nt.UNKNOWN}}(n),"Server responded with status "+c.getStatusText())):(o(hn,'RPC "'+t+'" failed'),s(new At(Nt.UNAVAILABLE,"Connection failed.")));break;default:u('RPC "'+t+'" failed with unanticipated webchannel error '+c.getLastErrorCode()+": "+c.getLastError()+", giving up.")}}finally{o(hn,'RPC "'+t+'" completed.'),r.pool.releaseObject(c)}});var h=JSON.stringify(e);o(hn,"XHR sending: ",i+" "+h);var l={"Content-Type":"text/plain"};r.modifyHeadersForRequest(l,n),c.send(i,"POST",h,l,15)})})},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1beta1.Firestore","/",t,"/channel"],r=Object(un.createWebChannelTransport)(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},httpHeadersOverwriteParam:"$httpHeaders",sendRawJson:!0,supportsCrossDomainXhr:!0};this.modifyHeadersForRequest(i.initMessageHeaders,e);var a=n.join("");o(hn,"Creating WebChannel: "+a+" "+i);var s=r.createWebChannel(a,i),u=!1,h=!1,l=new cn({sendFn:function(t){h?o(hn,"Not sending because WebChannel is closed:",t):(u||(o(hn,"Opening WebChannel transport."),s.open(),u=!0),o(hn,"WebChannel sending:",t),s.send(t))},closeFn:function(){return s.close()}}),f=function(t,e){s.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(un.WebChannel.EventType.OPEN,function(){h||o(hn,"WebChannel transport opened.")}),f(un.WebChannel.EventType.CLOSE,function(){h||(h=!0,o(hn,"WebChannel transport closed"),l.callOnClose())}),f(un.WebChannel.EventType.ERROR,function(t){h||(h=!0,o(hn,"WebChannel transport errored:",t),l.callOnClose(new At(Nt.UNAVAILABLE,"The operation could not be completed")))}),f(un.WebChannel.EventType.MESSAGE,function(t){if(!h){var e=t.data[0];c(!!e,"Got a webchannel message without data.");var n=e.error||e[0]&&e[0].error;if(n){o(hn,"WebChannel received error:",n);var r=n.status,i=function(t){var e=Le[t];if(void 0!==e)return B(e)}(r),a=n.message;void 0===i&&(i=Nt.INTERNAL,a="Unknown error status: "+r+" with message "+n.message),h=!0,l.callOnClose(new At(i,a)),s.close()}else o(hn,"WebChannel received:",e),l.callOnMessage(e)}}),setTimeout(function(){l.callOnOpen()},0),l},t.prototype.makeUrl=function(t){var e=ln[t];c(void 0!==e,"Unknown REST mapping for: "+t);var n=[this.baseUrl,"/","v1beta1"];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(e),n.join("")},t}(),dn=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return t.prototype.loadConnection=function(t){return Promise.resolve(new pn(t))},t.prototype.newSerializer=function(t){return new sn(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();Ct.setPlatform(new dn);var yn,mn=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new At(Nt.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+P(r,"element")+".")}("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(b("FieldPath","string",n,t[n]),0===t[n].length)throw new At(Nt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vt(t)}return t.documentId=function(){return t._DOCUMENT_ID},t._DOCUMENT_ID=new t(Vt.keyField().canonicalString()),t}(),vn=new RegExp("[~\\*/\\[\\]]");!function(t){t[t.Unknown=0]="Unknown",t[t.Healthy=1]="Healthy",t[t.Failed=2]="Failed"}(yn||(yn={}));var gn;!function(t){t[t.Added=0]="Added",t[t.Removed=1]="Removed",t[t.Modified=2]="Modified",t[t.Metadata=3]="Metadata"}(gn||(gn={}));var _n;!function(t){t[t.Local=0]="Local",t[t.Synced=1]="Synced"}(_n||(_n={}));var bn,wn=function(){function t(){this.changeMap=new Kt(qt.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==gn.Added&&n.type===gn.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===gn.Metadata&&n.type!==gn.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===gn.Modified&&n.type===gn.Modified?this.changeMap=this.changeMap.insert(e,{type:gn.Modified,doc:t.doc}):t.type===gn.Modified&&n.type===gn.Added?this.changeMap=this.changeMap.insert(e,{type:gn.Added,doc:t.doc}):t.type===gn.Removed&&n.type===gn.Added?this.changeMap=this.changeMap.remove(e):t.type===gn.Removed&&n.type===gn.Modified?this.changeMap=this.changeMap.insert(e,{type:gn.Removed,doc:n.doc}):t.type===gn.Added&&n.type===gn.Removed?this.changeMap=this.changeMap.insert(e,{type:gn.Modified,doc:t.doc}):u("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),En=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||qt.comparator(e.key,n.key)}:function(t,e){return qt.comparator(t.key,e.key)},this.keyedMap=q(),this.sortedSet=new Kt(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.prevDoc=function(t){c(this.has(t),"Trying to get a previous document to non-existing key: "+t);var e=this.keyedMap.get(t);return this.sortedSet.getPredecessorKey(e)},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.equals=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.equals(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Tn=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.equals(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].equals(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].equals(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){d(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}})},t.prototype.isEmpty=function(){return y(this.inner)},t}(),In=function(){return function(){this.listeners=[]}}(),Cn=function(){function t(t){this.syncEngine=t,this.queries=new Tn(function(t){return t.canonicalId()}),this.onlineState=yn.Unknown,this.syncEngine.subscribe(this.onChange.bind(this),this.onError.bind(this))}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new In,this.queries.set(e,r)),r.listeners.push(t),t.onOnlineStateChanged(this.onlineState),r.viewSnap&&t.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){var e=t.query,n=!1,r=this.queries.get(e);if(r){var i=r.listeners.indexOf(t);i>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length)}return n?(this.queries.delete(e),this.syncEngine.unlisten(e)):Promise.resolve()},t.prototype.onChange=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],i=r.query,o=this.queries.get(i);if(o){for(var a=0,s=o.listeners;a<s.length;a++){s[a].onViewSnapshot(r)}o.viewSnap=r}}},t.prototype.onError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){i[r].onError(e)}this.queries.delete(t)},t.prototype.onOnlineStateChanged=function(t){this.onlineState=t,this.queries.forEach(function(e,n){for(var r=0,i=n.listeners;r<i.length;r++){i[r].onOnlineStateChanged(t)}})},t}(),Sn=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.onlineState=yn.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(c(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeDocumentMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==gn.Metadata&&e.push(i)}t={query:t.query,docs:t.docs,oldDocs:t.oldDocs,docChanges:e,fromCache:t.fromCache,hasPendingWrites:t.hasPendingWrites,syncStateChanged:t.syncStateChanged}}this.raisedInitialEvent?this.shouldRaiseEvent(t)&&this.queryObserver.next(t):this.shouldRaiseInitialEvent(t,this.onlineState)&&this.raiseInitialEvent(t),this.snap=t},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.onOnlineStateChanged=function(t){this.onlineState=t,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(t,e){if(c(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==yn.Failed;return this.options.waitForSyncWhenOnline&&n?(c(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===yn.Failed},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeQueryMetadataChanges},t.prototype.raiseInitialEvent=function(e){c(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e={query:e.query,docs:e.docs,oldDocs:En.emptySet(e.docs),docChanges:t.getInitialViewChanges(e),fromCache:e.fromCache,hasPendingWrites:e.hasPendingWrites,syncStateChanged:!0},this.raisedInitialEvent=!0,this.queryObserver.next(e)},t.getInitialViewChanges=function(t){var e=[];return t.docs.forEach(function(t){e.push({type:gn.Added,doc:t})}),e},t}(),Nn=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=null,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&u("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return e.reduce(function(t,e,n){return t.next(function(){return e})},t.resolve())},t.map=function(e){var n=[],r=!0,i=t.resolve(null);return e.reduce(function(t,e){return t.next(function(t){return r||n.push(t),r=!1,e})},i).next(function(t){return n.push(t),n})},t}(),An=function(){function t(){this.isEager=!0,this.sources=[],this.potentialGarbage=W()}return t.prototype.addGarbageSource=function(t){this.sources.push(t),t.setGarbageCollector(this)},t.prototype.removeGarbageSource=function(t){this.sources.splice(this.sources.indexOf(t),1),t.setGarbageCollector(null)},t.prototype.addPotentialGarbageKey=function(t){this.potentialGarbage=this.potentialGarbage.add(t)},t.prototype.collectGarbage=function(t){var e=this,n=[],r=W();return this.potentialGarbage.forEach(function(i){var o=e.documentHasAnyReferences(t,i);n.push(o.next(function(t){return t||(r=r.add(i)),Nn.resolve()}))}),this.potentialGarbage=W(),Nn.waitFor(n).next(function(){return r})},t.prototype.documentHasAnyReferences=function(t,e){var n=Nn.resolve(!1);return this.sources.map(function(n){return function(){return n.containsKey(t,e)}}).reduce(function(t,e){return t.next(function(t){return t?Nn.resolve(!0):e()})},n)},t}(),Rn=function(){function t(t,e,n){this.query=t,this.addedKeys=e,this.removedKeys=n}return t.fromSnapshot=function(e){for(var n=W(),r=W(),i=0,o=e.docChanges;i<o.length;i++){var a=o[i];switch(a.type){case gn.Added:n=n.add(a.doc.key);break;case gn.Removed:r=r.add(a.doc.key)}}return new t(e.query,n,r)},t}(),On=function(){function t(){this.refsByKey=new Ke(Pn.compareByKey),this.refsByTarget=new Ke(Pn.compareByTargetId),this.garbageCollector=null}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new Pn(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new Pn(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=qt.EMPTY,r=new Pn(n,t),i=new Pn(n,t+1);this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t)})},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t),null!==this.garbageCollector&&this.garbageCollector.addPotentialGarbageKey(t.key)},t.prototype.referencesForId=function(t){var e=qt.EMPTY,n=new Pn(e,t),r=new Pn(e,t+1),i=W();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=new Pn(e,0),r=this.refsByKey.firstAfterOrEqual(n);return Nn.resolve(null!==r&&e.equals(r.key))},t}(),Pn=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return qt.comparator(t.key,e.key)||D(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return D(t.targetOrBatchId,e.targetOrBatchId)||qt.comparator(t.key,e.key)},t}(),Dn=1;!function(t){t[t.LocalStore=0]="LocalStore",t[t.SyncEngine=1]="SyncEngine"}(bn||(bn={}));var kn,Mn=function(){function t(t,e){void 0===e&&(e=0),this.generatorId=t;var n=e>>Dn<<Dn,r=e-n;this.previousId=r>=t?n|this.generatorId:(n|this.generatorId)-(1<<Dn)}return t.prototype.next=function(){return this.previousId+=1<<Dn,this.previousId},t.forLocalStore=function(e){return void 0===e&&(e=0),new t(bn.LocalStore,e)},t.forSyncEngine=function(){return new t(bn.SyncEngine)},t}(),Ln=function(){return function(t){this.key=t}}(),xn=function(){return function(t){this.key=t}}(),Fn=function(){function t(t,e){this.query=t,this.syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=W(),this.mutatedKeys=W(),this.documentSet=new En(t.docComparator.bind(t))}return t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new wn,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=e instanceof jt?e:null;if(l&&(c(t.equals(l.key),"Mismatching keys found in document changes: "+t+" != "+l.key),l=n.query.matches(l)?l:null),l?(a=a.add(l),o=l.hasLocalMutations?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)),h&&l){var f=h.data.equals(l.data);f&&h.hasLocalMutations===l.hasLocalMutations||(f?r.track({type:gn.Metadata,doc:l}):r.track({type:gn.Modified,doc:l}),u&&n.query.docComparator(l,u)>0&&(s=!0))}else!h&&l?r.track({type:gn.Added,doc:l}):h&&!l&&(r.track({type:gn.Removed,doc:h}),u&&(s=!0))}),this.query.hasLimit())for(;a.size>this.query.limit;){var h=a.last();a=a.delete(h.key),r.track({type:gn.Removed,doc:h})}return c(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.applyChanges=function(t,e){var n=this;c(!t.needsRefill,"Cannot apply changes that need a refill");var r=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var i=t.changeSet.getChanges();i.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case gn.Added:return 1;case gn.Modified:case gn.Metadata:return 2;case gn.Removed:return 0;default:return u("Unknown ChangeType: "+t)}};return n(t)-n(e)}(t.type,e.type)||n.query.docComparator(t.doc,e.doc)});var o=this.applyTargetChange(e),a=0===this.limboDocuments.size&&this.current?_n.Synced:_n.Local,s=a!==this.syncState;return this.syncState=a,0!==i.length||s?{snapshot:{query:this.query,docs:t.documentSet,oldDocs:r,docChanges:i,fromCache:a===_n.Local,syncStateChanged:s,hasPendingWrites:!t.mutatedKeys.isEmpty()},limboChanges:o}:{limboChanges:o}},t.prototype.shouldBeInLimbo=function(t){return!this.syncedDocuments.has(t)&&(!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations)},t.prototype.applyTargetChange=function(t){var e=this;if(t){var n=t.mapping;switch(n instanceof $e?this.syncedDocuments=n.documents:n instanceof Ze&&(this.syncedDocuments=n.applyToKeySet(this.syncedDocuments)),t.currentStatusUpdate){case We.MarkCurrent:this.current=!0;break;case We.MarkNotCurrent:this.current=!1;break;case We.None:break;default:u("Unknown current status update: "+t.currentStatusUpdate)}}var r=this.limboDocuments;this.limboDocuments=W(),this.current&&this.documentSet.forEach(function(t){e.shouldBeInLimbo(t.key)&&(e.limboDocuments=e.limboDocuments.add(t.key))});var i=[];return r.forEach(function(t){e.limboDocuments.has(t)||i.push(new xn(t))}),this.limboDocuments.forEach(function(t){r.has(t)||i.push(new Ln(t))}),i},t}(),Un=function(){return function(t,e,n,r){this.query=t,this.targetId=e,this.resumeToken=n,this.view=r}}(),Bn=function(){function t(t,e,n){this.localStore=t,this.remoteStore=e,this.currentUser=n,this.viewHandler=null,this.errorHandler=null,this.queryViewsByQuery=new Tn(function(t){return t.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new Kt(qt.comparator),this.limboKeysByTarget={},this.limboDocumentRefs=new On,this.limboCollector=new An,this.mutationUserCallbacks={},this.targetIdGenerator=Mn.forSyncEngine()}return t.prototype.subscribe=function(t,e){c(null!==t&&null!==e,"View and error handlers cannot be null"),c(null===this.viewHandler&&null===this.errorHandler,"SyncEngine already has a subscriber."),this.viewHandler=t,this.errorHandler=e,this.limboCollector.addGarbageSource(this.limboDocumentRefs)},t.prototype.listen=function(t){var e=this;return this.assertSubscribed("listen()"),c(!this.queryViewsByQuery.has(t),"We already listen to the query: "+t),this.localStore.allocateQuery(t).then(function(n){return e.localStore.executeQuery(t).then(function(r){return e.localStore.remoteDocumentKeys(n.targetId).then(function(i){var o=new Fn(t,i),a=o.computeDocChanges(r),s=o.applyChanges(a);c(0===s.limboChanges.length,"View returned limbo docs before target ack from the server."),c(!!s.snapshot,"applyChanges for new view should always return a snapshot");var u=new Un(t,n.targetId,n.resumeToken,o);e.queryViewsByQuery.set(t,u),e.queryViewsByTarget[n.targetId]=u,e.viewHandler([s.snapshot]),e.remoteStore.listen(n)})}).then(function(){return n.targetId})})},t.prototype.unlisten=function(t){var e=this;this.assertSubscribed("unlisten()");var n=this.queryViewsByQuery.get(t);return c(!!n,"Trying to unlisten on query not found:"+t),this.localStore.releaseQuery(t).then(function(){return e.remoteStore.unlisten(n.targetId),e.removeAndCleanupQuery(n).then(function(){return e.localStore.collectGarbage()})})},t.prototype.write=function(t,e){var n=this;return this.assertSubscribed("write()"),this.localStore.localWrite(t).then(function(t){return n.addMutationCallback(t.batchId,e),n.emitNewSnapsAndNotifyLocalStore(t.changes)}).then(function(){return n.remoteStore.fillWritePipeline()})},t.prototype.wrapUpdateFunctionError=function(t){return t},t.prototype.runTransaction=function(t,e){var n=this;void 0===e&&(e=5),c(e>=0,"Got negative number of retries for transaction.");var r=this.remoteStore.createTransaction();return function(){try{var e=t(r);return!F(e)&&e.catch&&e.then?e.catch(function(t){return Promise.reject(n.wrapUpdateFunctionError(t))}):Promise.reject(Error("Transaction callback must return a Promise"))}catch(t){return Promise.reject(n.wrapUpdateFunctionError(t))}}().then(function(i){return r.commit().then(function(){return i}).catch(function(r){return 0===e?Promise.reject(r):n.runTransaction(t,e-1)})})},t.prototype.applyRemoteEvent=function(t){var e=this;return this.assertSubscribed("applyRemoteEvent()"),p(t.targetChanges,function(n,r){var i=e.limboKeysByTarget[n];i&&r.currentStatusUpdate===We.MarkCurrent&&!t.documentUpdates.get(i)&&t.addDocumentUpdate(new Wt(i,t.snapshotVersion))}),this.localStore.applyRemoteEvent(t).then(function(n){return e.emitNewSnapsAndNotifyLocalStore(n,t)})},t.prototype.rejectListen=function(t,e){var n=this;this.assertSubscribed("rejectListens()");var r=this.limboKeysByTarget[t];if(r){this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboKeysByTarget[t];var i=new Kt(qt.comparator);i=i.insert(r,new Wt(r,Ne.forDeletedDoc()));var o=new Xe(Ne.MIN,{},i);return this.applyRemoteEvent(o)}var a=this.queryViewsByTarget[t];return c(!!a,"Unknown targetId: "+t),this.localStore.releaseQuery(a.query).then(function(){return n.removeAndCleanupQuery(a).then(function(){n.errorHandler(a.query,e)})})},t.prototype.applySuccessfulWrite=function(t){var e=this;return this.assertSubscribed("applySuccessfulWrite()"),this.processUserCallback(t.batch.batchId,null),this.localStore.acknowledgeBatch(t).then(function(t){return e.emitNewSnapsAndNotifyLocalStore(t)})},t.prototype.rejectFailedWrite=function(t,e){var n=this;return this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.localStore.rejectBatch(t).then(function(t){return n.emitNewSnapsAndNotifyLocalStore(t)})},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new Kt(D)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(c(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupQuery=function(t){return this.queryViewsByQuery.delete(t.query),delete this.queryViewsByTarget[t.targetId],this.limboDocumentRefs.removeReferencesForId(t.targetId),this.gcLimboDocuments()},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Ln?(this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i)):i instanceof xn?(o("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t)):u("Unknown limbo change: "+JSON.stringify(i))}return this.gcLimboDocuments()},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){o("SyncEngine","New document in limbo: "+e);var n=this.targetIdGenerator.next(),r=ye.atPath(e.path);this.limboKeysByTarget[n]=e,this.remoteStore.listen(new Re(r,n,Yt.Listen)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.gcLimboDocuments=function(){var t=this;return this.limboCollector.collectGarbage(null).next(function(e){e.forEach(function(e){var n=t.limboTargetsByKey.get(e);null!==n&&(t.remoteStore.unlisten(n),t.limboTargetsByKey=t.limboTargetsByKey.remove(e),delete t.limboKeysByTarget[n])})}).toPromise()},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){var n=this,r=[],i=[],o=[];return this.queryViewsByQuery.forEach(function(a,s){o.push(Promise.resolve().then(function(){var e=s.view.computeDocChanges(t);return e.needsRefill?n.localStore.executeQuery(s.query).then(function(t){return s.view.computeDocChanges(t,e)}):e}).then(function(t){var o=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,o);return n.updateTrackedLimbos(s.targetId,a.limboChanges).then(function(){if(a.snapshot){r.push(a.snapshot);var t=Rn.fromSnapshot(a.snapshot);i.push(t)}})}))}),Promise.all(o).then(function(){return n.viewHandler(r),n.localStore.notifyLocalViewChanges(i)}).then(function(){return n.localStore.collectGarbage()})},t.prototype.assertSubscribed=function(t){c(null!==this.viewHandler&&null!==this.errorHandler,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleUserChange=function(t){var e=this;return this.currentUser=t,this.localStore.handleUserChange(t).then(function(t){return e.emitNewSnapsAndNotifyLocalStore(t)}).then(function(){return e.remoteStore.handleUserChange(t)})},t}(),Vn=-1,qn=function(){function t(t,e,n){this.batchId=t,this.localWriteTime=e,this.mutations=n}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&c(e.key.equals(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;c(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.equals(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&c(e.key.equals(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0;n<this.mutations.length;n++){var r=this.mutations[n];r.key.equals(t)&&(e=r.applyToLocalView(e,this.localWriteTime))}return e},t.prototype.keys=function(){for(var t=W(),e=0,n=this.mutations;e<n.length;e++){var r=n[e];t=t.add(r.key)}return t},t.prototype.equals=function(t){return this.batchId===t.batchId&&k(this.mutations,t.mutations)},t.prototype.isTombstone=function(){return 0===this.mutations.length},t.prototype.toTombstone=function(){return new t(this.batchId,this.localWriteTime,[])},t}(),jn=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){c(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=j(),a=e.mutations,s=0;s<a.length;s++){var u=r[s].version;null===u&&(u=n),o=o.insert(a[s].key,u)}return new t(e,n,r,i,o)},t}(),Wn="",Kn="",Gn="",Qn="",Hn=function(){return function(t,e){this.seconds=t,this.nanos=e}}(),zn=function(){function t(t,e){this.ownerId=t,this.leaseTimestampMs=e}return t.store="owner",t}(),Xn=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),Yn=function(){function t(t,e,n,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.mutations=r}return t.store="mutations",t.keyPath=["userId","batchId"],t}(),Jn=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,z(e)]},t.key=function(t,e,n){return[t,z(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}(),$n=function(){return function(t,e){this.path=t,this.readTime=e}}(),Zn=function(){function t(t,e){this.noDocument=t,this.document=e}return t.store="remoteDocuments",t}(),tr=function(){function t(t,e,n,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),er=function(){function t(t,e){this.targetId=t,this.path=e}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),nr=function(){function t(t,e,n){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),rr=[Xn.store,Yn.store,Jn.store,Zn.store,tr.store,zn.store,nr.store,er.store],ir="SimpleDb",or=function(){function t(t){this.db=t}return t.openOrCreate=function(e,n,r){return c(t.isAvailable(),"IndexedDB not supported in current environment."),o(ir,"Opening database:",e),new Nn(function(i,a){var s=window.indexedDB.open(e,n);s.onsuccess=function(e){var n=e.target.result;i(new t(n))},s.onerror=function(t){a(t.target.error)},s.onupgradeneeded=function(t){o(ir,'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;r(n,t.oldVersion)}}).toPromise()},t.delete=function(t){return o(ir,"Removing database:",t),$(window.indexedDB.deleteDatabase(t)).toPromise()},t.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;var t=window.navigator.userAgent;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0)},t.prototype.runTransaction=function(t,e,n){var r=new sr(this.db,t,e),i=n(r).catch(function(t){return r.abort(),Nn.reject(t)}).toPromise();return r.completionPromise.then(function(){return i})},t.prototype.close=function(){this.db.close()},t}(),ar=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return $(this.dbCursor.delete())},t}(),sr=function(){function t(t,e,n){var r=this;this.aborted=!1,this.transaction=t.transaction(n,e),this.completionPromise=new Promise(function(t,e){r.transaction.onabort=r.transaction.oncomplete=function(e){t()},r.transaction.onerror=function(t){e(t.target.error)}})}return t.prototype.abort=function(){this.aborted||(o(ir,"Aborting transaction."),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return c(!!e,"Object store not part of transaction: "+t),new ur(e)},t}(),ur=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(o(ir,"PUT",this.store.name,t,e),n=this.store.put(e,t)):(o(ir,"PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),$(n)},t.prototype.get=function(t){var e=this;return $(this.store.get(t)).next(function(n){return void 0===n&&(n=null),o(ir,"GET",e.store.name,t,n),n})},t.prototype.delete=function(t){o(ir,"DELETE",this.store.name,t);return $(this.store.delete(t))},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){o(ir,"DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateCursor=function(t,e){var n=[];return new Nn(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ar(i),a=e(i.primaryKey,i.value,o);a instanceof Nn&&n.push(a),o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}}).next(function(){return Nn.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(c(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}(),cr=function(){function t(t,e){this.userId=t,this.serializer=e,this.garbageCollector=null}return t.forUser=function(e,n){c(""!==e.uid,"UserID must not be an empty string.");return new t(e.isUnauthenticated()?"":e.uid,n)},t.prototype.start=function(e){var n=this;return t.loadNextBatchIdFromDb(e).next(function(t){return n.nextBatchId=t,nt(e).get(n.userId)}).next(function(t){return t||(t=new Xn(n.userId,Vn,"")),n.metadata=t,n.metadata.lastAcknowledgedBatchId>=n.nextBatchId?n.checkEmpty(e).next(function(t){return c(t,"Reset nextBatchID is only possible when the queue is empty"),n.metadata.lastAcknowledgedBatchId=Vn,nt(e).put(n.metadata)}):Nn.resolve()})},t.loadNextBatchIdFromDb=function(t){var e=Vn;return tt(t).iterate({reverse:!0},function(t,n,r){var i=t[0];if(t[1]>e&&(e=n.batchId),""===i)r.done();else{var o=function(t){var e=t.length-1;return 0===t.length?"":"\0"===t.charAt(e)?t.substring(0,e):t.substring(0,e)+String.fromCharCode(t.charCodeAt(e)-1)}(i);r.skip([o])}}).next(function(){return e+1})},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound(this.keyForBatchId(Number.NEGATIVE_INFINITY),this.keyForBatchId(Number.POSITIVE_INFINITY));return tt(t).iterate({range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.getNextBatchId=function(t){return Nn.resolve(this.nextBatchId)},t.prototype.getHighestAcknowledgedBatchId=function(t){return Nn.resolve(this.metadata.lastAcknowledgedBatchId)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId;return c(r>this.metadata.lastAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order"),this.metadata.lastAcknowledgedBatchId=r,this.metadata.lastStreamToken=Z(n),nt(t).put(this.metadata)},t.prototype.getLastStreamToken=function(t){return Nn.resolve(this.metadata.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.metadata.lastStreamToken=Z(e),nt(t).put(this.metadata)},t.prototype.addMutationBatch=function(t,e,n){var r=this,i=this.nextBatchId;this.nextBatchId++;var o=new qn(i,e,n),a=this.serializer.toDbMutationBatch(this.userId,o);return tt(t).put(a).next(function(){for(var e=0,o=n;e<o.length;e++){var a=o[e],s=(z(a.key.path),Jn.key(r.userId,a.key.path,i));et(t).put(s,Jn.PLACEHOLDER)}return Nn.waitFor([])}).next(function(){return o})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return tt(t).get(this.keyForBatchId(e)).next(function(t){return t?n.serializer.fromDbMutationBatch(t):null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=IDBKeyRange.lowerBound(this.keyForBatchId(e+1)),i=null;return tt(t).iterate({range:r},function(t,r,o){r.userId===n.userId&&(c(r.batchId>e,"Should have found mutation after "+e),i=n.serializer.fromDbMutationBatch(r)),o.done()}).next(function(){return i})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound(this.keyForBatchId(Vn),this.keyForBatchId(Number.POSITIVE_INFINITY));return tt(t).loadAll(n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesThroughBatchId=function(t,e){var n=this,r=IDBKeyRange.bound(this.keyForBatchId(Vn),this.keyForBatchId(e));return tt(t).loadAll(r).next(function(t){return t.map(function(t){return n.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Jn.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return et(t).iterate({range:i},function(r,i,a){var s=r[0],c=r[1],h=r[2],l=Y(c);if(s===n.userId&&e.path.equals(l)){var f=n.keyForBatchId(h);return tt(t).get(f).next(function(t){null===t&&u("Dangling document-mutation reference found: "+r+" which points to "+f),o.push(n.serializer.fromDbMutationBatch(t))})}a.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;c(!e.isDocumentQuery(),"Document queries shouldn't go down this path");var r=e.path,i=r.length+1,o=Jn.prefixForPath(this.userId,r),a=(o[1],IDBKeyRange.lowerBound(o)),s=new Ke(D);return et(t).iterate({range:a},function(t,e,o){var a=t[0],u=t[1],c=t[2],h=Y(u);a===n.userId&&r.isPrefixOf(h)?h.length===i&&(s=s.add(c)):o.done()}).next(function(){var e=[],r=[];return s.forEach(function(i){var o=n.keyForBatchId(i);r.push(tt(t).get(o).next(function(t){null===t&&u("Dangling document-mutation reference found, which points to "+o),e.push(n.serializer.fromDbMutationBatch(t))}))}),Nn.waitFor(r).next(function(){return e})})},t.prototype.removeMutationBatches=function(t,e){for(var n=tt(t),r=et(t),i=[],o=function(t){var e=IDBKeyRange.only(a.keyForBatchId(t.batchId)),o=0,s=n.iterate({range:e},function(t,e,n){return o++,n.delete()});i.push(s.next(function(){c(1===o,"Dangling document-mutation reference found: Missing batch "+t.batchId)}));for(var u=0,h=t.mutations;u<h.length;u++){var l=h[u],f=Jn.key(a.userId,l.key.path,t.batchId);i.push(r.delete(f)),null!==a.garbageCollector&&a.garbageCollector.addPotentialGarbageKey(l.key)}},a=this,s=0,u=e;s<u.length;s++){o(u[s])}return Nn.waitFor(i)},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Nn.resolve();var r=IDBKeyRange.lowerBound(Jn.prefixForUser(e.userId)),i=[];return et(t).iterate({range:r},function(t,n,r){if(t[0]===e.userId){var o=Y(t[1]);i.push(o)}else r.done()}).next(function(){c(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.canonicalString()}))})})},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=this,r=Jn.prefixForPath(this.userId,e.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return et(t).iterate({range:o,keysOnly:!0},function(t,e,r){var o=t[0],s=t[1];t[2];o===n.userId&&s===i&&(a=!0),r.done()}).next(function(){return a})},t.prototype.keyForBatchId=function(t){return[this.userId,t]},t}(),hr=function(){function t(t){this.serializer=t,this.lastRemoteSnapshotVersion=Ne.MIN,this.metadata=new nr(0,0,Ne.MIN.toTimestamp()),this.garbageCollector=null}return t.prototype.start=function(t){var e=this;return ot(t).get(nr.key).next(function(t){if(null!==t){e.metadata=t;var n=t.lastRemoteSnapshotVersion;e.lastRemoteSnapshotVersion=Ne.fromTimestamp(new Se(n.seconds,n.nanos))}return Nn.resolve()})},t.prototype.getHighestTargetId=function(){return this.metadata.highestTargetId},t.prototype.getLastRemoteSnapshotVersion=function(){return this.lastRemoteSnapshotVersion},t.prototype.setLastRemoteSnapshotVersion=function(t,e){return this.lastRemoteSnapshotVersion=e,this.metadata.lastRemoteSnapshotVersion=e.toTimestamp(),ot(t).put(nr.key,this.metadata)},t.prototype.addQueryData=function(t,e){var n=this,r=e.targetId,i=it(t).put(this.serializer.toDbTarget(e));return r>this.metadata.highestTargetId?(this.metadata.highestTargetId=r,i.next(function(){return ot(t).put(nr.key,n.metadata)})):i},t.prototype.removeQueryData=function(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){it(t).delete(e.targetId)})},t.prototype.getQueryData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return it(t).iterate({range:i,index:tr.queryTargetsIndexName},function(t,r,i){var a=n.serializer.fromDbTarget(r);e.equals(a.query)&&(o=a,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=[],i=at(t);return e.forEach(function(t){var e=z(t.path);r.push(i.put(new er(n,e)))}),Nn.waitFor(r)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=[],o=at(t);return e.forEach(function(t){var e=z(t.path);i.push(o.delete([n,e])),null!==r.garbageCollector&&r.garbageCollector.addPotentialGarbageKey(t)}),Nn.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=at(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return this.notifyGCForRemovedKeys(t,r).next(function(){return n.delete(r)})},t.prototype.notifyGCForRemovedKeys=function(t,e){var n=this,r=at(t);return null!==this.garbageCollector&&this.garbageCollector.isEager?r.iterate({range:e,keysOnly:!0},function(t,e,r){var i=Y(t[1]),o=new qt(i);c(null!==n.garbageCollector,"GarbageCollector for query cache set to null during key removal."),n.garbageCollector.addPotentialGarbageKey(o)}):Nn.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=at(t),i=W();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=Y(t[1]),o=new qt(r);i=i.add(o)}).next(function(){return i})},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){c(null!==t,"Persistence Transaction cannot be null for query cache containsKey");var n=z(e.path),r=IDBKeyRange.bound([n],[function(t){return t+"\0"}(n)],!1,!0),i=0;return at(t).iterate({index:er.documentTargetsIndex,keysOnly:!0,range:r},function(t,e,n){i++,n.done()}).next(function(){return i>0})},t}(),lr=function(){function t(t){this.serializer=t}return t.prototype.addEntry=function(t,e){return ut(t).put(ct(e.key),this.serializer.toDbRemoteDocument(e))},t.prototype.removeEntry=function(t,e){return ut(t).delete(ct(e))},t.prototype.getEntry=function(t,e){var n=this;return ut(t).get(ct(e)).next(function(t){return t?n.serializer.fromDbRemoteDocument(t):null})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=this,r=q(),i=e.path.toArray(),o=IDBKeyRange.lowerBound(i);return ut(t).iterate({range:o},function(t,i,o){var a=n.serializer.fromDbRemoteDocument(i);e.path.isPrefixOf(a.key.path)?a instanceof jt&&e.matches(a)&&(r=r.insert(a.key,a)):o.done()}).next(function(){return r})},t}(),fr=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document);if(t.noDocument){var e=qt.fromSegments(t.noDocument.path),n=t.noDocument.readTime,r=new Se(n.seconds,n.nanos);return new Wt(e,Ne.fromTimestamp(r))}return u("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t){if(t instanceof jt){var e=this.remoteSerializer.toDocument(t);return new Zn(null,e)}var n=t.key.path.toArray(),r=t.version.toTimestamp(),i=new Hn(r.seconds,r.nanos);return new Zn(new $n(n,i),null)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new Yn(t,e.batchId,e.localWriteTime.toEpochMilliseconds(),r)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),r=Se.fromEpochMilliseconds(t.localWriteTimeMs);return new qn(t.batchId,r,n)},t.prototype.fromDbTarget=function(t){var e,n=new Se(t.readTime.seconds,t.readTime.nanos),r=Ne.fromTimestamp(n);return e=function(t){return void 0!==t.documents}(t.query)?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new Re(e,t.targetId,Yt.Listen,r,t.resumeToken)},t.prototype.toDbTarget=function(t){c(Yt.Listen===t.purpose,"Only queries with purpose "+Yt.Listen+" may be stored, got "+t.purpose);var e,n=t.snapshotVersion.toTimestamp(),r=new Hn(n.seconds,n.nanos);e=t.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.query):this.remoteSerializer.toQueryTarget(t.query),c("string"==typeof t.resumeToken,"Persisting non-string resume token not supported.");var i=t.resumeToken;return new tr(t.targetId,t.query.canonicalId(),r,i,0,e)},t}(),pr="IndexedDbPersistence",dr="There is another tab open with offline persistence enabled. Only one such tab is allowed at a time. The other tab must be closed or persistence must be disabled.",yr=function(){function t(e,n){this.ownerId=this.generateOwnerId(),this.dbName=e+t.MAIN_DATABASE,this.serializer=new fr(n),this.localStoragePrefix=e}return t.prototype.start=function(){var e=this;return t.isAvailable()?(c(!this.started,"IndexedDbPersistence double-started!"),this.started=!0,or.openOrCreate(this.dbName,1,J).then(function(t){e.simpleDb=t}).then(function(){return e.tryAcquireOwnerLease()}).then(function(){e.scheduleOwnerLeaseRefreshes(),e.attachWindowUnloadHook()})):(this.persistenceError=new At(Nt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled."),Promise.reject(this.persistenceError))},t.prototype.shutdown=function(){var t=this;return c(this.started,"IndexedDbPersistence shutdown without start!"),this.started=!1,this.detachWindowUnloadHook(),this.stopOwnerLeaseRefreshes(),this.releaseOwnerLease().then(function(){t.simpleDb.close()})},t.prototype.getMutationQueue=function(t){return cr.forUser(t,this.serializer)},t.prototype.getQueryCache=function(){return new hr(this.serializer)},t.prototype.getRemoteDocumentCache=function(){return new lr(this.serializer)},t.prototype.runTransaction=function(t,e){var n=this;return this.persistenceError?Promise.reject(this.persistenceError):(o(pr,"Starting transaction:",t),this.simpleDb.runTransaction("readwrite",rr,function(t){return n.ensureOwnerLease(t).next(function(){return e(t)})}))},t.isAvailable=function(){return or.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.tryAcquireOwnerLease=function(){var t=this;return this.simpleDb.runTransaction("readwrite",[zn.store],function(e){var n=e.store(zn.store);return n.get("owner").next(function(e){if(t.validOwner(e))return o(pr,"Valid owner already. Failing. Current owner:",e),t.persistenceError=new At(Nt.FAILED_PRECONDITION,dr),Nn.reject(t.persistenceError);var r=new zn(t.ownerId,Date.now());return o(pr,"No valid owner. Acquiring owner lease. Current owner:",e,"New owner:",r),n.put("owner",r)})})},t.prototype.releaseOwnerLease=function(){var t=this;return this.simpleDb.runTransaction("readwrite",[zn.store],function(e){var n=e.store(zn.store);return n.get("owner").next(function(e){return null!==e&&e.ownerId===t.ownerId?(o(pr,"Releasing owner lease."),n.delete("owner")):Nn.resolve()})})},t.prototype.ensureOwnerLease=function(t){var e=this;return t.store(zn.store).get("owner").next(function(t){return null===t||t.ownerId!==e.ownerId?(e.persistenceError=new At(Nt.FAILED_PRECONDITION,dr),Nn.reject(e.persistenceError)):Nn.resolve()})},t.prototype.validOwner=function(t){var e=Date.now(),n=e-5e3,r=e;return null!==t&&(!(t.leaseTimestampMs<n)&&(t.leaseTimestampMs>r?(a("Persistence owner-lease is in the future. Discarding.",t),!1):t.ownerId!==this.getZombiedOwnerId()))},t.prototype.scheduleOwnerLeaseRefreshes=function(){var t=this;this.ownerLeaseRefreshHandle=setInterval(function(){t.runTransaction("Refresh owner timestamp",function(e){return e.store(zn.store).put("owner",new zn(t.ownerId,Date.now()))}).catch(function(e){a(e),t.stopOwnerLeaseRefreshes()})},4e3)},t.prototype.stopOwnerLeaseRefreshes=function(){this.ownerLeaseRefreshHandle&&(clearInterval(this.ownerLeaseRefreshHandle),this.ownerLeaseRefreshHandle=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;this.windowUnloadHandler=function(){t.setZombiedOwnerId(t.ownerId),t.shutdown()},window.addEventListener("unload",this.windowUnloadHandler)},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.getZombiedOwnerId=function(){try{var t=window.localStorage.getItem(this.zombiedOwnerLocalStorageKey());return o(pr,"Zombied ownerID from LocalStorage:",t),t}catch(t){return a(pr,"Failed to get zombie owner id.",t),null}},t.prototype.setZombiedOwnerId=function(t){try{null===t?window.localStorage.removeItem(this.zombiedOwnerLocalStorageKey()):window.localStorage.setItem(this.zombiedOwnerLocalStorageKey(),t)}catch(t){a(pr,"Failed to set zombie owner id.",t)}},t.prototype.zombiedOwnerLocalStorageKey=function(){return this.localStoragePrefix+"zombiedOwnerId"},t.prototype.generateOwnerId=function(){return Rt.newId()},t.MAIN_DATABASE="main",t}(),mr=function(){function t(t,e){this.remoteDocumentCache=t,this.mutationQueue=e}return t.prototype.getDocument=function(t,e){var n=this;return this.remoteDocumentCache.getEntry(t,e).next(function(r){return n.computeLocalDocument(t,e,r)})},t.prototype.getDocuments=function(t,e){var n=this,r=[],i=V();return e.forEach(function(e){r.push(n.getDocument(t,e).next(function(t){t||(t=new Wt(e,Ne.forDeletedDoc())),i=i.insert(e,t)}))}),Nn.waitFor(r).next(function(){return i})},t.prototype.getDocumentsMatchingQuery=function(t,e){return qt.isDocumentKey(e.path)?this.getDocumentsMatchingDocumentQuery(t,e.path):this.getDocumentsMatchingCollectionQuery(t,e)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new qt(e)).next(function(t){var e=q();return t instanceof jt&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e){var n,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e).next(function(e){return r.computeLocalDocuments(t,e)}).next(function(i){return n=i,r.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){for(var i=W(),o=0,a=e;o<a.length;o++)for(var s=0,u=a[o].mutations;s<u.length;s++){var c=u[s];n.get(c.key)||(i=i.add(c.key))}var h=[];return i.forEach(function(e){h.push(r.getDocument(t,e).next(function(t){t instanceof jt&&(n=n.insert(t.key,t))}))}),Nn.waitFor(h)}).next(function(){return n.forEach(function(t,r){e.matches(r)||(n=n.remove(t))}),n})},t.prototype.computeLocalDocument=function(t,e,n){return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];n=o.applyToLocalView(e,n)}return n})},t.prototype.computeLocalDocuments=function(t,e){var n=this,r=[];return e.forEach(function(i,o){r.push(n.computeLocalDocument(t,i,o).next(function(t){t instanceof jt?e=e.insert(t.key,t):t instanceof Wt?e=e.remove(t.key):u("Unknown MaybeDocument: "+t)}))}),Nn.waitFor(r).next(function(){return e})},t}(),vr=function(){function t(t){this.remoteDocumentCache=t,this.changes=V()}return t.prototype.addEntry=function(t){var e=this.assertChanges();this.changes=e.insert(t.key,t)},t.prototype.getEntry=function(t,e){var n=this.assertChanges().get(e);return n?Nn.resolve(n):this.remoteDocumentCache.getEntry(t,e)},t.prototype.apply=function(t){var e=this,n=[];return this.assertChanges().forEach(function(r,i){n.push(e.remoteDocumentCache.addEntry(t,i))}),this.changes=null,Nn.waitFor(n)},t.prototype.assertChanges=function(){return c(null!==this.changes,"Changes have already been applied."),this.changes},t}(),gr=function(){function t(t,e,n){this.persistence=t,this.garbageCollector=n,this.localViewReferences=new On,this.targetIds={},this.targetIdGenerator=Mn.forLocalStore(),this.heldBatchResults=[],this.mutationQueue=t.getMutationQueue(e),this.remoteDocuments=t.getRemoteDocumentCache(),this.queryCache=t.getQueryCache(),this.localDocuments=new mr(this.remoteDocuments,this.mutationQueue),this.garbageCollector.addGarbageSource(this.localViewReferences),this.garbageCollector.addGarbageSource(this.queryCache),this.garbageCollector.addGarbageSource(this.mutationQueue)}return t.prototype.start=function(){var t=this;return this.persistence.runTransaction("Start LocalStore",function(e){return t.startMutationQueue(e).next(function(){return t.startQueryCache(e)})})},t.prototype.handleUserChange=function(t){var e=this;return this.persistence.runTransaction("Handle user change",function(n){var r;return e.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,e.garbageCollector.removeGarbageSource(e.mutationQueue),e.mutationQueue=e.persistence.getMutationQueue(t),e.garbageCollector.addGarbageSource(e.mutationQueue),e.startMutationQueue(n)}).next(function(){return e.localDocuments=new mr(e.remoteDocuments,e.mutationQueue),e.mutationQueue.getAllMutationBatches(n)}).next(function(t){for(var i=W(),o=0,a=[r,t];o<a.length;o++)for(var s=0,u=a[o];s<u.length;s++)for(var c=0,h=u[s].mutations;c<h.length;c++){var l=h[c];i=i.add(l.key)}return e.localDocuments.getDocuments(n,i)})})},t.prototype.startQueryCache=function(t){var e=this;return this.queryCache.start(t).next(function(){var t=e.queryCache.getHighestTargetId();e.targetIdGenerator=Mn.forLocalStore(t)})},t.prototype.startMutationQueue=function(t){var e=this;return this.mutationQueue.start(t).next(function(){return e.heldBatchResults=[],e.mutationQueue.getHighestAcknowledgedBatchId(t)}).next(function(n){return n!==Vn?e.mutationQueue.getAllMutationBatchesThroughBatchId(t,n):Nn.resolve([])}).next(function(n){return n.length>0?e.mutationQueue.removeMutationBatches(t,n):Nn.resolve()})},t.prototype.localWrite=function(t){var e=this;return this.persistence.runTransaction("Locally write mutations",function(n){var r,i=Se.now();return e.mutationQueue.addMutationBatch(n,i,t).next(function(t){var i=(r=t).keys();return e.localDocuments.getDocuments(n,i)}).next(function(t){return{batchId:r.batchId,changes:t}})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch",function(n){var r;return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){if(e.shouldHoldBatchResult(t.commitVersion))return e.heldBatchResults.push(t),r=W(),Nn.resolve();var i=new vr(e.remoteDocuments);return e.releaseBatchResults(n,[t],i).next(function(t){return r=t,i.apply(n)})}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch",function(n){var r,i;return e.mutationQueue.lookupMutationBatch(n,t).next(function(i){return c(null!=i,"Attempt to reject nonexistent batch!"),r=i,e.mutationQueue.getHighestAcknowledgedBatchId(n).next(function(e){return c(t>e,"Acknowledged batches can't be rejected."),r})}).next(function(){return e.removeMutationBatch(n,r)}).next(function(t){return i=t,e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,i)})})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){return this.queryCache.getLastRemoteSnapshotVersion()},t.prototype.applyRemoteEvent=function(t){var e=this,n=new vr(this.remoteDocuments);return this.persistence.runTransaction("Apply remote event",function(r){var i=[];p(t.targetChanges,function(t,n){var o=e.targetIds[t];if(o){var a=n.mapping;if(a)if(a instanceof $e)i.push(e.queryCache.removeMatchingKeysForTargetId(r,t).next(function(){return e.queryCache.addMatchingKeys(r,a.documents,t)}));else{if(!(a instanceof Ze))return u("Unknown mapping type: "+JSON.stringify(a));i.push(e.queryCache.removeMatchingKeys(r,a.removedDocuments,t).next(function(){return e.queryCache.addMatchingKeys(r,a.addedDocuments,t)}))}var s=n.resumeToken;s.length>0&&(o=o.update({resumeToken:s,snapshotVersion:n.snapshotVersion}),e.targetIds[t]=o,i.push(e.queryCache.addQueryData(r,o)))}});var a=W();t.documentUpdates.forEach(function(t,s){a=a.add(t),i.push(n.getEntry(r,t).next(function(r){null==r||s.version.equals(Ne.MIN)||s.version.compareTo(r.version)>=0?n.addEntry(s):o("LocalStore","Ignoring outdated watch update for ",t,". Current version:",r.version," Watch version:",s.version),e.garbageCollector.addPotentialGarbageKey(t)}))});var s=e.queryCache.getLastRemoteSnapshotVersion(),h=t.snapshotVersion;h.equals(Ne.MIN)||(c(h.compareTo(s)>=0,"Watch stream reverted to previous snapshot?? "+h+" < "+s),i.push(e.queryCache.setLastRemoteSnapshotVersion(r,h)));var l;return Nn.waitFor(i).next(function(){return e.releaseHeldBatchResults(r,n)}).next(function(t){return l=t,n.apply(r)}).next(function(){return e.localDocuments.getDocuments(r,a.unionWith(l))})})},t.prototype.notifyLocalViewChanges=function(t){var e=this;return this.persistence.runTransaction("Notify local view changes",function(n){for(var r=[],i=function(t){r.push(e.queryCache.getQueryData(n,t.query).next(function(n){c(null!==n,"Local view changes contain unallocated query.");var r=n.targetId;e.localViewReferences.addReferences(t.addedKeys,r),e.localViewReferences.removeReferences(t.removedKeys,r)}))},o=0,a=t;o<a.length;o++){i(a[o])}return Nn.waitFor(r)})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch",function(n){return void 0===t&&(t=Vn),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateQuery=function(t){var e=this;return this.persistence.runTransaction("Allocate query",function(n){var r;return e.queryCache.getQueryData(n,t).next(function(i){if(i)return r=i,Nn.resolve();var o=e.targetIdGenerator.next();return r=new Re(t,o,Yt.Listen),e.queryCache.addQueryData(n,r)}).next(function(){return c(!e.targetIds[r.targetId],"Tried to allocate an already allocated query: "+t),e.targetIds[r.targetId]=r,r})})},t.prototype.releaseQuery=function(t){var e=this;return this.persistence.runTransaction("Release query",function(n){return e.queryCache.getQueryData(n,t).next(function(r){return c(null!=r,"Tried to release nonexistent query: "+t),e.localViewReferences.removeReferencesForId(r.targetId),delete e.targetIds[r.targetId],e.garbageCollector.isEager?e.queryCache.removeQueryData(n,r):Nn.resolve()}).next(function(){if(y(e.targetIds)){var t=new vr(e.remoteDocuments);return e.releaseHeldBatchResults(n,t).next(function(){t.apply(n)})}return Nn.resolve()})})},t.prototype.executeQuery=function(t){var e=this;return this.persistence.runTransaction("Execute query",function(n){return e.localDocuments.getDocumentsMatchingQuery(n,t)})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys",function(n){return e.queryCache.getMatchingKeysForTargetId(n,t)})},t.prototype.collectGarbage=function(){var t=this;return this.persistence.runTransaction("Garbage collection",function(e){return t.garbageCollector.collectGarbage(e).next(function(n){var r=[];return n.forEach(function(n){r.push(t.remoteDocuments.removeEntry(e,n))}),Nn.waitFor(r)})})},t.prototype.releaseHeldBatchResults=function(t,e){for(var n=[],r=0,i=this.heldBatchResults;r<i.length;r++){var o=i[r];if(!this.isRemoteUpToVersion(o.commitVersion))break;n.push(o)}return 0===n.length?Nn.resolve(W()):(this.heldBatchResults.splice(0,n.length),this.releaseBatchResults(t,n,e))},t.prototype.isRemoteUpToVersion=function(t){var e=this.queryCache.getLastRemoteSnapshotVersion();return t.compareTo(e)<=0||y(this.targetIds)},t.prototype.shouldHoldBatchResult=function(t){return!this.isRemoteUpToVersion(t)||this.heldBatchResults.length>0},t.prototype.releaseBatchResults=function(t,e,n){for(var r=this,i=Nn.resolve(),o=function(e){i=i.next(function(){return r.applyWriteToRemoteDocuments(t,e,n)})},a=0,s=e;a<s.length;a++){o(s[a])}return i.next(function(){return r.removeMutationBatches(t,e.map(function(t){return t.batch}))})},t.prototype.removeMutationBatch=function(t,e){return this.removeMutationBatches(t,[e])},t.prototype.removeMutationBatches=function(t,e){for(var n=W(),r=0,i=e;r<i.length;r++)for(var o=0,a=i[r].mutations;o<a.length;o++){var s=a[o].key;n=n.add(s)}return this.mutationQueue.removeMutationBatches(t,e).next(function(){return n})},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=e.batch,i=r.keys(),o=Nn.resolve();return i.forEach(function(i){o=o.next(function(){return n.getEntry(t,i)}).next(function(t){var o=t,a=e.docVersions.get(i);c(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=r.applyToRemoteDocument(i,o,e))?n.addEntry(o):c(!t,"Mutation batch "+r+" applied to document "+t+" resulted in null"))})}),o},t}(),_r=function(){function t(){this.mutationQueue=[],this.nextBatchId=1,this.highestAcknowledgedBatchId=Vn,this.lastStreamToken=h(),this.garbageCollector=null,this.batchesByDocumentKey=new Ke(Pn.compareByKey)}return t.prototype.start=function(t){return 0===this.mutationQueue.length&&(this.nextBatchId=1,this.highestAcknowledgedBatchId=Vn),c(this.highestAcknowledgedBatchId<this.nextBatchId,"highestAcknowledgedBatchId must be less than the nextBatchId"),Nn.resolve()},t.prototype.checkEmpty=function(t){return Nn.resolve(0===this.mutationQueue.length)},t.prototype.getNextBatchId=function(t){return Nn.resolve(this.nextBatchId)},t.prototype.getHighestAcknowledgedBatchId=function(t){return Nn.resolve(this.highestAcknowledgedBatchId)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId;c(r>this.highestAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order");var i=this.indexOfExistingBatchId(r,"acknowledged"),o=this.mutationQueue[i];return c(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),c(!o.isTombstone(),"Can't acknowledge a previously removed batch"),this.highestAcknowledgedBatchId=r,this.lastStreamToken=n,Nn.resolve()},t.prototype.getLastStreamToken=function(t){return Nn.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,Nn.resolve()},t.prototype.addMutationBatch=function(t,e,n){c(0!==n.length,"Mutation batches should not be empty");var r=this.nextBatchId;if(this.nextBatchId++,this.mutationQueue.length>0){c(this.mutationQueue[this.mutationQueue.length-1].batchId<r,"Mutation batchIDs must be monotonically increasing order")}var i=new qn(r,e,n);this.mutationQueue.push(i);for(var o=0,a=n;o<a.length;o++){var s=a[o];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Pn(s.key,r))}return Nn.resolve(i)},t.prototype.lookupMutationBatch=function(t,e){return Nn.resolve(this.findMutationBatch(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.mutationQueue.length;e=Math.max(e+1,this.highestAcknowledgedBatchId);for(var r=this.indexOfBatchId(e),i=r<0?0:r;i<n;i++){var o=this.mutationQueue[i];if(!o.isTombstone())return Nn.resolve(o)}return Nn.resolve(null)},t.prototype.getAllMutationBatches=function(t){return Nn.resolve(this.getAllLiveMutationBatchesBeforeIndex(this.mutationQueue.length))},t.prototype.getAllMutationBatchesThroughBatchId=function(t,e){var n=this.mutationQueue.length,r=this.indexOfBatchId(e);return r<0?r=0:r>=n?r=n:r++,Nn.resolve(this.getAllLiveMutationBatchesBeforeIndex(r))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Pn(e,0),i=new Pn(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){c(e.equals(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);c(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),Nn.resolve(o)},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=r;qt.isDocumentKey(o)||(o=o.child(""));var a=new Pn(new qt(o),0),s=new Ke(D);this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!r.isPrefixOf(e)&&(e.length===i&&(s=s.add(t.targetOrBatchId)),!0)},a);var u=[];return s.forEach(function(t){var e=n.findMutationBatch(t);null!==e&&u.push(e)}),Nn.resolve(u)},t.prototype.removeMutationBatches=function(t,e){var n=e.length;c(n>0,"Should not remove mutations when none exist.");var r=e[0].batchId,i=this.mutationQueue.length,o=this.indexOfExistingBatchId(r,"removed");c(this.mutationQueue[o].batchId===r,"Removed batches must exist in the queue");for(var a=1,s=o+1;a<n&&s<i;){(d=this.mutationQueue[s]).isTombstone()?s++:(c(d.batchId===e[a].batchId,"Removed batches must be contiguous in the queue"),a++,s++)}if(0===o){for(;s<i;s++){if(!(d=this.mutationQueue[s]).isTombstone())break}var u=s-o;this.mutationQueue.splice(o,u)}else for(var h=o;h<s;h++)this.mutationQueue[h]=this.mutationQueue[h].toTombstone();for(var l=this.batchesByDocumentKey,f=0,p=e;f<p.length;f++)for(var d,y=(d=p[f]).batchId,m=0,v=d.mutations;m<v.length;m++){var g=v[m].key;null!==this.garbageCollector&&this.garbageCollector.addPotentialGarbageKey(g);var _=new Pn(g,y);l=l.delete(_)}return this.batchesByDocumentKey=l,Nn.resolve()},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=new Pn(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return Nn.resolve(e.equals(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&c(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),Nn.resolve()},t.prototype.getAllLiveMutationBatchesBeforeIndex=function(t){for(var e=[],n=0;n<t;n++){var r=this.mutationQueue[n];r.isTombstone()||e.push(r)}return e},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return c(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){if(0===this.mutationQueue.length)return 0;return t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return c(n.batchId===t,"If found batch must match"),n.isTombstone()?null:n},t}(),br=function(){function t(){this.queries=new Tn(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Ne.MIN,this.highestTargetId=0,this.references=new On}return t.prototype.start=function(t){return Nn.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(){return this.lastRemoteSnapshotVersion},t.prototype.getHighestTargetId=function(){return this.highestTargetId},t.prototype.setLastRemoteSnapshotVersion=function(t,e){return this.lastRemoteSnapshotVersion=e,Nn.resolve()},t.prototype.addQueryData=function(t,e){this.queries.set(e.query,e);var n=e.targetId;return n>this.highestTargetId&&(this.highestTargetId=n),Nn.resolve()},t.prototype.removeQueryData=function(t,e){return this.queries.delete(e.query),this.references.removeReferencesForId(e.targetId),Nn.resolve()},t.prototype.getQueryData=function(t,e){var n=this.queries.get(e)||null;return Nn.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this.references.addReferences(e,n),Nn.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){return this.references.removeReferences(e,n),Nn.resolve()},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),Nn.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return Nn.resolve(n)},t.prototype.setGarbageCollector=function(t){this.references.setGarbageCollector(t)},t.prototype.containsKey=function(t,e){return this.references.containsKey(t,e)},t}(),wr=function(){function t(){this.docs=V()}return t.prototype.addEntry=function(t,e){return this.docs=this.docs.insert(e.key,e),Nn.resolve()},t.prototype.removeEntry=function(t,e){return this.docs=this.docs.remove(e),Nn.resolve()},t.prototype.getEntry=function(t,e){return Nn.resolve(this.docs.get(e))},t.prototype.getDocumentsMatchingQuery=function(t,e){for(var n=q(),r=new qt(e.path.child("")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),a=o.key,s=o.value;if(!e.path.isPrefixOf(a.path))break;s instanceof jt&&e.matches(s)&&(n=n.insert(s.key,s))}return Nn.resolve(n)},t}(),Er=function(){function t(){this.mutationQueues={},this.remoteDocumentCache=new wr,this.queryCache=new br,this.started=!1}return t.prototype.start=function(){return c(!this.started,"MemoryPersistence double-started!"),this.started=!0,Promise.resolve()},t.prototype.shutdown=function(){return c(this.started,"MemoryPersistence shutdown without start!"),this.started=!1,Promise.resolve()},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new _r,this.mutationQueues[t.toKey()]=e),e},t.prototype.getQueryCache=function(){return this.queryCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e){return o("MemoryPersistence","Starting transaction:",t),e(new Tr).toPromise()},t}(),Tr=function(){return function(){}}(),Ir=function(){function t(){this.isEager=!1}return t.prototype.addGarbageSource=function(t){},t.prototype.removeGarbageSource=function(t){},t.prototype.addPotentialGarbageKey=function(t){},t.prototype.collectGarbage=function(t){return Nn.resolve(W())},t}(),Cr=function(){return function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}}(),Sr=function(){function t(t,e,n){this.initialDelayMs=t,this.backoffFactor=e,this.maxDelayMs=n,this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndWait=function(){var t=new Cr,e=this.currentBaseMs+this.jitterDelayMs();return this.currentBaseMs>0&&o("ExponentialBackoff","Backing off for "+e+" ms (base delay: "+this.currentBaseMs+" ms)"),setTimeout(function(){t.resolve()},e),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs),t.promise},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}(),Nr=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){t[t.Initial=0]="Initial",t[t.Auth=1]="Auth",t[t.Open=2]="Open",t[t.Error=3]="Error",t[t.Backoff=4]="Backoff",t[t.Stopped=5]="Stopped"}(kn||(kn={}));var Ar,Rr=1e3,Or=6e4,Pr=1.5,Dr=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentialsProvider=n,this.idle=!1,this.stream=null,this.listener=null,this.backoff=new Sr(r||Rr,Pr,Or),this.state=kn.Initial}return t.prototype.isStarted=function(){return this.state===kn.Backoff||this.state===kn.Auth||this.state===kn.Open},t.prototype.isOpen=function(){return this.state===kn.Open},t.prototype.start=function(t){this.state!==kn.Error?(c(this.state===kn.Initial,"Already started"),this.listener=t,this.auth()):this.performBackoff(t)},t.prototype.stop=function(){this.isStarted()&&this.close(kn.Stopped)},t.prototype.inhibitBackoff=function(){c(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=kn.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.idle=!0,this.queue.schedule(function(){return t.handleIdleCloseTimer()},6e4).catch(function(t){c(t.code===Nt.CANCELLED,"Received unexpected error in idle timeout closure. Expected CANCELLED, but was: "+t)})},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return this.isOpen()&&this.idle?this.close(kn.Initial):Promise.resolve()},t.prototype.cancelIdleCheck=function(){this.idle=!1},t.prototype.close=function(t,e){c(t==kn.Error||F(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),t!=kn.Error?this.backoff.reset():e&&e.code===Nt.RESOURCE_EXHAUSTED&&(o("PersistentStream","Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t;var n=this.listener;return this.listener=null,t!=kn.Stopped?n.onClose(e):Promise.resolve()},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;c(this.state===kn.Initial,"Must be in initial state to auth"),this.state=kn.Auth,this.credentialsProvider.getToken(!1).then(function(e){t.startStream(e)},function(e){t.queue.schedule(function(){if(t.state!==kn.Stopped){var n=new At(Nt.UNKNOWN,"Fetching auth token failed: "+e.message);return t.handleStreamClose(n)}return Promise.resolve()})})},t.prototype.startStream=function(t){var e=this;if(this.state!==kn.Stopped){c(this.state===kn.Auth,"Trying to start stream in a non-auth state");var n=function(t,n){e.queue.schedule(function(){return e.stream===t?n():Promise.resolve()})};if(null!==this.listener){var r=this.startRpc(t);this.stream=r,this.stream.onOpen(function(){n(r,function(){return c(e.state===kn.Auth,"Expected stream to be in state auth, but was "+e.state),e.state=kn.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(r,function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(r,function(){return e.onMessage(t)})})}}},t.prototype.performBackoff=function(t){var e=this;c(this.state===kn.Error,"Should only perform backoff in an error case"),this.state=kn.Backoff,this.backoff.backoffAndWait().then(function(){e.queue.schedule(function(){return e.state===kn.Stopped?Promise.resolve():(e.state=kn.Initial,e.start(t),c(e.isStarted(),"PersistentStream should have started"),Promise.resolve())})})},t.prototype.handleStreamClose=function(t){return c(this.isStarted(),"Can't handle server close on non-started stream"),o("PersistentStream","close with error: "+t),this.stream=null,this.close(kn.Error,t)},t}(),kr=function(t){function e(e,n,r,i,o,a){var s=t.call(this,n,r,i,a)||this;return s.databaseInfo=e,s.serializer=o,s}return Nr(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(Dr),Mr=function(t){function e(e,n,r,i,o,a){var s=t.call(this,n,r,i,a)||this;return s.databaseInfo=e,s.serializer=o,s.handshakeComplete_=!1,s}return Nr(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(e){this.handshakeComplete_=!1,t.prototype.start.call(this,e)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(c(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return c(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){c(this.isOpen(),"Writing handshake requires an opened stream"),c(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;c(this.isOpen(),"Writing mutations requires an opened stream"),c(this.handshakeComplete_,"Handshake must be complete before writing mutations"),c(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.sendRequest(n)},e}(Dr),Lr=function(){function t(t,e,n,r,i,o){this.databaseInfo=t,this.queue=e,this.connection=n,this.credentials=r,this.serializer=i,this.initialBackoffDelay=o}return t.prototype.newPersistentWriteStream=function(){return new Mr(this.databaseInfo,this.queue,this.connection,this.credentials,this.serializer,this.initialBackoffDelay)},t.prototype.newPersistentWatchStream=function(){return new kr(this.databaseInfo,this.queue,this.connection,this.credentials,this.serializer,this.initialBackoffDelay)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC("Commit",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults)})},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=V();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);c(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken(!1).then(function(r){return n.connection.invokeRPC(t,e,r)})},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken(!1).then(function(r){return n.connection.invokeStreamingRPC(t,e,r)})},t}(),xr=function(){function t(t){this.datastore=t,this.readVersions=j(),this.mutations=[],this.committed=!1}return t.prototype.recordVersion=function(t){var e=t.version;t instanceof Wt&&(e=Ne.forDeletedDoc());var n=this.readVersions.get(t.key);if(null!==n){if(!e.equals(n))throw new At(Nt.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.lookup=function(t){var e=this;return this.committed?Promise.reject("Transaction has already completed."):this.mutations.length>0?Promise.reject("Transactions lookups are invalid after writes."):this.datastore.lookup(t).then(function(t){return t.forEach(function(t){return e.recordVersion(t)}),t})},t.prototype.write=function(t){if(this.committed)throw new At(Nt.FAILED_PRECONDITION,"Transaction has already completed.");this.mutations=this.mutations.concat(t)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return e?xe.updateTime(e):xe.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(e&&e.equals(Ne.forDeletedDoc()))throw new At(Nt.FAILED_PRECONDITION,"Can't update a document that doesn't exist.");return e?xe.updateTime(e):xe.exists(!0)},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t)))},t.prototype.update=function(t,e){this.write(e.toMutations(t,this.preconditionForUpdate(t)))},t.prototype.delete=function(t){this.write([new qe(t,this.precondition(t))]),this.readVersions=this.readVersions.insert(t,Ne.forDeletedDoc())},t.prototype.commit=function(){var t=this,e=this.readVersions;return this.mutations.forEach(function(t){e=e.remove(t.key)}),e.isEmpty()?this.datastore.commit(this.mutations).then(function(){t.committed=!0}):Promise.reject(Error("Every document read in a transaction must also be written."))},t}(),Fr="RemoteStore",Ur=function(){function t(t,e,n,r,i){this.databaseInfo=t,this.asyncQueue=e,this.localStore=n,this.datastore=r,this.onlineStateHandler=i,this.pendingWrites=[],this.lastBatchSeen=Vn,this.listenTargets={},this.pendingTargetResponses={},this.accumulatedWatchChanges=[],this.watchStream=null,this.writeStream=null,this.watchStreamOnlineState=yn.Unknown,this.watchStreamFailures=0,this.shouldWarnOffline=!0}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.setOnlineStateToHealthy=function(){this.shouldWarnOffline=!1,this.updateAndBroadcastOnlineState(yn.Healthy)},t.prototype.setOnlineStateToUnknown=function(){this.watchStreamFailures=0,this.updateAndBroadcastOnlineState(yn.Unknown)},t.prototype.updateOnlineStateAfterFailure=function(){this.watchStreamOnlineState===yn.Healthy?this.setOnlineStateToUnknown():(this.watchStreamFailures++,this.watchStreamFailures>=2&&(this.shouldWarnOffline&&(o(Fr,"Could not reach Firestore backend."),this.shouldWarnOffline=!1),this.updateAndBroadcastOnlineState(yn.Failed)))},t.prototype.updateAndBroadcastOnlineState=function(t){var e=this.watchStreamOnlineState!==t;this.watchStreamOnlineState=t,e&&this.onlineStateHandler(t)},t.prototype.isNetworkEnabled=function(){return c(null==this.watchStream==(null==this.writeStream),"WatchStream and WriteStream should both be null or non-null"),null!=this.watchStream},t.prototype.enableNetwork=function(){var t=this;return c(null==this.watchStream,"enableNetwork() called with non-null watchStream."),c(null==this.writeStream,"enableNetwork() called with non-null writeStream."),this.watchStream=this.datastore.newPersistentWatchStream(),this.writeStream=this.datastore.newPersistentWriteStream(),this.localStore.getLastStreamToken().then(function(e){return t.writeStream.lastStreamToken=e,t.shouldStartWatchStream()&&t.startWatchStream(),t.updateAndBroadcastOnlineState(yn.Unknown),t.fillWritePipeline()})},t.prototype.disableNetwork=function(){return this.updateAndBroadcastOnlineState(yn.Failed),this.watchStream.stop(),this.writeStream.stop(),this.cleanUpWatchStreamState(),this.cleanUpWriteStreamState(),this.writeStream=null,this.watchStream=null,Promise.resolve()},t.prototype.shutdown=function(){return o(Fr,"RemoteStore shutting down."),this.disableNetwork(),Promise.resolve(void 0)},t.prototype.listen=function(t){c(!f(this.listenTargets,t.targetId),"listen called with duplicate targetId!"),this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.isNetworkEnabled()&&this.watchStream.isOpen()&&this.sendWatchRequest(t)},t.prototype.unlisten=function(t){c(f(this.listenTargets,t),"unlisten called without assigned target ID!");this.listenTargets[t];delete this.listenTargets[t],this.isNetworkEnabled()&&this.watchStream.isOpen()&&(this.sendUnwatchRequest(t),y(this.listenTargets)&&this.watchStream.markIdle())},t.prototype.sendWatchRequest=function(t){this.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.recordPendingTargetRequest=function(t){this.pendingTargetResponses[t]=(this.pendingTargetResponses[t]||0)+1},t.prototype.startWatchStream=function(){c(this.shouldStartWatchStream(),"startWriteStream() called when shouldStartWatchStream() is false."),this.watchStream.start({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)})},t.prototype.shouldStartWatchStream=function(){return this.isNetworkEnabled()&&!this.watchStream.isStarted()&&!y(this.listenTargets)},t.prototype.cleanUpWatchStreamState=function(){this.accumulatedWatchChanges=[],this.pendingTargetResponses={}},t.prototype.onWatchStreamOpen=function(){var t=this;return p(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),Promise.resolve()},t.prototype.onWatchStreamClose=function(t){return c(this.isNetworkEnabled(),"onWatchStreamClose() should only be called when the network is enabled"),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.updateOnlineStateAfterFailure(),this.startWatchStream()):this.setOnlineStateToUnknown(),Promise.resolve()},t.prototype.onWatchStreamChange=function(t,e){if(this.setOnlineStateToHealthy(),t instanceof nn&&t.state===Ye.Removed&&t.cause)return this.handleTargetError(t);if(this.accumulatedWatchChanges.push(t),!e.equals(Ne.MIN)&&e.compareTo(this.localStore.getLastRemoteSnapshotVersion())>=0){var n=this.accumulatedWatchChanges;return this.accumulatedWatchChanges=[],this.handleWatchChangeBatch(e,n)}return Promise.resolve()},t.prototype.handleWatchChangeBatch=function(t,e){var n=this,r=new rn(t,this.listenTargets,this.pendingTargetResponses);r.addChanges(e);var i=r.createRemoteEvent();this.pendingTargetResponses=r.pendingTargetResponses;var o=[];return p(r.existenceFilters,function(e,r){var a=n.listenTargets[e];if(a){var s=a.query;if(s.isDocumentQuery())if(0===r.count){var u=new qt(s.path),h=new Wt(u,t);i.addDocumentUpdate(h)}else c(1===r.count,"Single document existence filter with count: "+r.count);else{var l=n.localStore.remoteDocumentKeys(e).then(function(t){if(i.targetChanges[e]){var o=i.targetChanges[e].mapping;null!==o&&(o instanceof Ze?t=o.applyToKeySet(t):(c(o instanceof $e,"Expected either reset or update mapping but got something else: "+o),t=o.documents))}if(t.size!==r.count){i.handleExistenceFilterMismatch(e);var u=new Re(s,e,a.purpose);n.listenTargets[e]=u,n.sendUnwatchRequest(e);var h=new Re(s,e,Yt.ExistenceFilterMismatch);n.sendWatchRequest(h)}});o.push(l)}}}),Promise.all(o).then(function(){return p(i.targetChanges,function(t,e){if(e.resumeToken.length>0){var r=n.listenTargets[t];r&&(n.listenTargets[t]=r.update({resumeToken:e.resumeToken,snapshotVersion:e.snapshotVersion}))}}),n.syncEngine.applyRemoteEvent(i)})},t.prototype.handleTargetError=function(t){var e=this;c(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return f(e.listenTargets,t)?(delete e.listenTargets[t],e.syncEngine.rejectListen(t,n)):Promise.resolve()})}),r},t.prototype.cleanUpWriteStreamState=function(){this.lastBatchSeen=Vn,this.pendingWrites=[]},t.prototype.fillWritePipeline=function(){var t=this;return this.canWriteMutations()?this.localStore.nextMutationBatch(this.lastBatchSeen).then(function(e){return null===e?(0==t.pendingWrites.length&&t.writeStream.markIdle(),Promise.resolve()):(t.commit(e),t.fillWritePipeline())}):Promise.resolve()},t.prototype.canWriteMutations=function(){return this.isNetworkEnabled()&&this.pendingWrites.length<10},t.prototype.outstandingWrites=function(){return this.pendingWrites.length},t.prototype.commit=function(t){c(this.canWriteMutations(),"commit called when batches can't be written"),this.lastBatchSeen=t.batchId,this.pendingWrites.push(t),this.shouldStartWriteStream()?this.startWriteStream():this.isNetworkEnabled()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.isNetworkEnabled()&&!this.writeStream.isStarted()&&this.pendingWrites.length>0},t.prototype.startWriteStream=function(){c(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})},t.prototype.onWriteStreamOpen=function(){return this.writeStream.writeHandshake(),Promise.resolve()},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,n=t.pendingWrites;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}})},t.prototype.onMutationResult=function(t,e){var n=this;c(this.pendingWrites.length>0,"Got result for empty pending writes");var r=this.pendingWrites.shift(),i=jn.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){var e=this;if(c(this.isNetworkEnabled(),"onWriteStreamClose() should only be called when the network is enabled"),t&&this.pendingWrites.length>0){c(!!t,"We have pending writes, but the write stream closed without an error");return(this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t)).then(function(){e.shouldStartWriteStream()&&e.startWriteStream()})}return Promise.resolve()},t.prototype.handleHandshakeError=function(t){return U(t.code)||t.code===Nt.ABORTED?(o(Fr,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=h(),this.localStore.setLastStreamToken(h())):Promise.resolve()},t.prototype.handleWriteError=function(t){var e=this;if(U(t.code)){var n=this.pendingWrites.shift();return this.writeStream.inhibitBackoff(),this.syncEngine.rejectFailedWrite(n.batchId,t).then(function(){return e.fillWritePipeline()})}return Promise.resolve()},t.prototype.createTransaction=function(){return new xr(this.datastore)},t.prototype.handleUserChange=function(t){return o(Fr,"RemoteStore changing users: uid=",t.uid),this.disableNetwork(),this.enableNetwork()},t}(),Br=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r}return t.prototype.start=function(t){var e=this,n=new Cr,r=new Cr,i=!1;return this.credentials.setUserChangeListener(function(o){i?e.asyncQueue.schedule(function(){return e.handleUserChange(o)}):(i=!0,e.initializePersistence(t,r).then(function(){return e.initializeRest(o)}).then(n.resolve,n.reject))}),this.asyncQueue.schedule(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.asyncQueue.schedule(function(){return t.remoteStore.enableNetwork()})},t.prototype.initializePersistence=function(t,e){var n=this;return t?this.startIndexedDbPersistence().then(e.resolve).catch(function(t){return e.reject(t),n.canFallback(t)?(console.warn("Error enabling offline storage. Falling back to storage disabled: "+t),n.startMemoryPersistence()):Promise.reject(t)}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t.code===Nt.FAILED_PRECONDITION||t.code===Nt.UNIMPLEMENTED},t.prototype.startIndexedDbPersistence=function(){this.garbageCollector=new Ir;var t=yr.buildStoragePrefix(this.databaseInfo),e=new sn(this.databaseInfo.databaseId,{useProto3Json:!0});return this.persistence=new yr(t,e),this.persistence.start()},t.prototype.startMemoryPersistence=function(){return this.garbageCollector=new An,this.persistence=new Er,this.persistence.start()},t.prototype.initializeRest=function(t){var e=this;return this.platform.loadConnection(this.databaseInfo).then(function(n){e.localStore=new gr(e.persistence,t,e.garbageCollector);var r=e.platform.newSerializer(e.databaseInfo.databaseId),i=new Lr(e.databaseInfo,e.asyncQueue,n,e.credentials,r);return e.remoteStore=new Ur(e.databaseInfo,e.asyncQueue,e.localStore,i,function(t){e.eventMgr.onOnlineStateChanged(t)}),e.syncEngine=new Bn(e.localStore,e.remoteStore,t),e.remoteStore.syncEngine=e.syncEngine,e.eventMgr=new Cn(e.syncEngine),e.localStore.start()}).then(function(){return e.remoteStore.start()})},t.prototype.handleUserChange=function(t){return this.asyncQueue.verifyOperationInProgress(),o("FirestoreClient","User Changed: "+t.uid),this.syncEngine.handleUserChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.asyncQueue.schedule(function(){return t.remoteStore.disableNetwork()})},t.prototype.shutdown=function(){var t=this;return this.asyncQueue.schedule(function(){return t.credentials.removeUserChangeListener(),t.remoteStore.shutdown()}).then(function(){return t.persistence.shutdown()})},t.prototype.listen=function(t,e,n){var r=this,i=new Sn(t,e,n);return this.asyncQueue.schedule(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.asyncQueue.schedule(function(){return e.eventMgr.unlisten(t)})},t.prototype.write=function(t){var e=this,n=new Cr;return this.asyncQueue.schedule(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},t.prototype.transaction=function(t){var e=this;return this.asyncQueue.schedule(function(){return Promise.resolve()}).then(function(){return e.syncEngine.runTransaction(t)})},t}(),Vr=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),qr=function(){function t(){this.tail=Promise.resolve(),this.delayedOperations=[],this.delayedOperationsCount=0,this.operationInProgress=!1}return t.prototype.schedule=function(t,e){var n=this;if(this.failure&&u("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message)),(e||0)>0){this.delayedOperationsCount++;var r={handle:null,op:t,deferred:new Cr};return r.handle=setTimeout(function(){n.scheduleInternal(function(){return r.op().then(function(t){r.deferred.resolve(t)})}),r.handle=null,n.delayedOperationsCount--,0===n.delayedOperationsCount&&(n.delayedOperations=[])},e),this.delayedOperations.push(r),r.deferred.promise}return this.scheduleInternal(t)},t.prototype.scheduleInternal=function(t){var e=this;return this.tail=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw a("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(){e.operationInProgress=!1})}),this.tail},t.prototype.verifyOperationInProgress=function(){c(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(t){var e=this;return this.delayedOperations.forEach(function(n){n.handle&&(clearTimeout(n.handle),t?e.scheduleInternal(n.op).then(n.deferred.resolve,n.deferred.reject):n.deferred.reject(new At(Nt.CANCELLED,"Operation cancelled by shutdown")))}),this.delayedOperations=[],this.delayedOperationsCount=0,this.schedule(function(){return Promise.resolve()})},t}(),jr=function(){function t(t){this.uid=t}return t.prototype.isUnauthenticated=function(){return null==this.uid},t.prototype.toKey=function(){return this.isUnauthenticated()?"anonymous-user":"uid:"+this.uid},t.prototype.equals=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),Wr=function(){return function(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}}}(),Kr=function(){function t(){this.userListener=null}return t.prototype.getToken=function(t){return Promise.resolve(null)},t.prototype.setUserChangeListener=function(t){c(!this.userListener,"Can only call setUserChangeListener() once."),this.userListener=t,t(jr.UNAUTHENTICATED)},t.prototype.removeUserChangeListener=function(){c(null!==this.userListener,"removeUserChangeListener() when no listener registered"),this.userListener=null},t}(),Gr=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.userCounter=0,this.userListener=null,this.tokenListener=function(){var t=e.getUser();e.currentUser&&t.equals(e.currentUser)||(e.currentUser=t,e.userCounter++,e.userListener&&e.userListener(e.currentUser))},this.userCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(t){var e=this;c(null!=this.tokenListener,"getToken cannot be called after listener removed.");var n=this.userCounter;return this.app.INTERNAL.getToken(t).then(function(t){if(e.userCounter!==n)throw new At(Nt.ABORTED,"getToken aborted due to uid change.");return t?(c("string"==typeof t.accessToken,"Invalid tokenData returned from getToken():"+t),new Wr(t.accessToken,e.currentUser)):null})},t.prototype.setUserChangeListener=function(t){c(!this.userListener,"Can only call setUserChangeListener() once."),this.userListener=t,this.currentUser&&t(this.currentUser)},t.prototype.removeUserChangeListener=function(){c(null!=this.tokenListener,"removeUserChangeListener() called twice"),c(null!==this.userListener,"removeUserChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.userListener=null},t.prototype.getUser=function(){"function"!=typeof this.app.INTERNAL.getUid&&u("This version of the Firestore SDK requires at least version 3.7.0 of firebase.js.");var t=this.app.INTERNAL.getUid();return c(null===t||"string"==typeof t,"Received invalid UID: "+t),new jr(t)},t}(),Qr=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=jr.FIRST_PARTY,c(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){return{Authorization:this.gapi.auth.getAuthHeaderValueForFirstParty([]),"X-Goog-AuthUser":this.sessionIndex}},enumerable:!0,configurable:!0}),t}(),Hr=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,c(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return t.prototype.getToken=function(t){return Promise.resolve(new Qr(this.gapi,this.sessionIndex))},t.prototype.setUserChangeListener=function(t){t(jr.FIRST_PARTY)},t.prototype.removeUserChangeListener=function(){},t}(),zr=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xr=function(){function t(){}return t.delete=function(){return Yr.instance},t.serverTimestamp=function(){return Jr.instance},t}(),Yr=function(t){function e(){return t.call(this)||this}return zr(e,t),e.instance=new e,e}(Xr),Jr=function(t){function e(){return t.call(this)||this}return zr(e,t),e.instance=new e,e}(Xr),$r=l(Xr,"Use FieldValue.<field>() instead."),Zr=/^__.*__$/,ti=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new Be(t,this.data,this.fieldMask,e)):n.push(new Ue(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Ve(t,this.fieldTransforms)),n},t}(),ei=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new Be(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new Ve(t,this.fieldTransforms)),n},t}();!function(t){t[t.Set=0]="Set",t[t.Update=1]="Update",t[t.MergeSet=2]="MergeSet",t[t.QueryValue=3]="QueryValue"}(Ar||(Ar={}));var ni=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new At(Nt.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(lt(this.dataSource)&&Zr.test(t))throw this.createError("Document fields cannot begin and end with __")},t.prototype.isWrite=function(){return this.dataSource===Ar.Set||this.dataSource===Ar.Update},t}(),ri=function(){return function(t,e){this.databaseId=t,this.key=e}}(),ii=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new ni(Ar.Set,t,Vt.EMPTY_PATH);pt("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new ti(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e){var n=new ni(Ar.MergeSet,t,Vt.EMPTY_PATH);pt("Data must be an object, but it was:",n,e);var r=this.parseData(e,n),i=new Pe(n.fieldMask);return new ti(r,i,n.fieldTransforms)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new ni(Ar.Update,t,Vt.EMPTY_PATH);pt("Data must be an object, but it was:",r,e);var i=[],o=ce.EMPTY;d(e,function(e,a){var s=yt(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof Yr)i.push(s);else{var c=n.parseData(a,u);null!=c&&(i.push(s),o=o.set(s,c))}});var a=new Pe(i);return new ei(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new ni(Ar.Update,t,Vt.EMPTY_PATH),o=[dt(t,e)],a=[n];if(r.length%2!=0)throw new At(Nt.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(dt(t,r[s])),a.push(r[s+1]);var u=[],c=ce.EMPTY;for(s=0;s<o.length;++s){var h=o[s],l=i.childContextForFieldPath(h),f=this.runPreConverter(a[s],l);if(f instanceof Yr)u.push(h);else{var p=this.parseData(f,l);null!=p&&(u.push(h),c=c.set(h,p))}}var d=new Pe(u);return new ei(c,d,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e){var n=new ni(Ar.QueryValue,t,Vt.EMPTY_PATH),r=this.parseData(e,n);return c(null!=r,"Parsed data should not be null."),c(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(t){var n=mt(t);throw e.createError(n)}},t.prototype.parseData=function(t,e){if((t=this.runPreConverter(t,e))instanceof Array){if(e.arrayElement)throw e.createError("Nested arrays are not supported");return e.path&&e.fieldMask.push(e.path),this.parseArray(t,e)}return ft(t)?(pt("Unsupported field value:",e,t),this.parseObject(t,e)):(e.path&&e.fieldMask.push(e.path),this.parseScalarValue(t,e))},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=$t.INSTANCE),n.push(s),r++}return new he(n)},t.prototype.parseObject=function(t,e){var n=this,r=new Kt(D);return d(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new ce(r)},t.prototype.parseScalarValue=function(t,e){if(null===t)return $t.INSTANCE;if("number"==typeof t)return function(t){return de(t)&&t<=pe&&t>=fe}(t)?new ee(t):new ne(t);if("boolean"==typeof t)return Zt.of(t);if("string"==typeof t)return new re(t);if(t instanceof Date)return new ie(Se.fromDate(t));if(t instanceof Dt)return new ue(t);if(t instanceof Ot)return new ae(t);if(t instanceof ri)return new se(t.databaseId,t.key);if(t instanceof Xr){if(t instanceof Yr){if(e.dataSource==Ar.MergeSet)return null;throw e.dataSource===Ar.Update?(c(null==e.path||e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() can only be used with update() and set() with {merge:true}")}if(t instanceof Jr){if(!lt(e.dataSource))throw e.createError("FieldValue.serverTimestamp() can only be used with set() and update()");if(null===e.path)throw e.createError("FieldValue.serverTimestamp() is not currently supported inside arrays");return e.fieldTransforms.push(new ke(e.path,De.instance)),null}return u("Unknown FieldValue type: "+t)}throw e.createError("Unsupported field value: "+S(t))},t}(),oi=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ai="firestore.googleapis.com",si=!0,ui=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new At(Nt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ai,this.ssl=si}else E("settings","string","host",t.host),this.host=t.host,T("settings","boolean","ssl",t.ssl),this.ssl=function(t,e){return void 0!==t?t:e}(t.ssl,si);A("settings",t,["host","ssl","credentials"]),T("settings","object","credentials",t.credentials),this.credentials=t.credentials}return t.prototype.equals=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials},t}(),ci=function(){return function(){}}(),hi=function(){function t(e){var n=this;this._queue=new qr,this.INTERNAL={delete:function(){return n._firestoreClient?n._firestoreClient.shutdown():Promise.resolve()},disableNetwork:function(){return n._firestoreClient.disableNetwork()},enableNetwork:function(){return n._firestoreClient.enableNetwork()},drainAsyncQueue:function(t){return n._queue.drain(t)}};var r=new ci;if("object"==typeof e.options){var i=e;r.firebaseApp=i,r.databaseId=t.databaseIdFromApp(i),r.persistenceKey=r.firebaseApp.name,r.credentials=new Gr(i)}else{var o=e;if(!o.projectId)throw new At(Nt.INVALID_ARGUMENT,"Must provide projectId");r.databaseId=new Lt(o.projectId,o.database),r.persistenceKey="[DEFAULT]",r.credentials=new Kr}r.settings=new ui({}),this._config=r,this._databaseId=r.databaseId}return t.prototype.settings=function(t){if(v("Firestore.settings",arguments,1),b("Firestore.settings","object",1,t),f(t,"persistence"))throw new At(Nt.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new ui(t);if(this._firestoreClient&&!this._config.settings.equals(e))throw new At(Nt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._config.settings=e,void 0!==e.credentials&&(this._config.credentials=function(t){if(!t)return new Kr;switch(t.type){case"gapi":return new Hr(t.client,t.sessionIndex||"0");case"provider":return t.client;default:throw new At(Nt.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enablePersistence=function(){if(this._firestoreClient)throw new At(Nt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");return this.configureClient(!0)},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(!1),this._firestoreClient},t.prototype.configureClient=function(t){var e=this;c(!!this._config.settings.host,"FirestoreSettings.host cannot be falsey"),c(!this._firestoreClient,"configureClient() called multiple times");var n=new kt(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl);return this._dataConverter=new ii(function(t){if(t instanceof pi){var n=e._config.databaseId,r=t.firestore._config.databaseId;if(!r.equals(n))throw new At(Nt.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new ri(e._config.databaseId,t._key)}return t}),this._firestoreClient=new Br(Ct.getPlatform(),n,this._config.credentials,this._queue),this._firestoreClient.start(t)},t.databaseIdFromApp=function(t){var e=t.options;if(!f(e,"projectId")){if(f(e,"firestoreId"))throw new At(Nt.INVALID_ARGUMENT,'"firestoreId" is now specified as "projectId" in firebase.initializeApp.');throw new At(Nt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.')}if(f(e,"firestoreOptions"))throw new At(Nt.INVALID_ARGUMENT,'"firestoreOptions" values are now specified with Firestore.settings()');var n=e.projectId;if(!n||"string"!=typeof n)throw new At(Nt.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Lt(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._config.firebaseApp)throw new At(Nt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._config.firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(v("Firestore.collection",arguments,1),b("Firestore.collection","string",1,t),!t)throw new At(Nt.INVALID_ARGUMENT,"Must provide a non-empty collection path to collection()");return this.ensureClientConfigured(),new vi(Ut.fromString(t),this)},t.prototype.doc=function(t){if(v("Firestore.doc",arguments,1),b("Firestore.doc","string",1,t),!t)throw new At(Nt.INVALID_ARGUMENT,"Must provide a non-empty document path to doc()");return this.ensureClientConfigured(),pi.forPath(Ut.fromString(t),this)},t.prototype.runTransaction=function(t){var e=this;return v("Firestore.runTransaction",arguments,1),b("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(n){return t(new li(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new fi(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(r()){case wt.DEBUG:return"debug";case wt.ERROR:return"error";case wt.SILENT:return"silent";default:return u("Unknown log level: "+r())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(v("Firestore.setLogLevel",arguments,1),b("Firestore.setLogLevel","string",1,t),t){case"debug":i(wt.DEBUG);break;case"error":i(wt.ERROR);break;case"silent":i(wt.SILENT);break;default:throw new At(Nt.INVALID_ARGUMENT,"Invalid log level: "+t)}},t}(),li=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;v("Transaction.get",arguments,1);var n=gt("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return u("Mismatch in docs returned from document lookup.");var r=t[0];return new di(e._firestore,n._key,r instanceof Wt?null:r,!1)})},t.prototype.set=function(t,e,n){_("Transaction.set",arguments,2,3);var r=gt("Transaction.set",t,this._firestore),i=(n=vt("Transaction.set",n)).merge?this._firestore._dataConverter.parseMergeData("Transaction.set",e):this._firestore._dataConverter.parseSetData("Transaction.set",e);return this._transaction.set(r._key,i),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,a;return"string"==typeof e||e instanceof mn?(g("Transaction.update",arguments,3),o=gt("Transaction.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,r)):(v("Transaction.update",arguments,2),o=gt("Transaction.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(o._key,a),this},t.prototype.delete=function(t){v("Transaction.delete",arguments,1);var e=gt("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),fi=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){_("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=gt("WriteBatch.set",t,this._firestore),i=(n=vt("WriteBatch.set",n)).merge?this._firestore._dataConverter.parseMergeData("WriteBatch.set",e):this._firestore._dataConverter.parseSetData("WriteBatch.set",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,xe.NONE)),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.verifyNotCommitted();var o,a;return"string"==typeof e||e instanceof mn?(g("WriteBatch.update",arguments,3),o=gt("WriteBatch.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,r)):(v("WriteBatch.update",arguments,2),o=gt("WriteBatch.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(a.toMutations(o._key,xe.exists(!0))),this},t.prototype.delete=function(t){v("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=gt("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new qe(e._key,xe.NONE)),this},t.prototype.commit=function(){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._firestore.ensureClientConfigured().write(this._mutations):Promise.resolve()},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new At(Nt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),pi=function(){function t(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!=0)throw new At(Nt.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new qt(e),n)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new vi(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(v("DocumentReference.collection",arguments,1),b("DocumentReference.collection","string",1,t),!t)throw new At(Nt.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Ut.fromString(t);return new vi(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw R("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.equals(e._key)},t.prototype.set=function(t,e){_("DocumentReference.set",arguments,1,2);var n=(e=vt("DocumentReference.set",e)).merge?this.firestore._dataConverter.parseMergeData("DocumentReference.set",t):this.firestore._dataConverter.parseSetData("DocumentReference.set",t);return this._firestoreClient.write(n.toMutations(this._key,xe.NONE))},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i;return"string"==typeof t||t instanceof mn?(g("DocumentReference.update",arguments,2),i=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,n)):(v("DocumentReference.update",arguments,1),i=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(i.toMutations(this._key,xe.exists(!0)))},t.prototype.delete=function(){return v("DocumentReference.delete",arguments,0),this._firestoreClient.write([new qe(this._key,xe.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];_("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||ht(t[i])||(A("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),T("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeDocumentMetadataChanges:r.includeMetadataChanges,includeQueryMetadataChanges:r.includeMetadataChanges};return ht(t[i])?n=t[i]:(b("DocumentReference.onSnapshot","function",i,t[i]),w("DocumentReference.onSnapshot","function",i+1,t[i+1]),w("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Vr({next:function(t){if(e.next){c(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new di(n.firestore,n._key,r,t.fromCache))}},error:r}),o=this._firestoreClient.listen(ye.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(){var t=this;return v("DocumentReference.get",arguments,0),new Promise(function(e,n){var r=t.onSnapshotInternal({includeQueryMetadataChanges:!0,includeDocumentMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new At(Nt.ABORTED,"Failed to get document because the client is offline.")):e(t)},error:n})})},t}(),di=function(){function t(t,e,n,r){this._firestore=t,this._key=e,this._document=n,this._fromCache=r}return t.prototype.data=function(){if(v("DocumentSnapshot.data",arguments,0),!this._document)throw new At(Nt.NOT_FOUND,"This document doesn't exist. Check doc.exists to make sure the document exists before calling doc.data().");return this.convertObject(this._document.data)},t.prototype.get=function(t){if(v("DocumentSnapshot.get",arguments,1),!this._document)throw new At(Nt.NOT_FOUND,"This document doesn't exist. Check doc.exists to make sure the document exists before calling doc.get().");var e=this._document.data.field(dt("DocumentSnapshot.get",t));return void 0===e?void 0:this.convertValue(e)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new pi(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return{hasPendingWrites:null!==this._document&&this._document.hasLocalMutations,fromCache:this._fromCache}},enumerable:!0,configurable:!0}),t.prototype.convertObject=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.convertValue(r)}),n},t.prototype.convertValue=function(t){if(t instanceof ce)return this.convertObject(t);if(t instanceof he)return this.convertArray(t);if(t instanceof se){var e=t.value(),n=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.equals(n)||a("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+n.projectId+"/"+n.database+") instead."),new pi(e,this._firestore)}return t.value()},t.prototype.convertArray=function(t){var e=this;return t.internalValue.map(function(t){return e.convertValue(t)})},t}(),yi=function(){function t(t,e){this._query=t,this.firestore=e}return t.prototype.where=function(e,n,r){v("Query.where",arguments,3),b("Query.where","string",2,n),N("Query.where",3,r);var i,o=dt("Query.where",e);if(o.isKeyField())if("string"==typeof r){if(-1!==r.indexOf("/"))throw new At(Nt.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it contains a slash.");if(""===r)throw new At(Nt.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it was an empty string.");var a=this._query.path.child(new Ut([r]));c(a.length%2==0,"Path should be a document key"),i=new se(this.firestore._databaseId,new qt(a))}else{if(!(r instanceof pi))throw new At(Nt.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a string or a DocumentReference if the first parameter is FieldPath.documentId(), but it was: "+S(r)+".");var s=r;i=new se(this.firestore._databaseId,s._key)}else i=this.firestore._dataConverter.parseQueryValue("Query.where",r);var u=function(t,e,n){if(n.equals($t.INSTANCE)){if(e!==me.EQUAL)throw new At(Nt.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on null.");return new ge(t)}if(n.equals(ne.NAN)){if(e!==me.EQUAL)throw new At(Nt.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on NaN.");return new _e(t)}return new ve(t,e,n)}(o,me.fromString(n),i);return this.validateNewFilter(u),new t(this._query.addFilter(u),this.firestore)},t.prototype.orderBy=function(e,n){_("Query.orderBy",arguments,1,2),w("Query.orderBy","string",2,n);var r;if(void 0===n||"asc"===n)r=be.ASCENDING;else{if("desc"!==n)throw new At(Nt.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=be.DESCENDING}if(null!==this._query.startAt)throw new At(Nt.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new At(Nt.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=dt("Query.orderBy",e),o=new Ee(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){if(v("Query.limit",arguments,1),b("Query.limit","number",1,e),e<=0)throw new At(Nt.INVALID_ARGUMENT,"Invalid Query. Query limit ("+e+") is invalid. Limit must be positive.");return new t(this._query.withLimit(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];g("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];g("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];g("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];g("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw R("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.equals(e._query)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(N(t,1,e),e instanceof di){if(n.length>0)throw new At(Nt.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new At(Nt.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new se(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(void 0===s){var u=a.field.canonicalString();throw new At(Nt.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new we(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new At(Nt.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new At(Nt.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(-1!==a.indexOf("/"))throw new At(Nt.INVALID_ARGUMENT,"Invalid query. Document ID '"+a+"' contains a slash in "+t+"()");var s=new qt(this._query.path.child(a));i.push(new se(this.firestore._databaseId,s))}else{var u=this.firestore._dataConverter.parseQueryValue(t,a);i.push(u)}}return new we(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];_("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||ht(t[i])||(A("Query.onSnapshot",r=t[i],["includeQueryMetadataChanges","includeDocumentMetadataChanges"]),T("Query.onSnapshot","boolean","includeDocumentMetadataChanges",r.includeDocumentMetadataChanges),T("Query.onSnapshot","boolean","includeQueryMetadataChanges",r.includeQueryMetadataChanges),i++),ht(t[i])?n=t[i]:(b("Query.onSnapshot","function",i,t[i]),w("Query.onSnapshot","function",i+1,t[i+1]),w("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Vr({next:function(t){e.next&&e.next(new mi(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.get=function(){var t=this;return v("Query.get",arguments,0),new Promise(function(e,n){var r=t.onSnapshotInternal({includeDocumentMetadataChanges:!1,includeQueryMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(t){r(),e(t)},error:n})})},t.prototype.validateNewFilter=function(t){if(t instanceof ve&&t.isInequality()){var e=this._query.getInequalityFilterField();if(null!==e&&!e.equals(t.field))throw new At(Nt.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+e.toString()+"' and '"+t.field.toString()+"'");var n=this._query.getFirstOrderByField();null!==n&&this.validateOrderByAndInequalityMatch(t.field,n)}},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.equals(t))throw new At(Nt.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),mi=function(){function t(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this.metadata={fromCache:n.fromCache,hasPendingWrites:n.hasPendingWrites}}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;_("QuerySnapshot.forEach",arguments,1,2),b("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new yi(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"docChanges",{get:function(){return this._cachedChanges||(this._cachedChanges=_t(this._firestore,this._snapshot)),this._cachedChanges},enumerable:!0,configurable:!0}),t.prototype.convertToDocumentImpl=function(t){return new di(this._firestore,t.key,t,this.metadata.fromCache)},t}(),vi=function(t){function e(e,n){var r=t.call(this,ye.atPath(e),n)||this;if(e.length%2!=1)throw new At(Nt.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}return oi(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new pi(new qt(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(_("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Rt.newId()),b("CollectionReference.doc","string",1,t),""===t)throw new At(Nt.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=Ut.fromString(t);return pi.forPath(this._query.path.child(e),this.firestore)},e.prototype.add=function(t){v("CollectionReference.add",arguments,1),b("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e}(yi),gi=l(hi,"Use firebase.firestore() instead."),_i=l(li,"Use firebase.firestore().runTransaction() instead."),bi=l(fi,"Use firebase.firestore().batch() instead."),wi=l(pi,"Use firebase.firestore().doc() instead."),Ei=l(di),Ti=l(yi),Ii=l(mi),Ci=l(vi,"Use firebase.firestore().collection() instead."),Si={Firestore:gi,GeoPoint:Dt,Blob:Pt,Transaction:_i,WriteBatch:bi,DocumentReference:wi,DocumentSnapshot:Ei,Query:Ti,QuerySnapshot:Ii,CollectionReference:Ci,FieldPath:mn,FieldValue:$r,setLogLevel:hi.setLogLevel};e.registerFirestore=bt,bt(Et.default)},"n1q+":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i,o=n("mnK5"),a=n("Amoq"),s=n("rd4o"),u=n("NxJK"),c=n("4uRS"),h=n("sC/S"),l=n("ytZ3"),f=n("uBgE"),p=n("CyQO"),d=n("wwn+"),y=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&c.validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&o.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return i||(i=new t(new s.SortedMap(d.NAME_COMPARATOR),null,f.IndexMap.Default))},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||i},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?i:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(o.assert(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new u.NamedNode(e,n),a=void 0,s=void 0,c=void 0;return n.isEmpty()?(a=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(a=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_)),c=a.isEmpty()?i:this.priorityNode_,new t(a,c,s)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;o.assert(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(h.PRIORITY_INDEX,function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1}),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+c.priorityHashText(this.getPriority().val())+":"),this.forEachChild(h.PRIORITY_INDEX,function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)}),this.lazyHash_=""===t?"":a.sha1(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new u.NamedNode(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new u.NamedNode(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new u.NamedNode(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal(function(t){return e(t.name,t.node)}):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,function(t){return t});for(var r=this.children_.getIteratorFrom(t.name,u.NamedNode.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,function(t){return t});for(var r=this.children_.getReverseIteratorFrom(t.name,u.NamedNode.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===e.MAX_NODE?-1:0},t.prototype.withIndex=function(e){if(e===l.KEY_INDEX||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===l.KEY_INDEX||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(h.PRIORITY_INDEX),r=e.getIterator(h.PRIORITY_INDEX),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===l.KEY_INDEX?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}();e.ChildrenNode=y;var m=function(t){function e(){return t.call(this,new s.SortedMap(d.NAME_COMPARATOR),y.EMPTY_NODE,f.IndexMap.Default)||this}return r(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return y.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(y);e.MaxNode=m,e.MAX_NODE=new m,Object.defineProperties(u.NamedNode,{MIN:{value:new u.NamedNode(a.MIN_NAME,y.EMPTY_NODE)},MAX:{value:new u.NamedNode(a.MAX_NAME,e.MAX_NODE)}}),l.KeyIndex.__EMPTY_NODE=y.EMPTY_NODE,p.LeafNode.__childrenNodeConstructor=y,c.setMaxNode(e.MAX_NODE),h.setMaxNode(e.MAX_NODE)},n5gG:function(t,e,n){n("n1Uv")},nf05:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("iZj6"),i=n("EEdD"),o=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new r.DOMStorageWrapper(e)}}catch(t){}return new i.MemoryStorage};e.PersistentStorage=o("localStorage"),e.SessionStorage=o("sessionStorage")},niZR:function(t,e,n){n("SUTf"),t.exports=n("qQjo").default},oCvb:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("0Mhn"),i=n("4AKd"),o=n("KbSj"),a=n("ZZsk"),s=n("zZtw"),u=n("GstQ"),c=n("mnK5"),h=n("Amoq"),l=n("mnK5"),f=n("KgKr"),p=n("fvGg"),d=n("joCY"),y=n("1et+"),m=n("Iq0B"),v=n("XpTC"),g=n("KyhF"),_=n("GC2w"),b=function(){function t(t,e,n){var r=this;this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new m.EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new a.SparseSnapshotTree,this.persistentConnection_=null;var i=new f.AuthTokenProvider(n);if(this.stats_=p.StatsManager.getCollection(t),e||h.beingCrawled())this.server_=new g.ReadonlyRestClient(this.repoInfo_,this.onDataUpdate_.bind(this),i),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var o=n.options.databaseAuthVariableOverride;if(void 0!==o&&null!==o){if("object"!=typeof o)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{c.stringify(o)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}this.persistentConnection_=new v.PersistentConnection(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),i,o),this.server_=this.persistentConnection_}i.addTokenChangeListener(function(t){r.server_.refreshAuthToken(t)}),this.statsReporter_=p.StatsManager.getOrCreateReporter(t,function(){return new d.StatsReporter(r.stats_,r.server_)}),this.transactions_init_(),this.infoData_=new u.SnapshotHolder,this.infoSyncTree_=new s.SyncTree({startListening:function(t,e,n,i){var o=[],a=r.infoData_.getNode(t.path);return a.isEmpty()||(o=r.infoSyncTree_.applyServerOverwrite(t.path,a),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new s.SyncTree({startListening:function(t,e,n,i){return r.server_.listen(t,n,e,function(e,n){var o=i(e,n);r.eventQueue_.raiseEventsForChangedPath(t.path,o)}),[]},stopListening:function(t,e){r.server_.unlisten(t,e)}})}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new o.Path(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return r.generateWithValues({timestamp:this.serverTime()})},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var a=new o.Path(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var s=[];if(r)if(n){var u=l.map(e,function(t){return i.nodeFromJSON(t)});s=this.serverSyncTree_.applyTaggedQueryMerge(a,u,r)}else{var c=i.nodeFromJSON(e);s=this.serverSyncTree_.applyTaggedQueryOverwrite(a,c,r)}else if(n){var h=l.map(e,function(t){return i.nodeFromJSON(t)});s=this.serverSyncTree_.applyServerMerge(a,h)}else{var f=i.nodeFromJSON(e);s=this.serverSyncTree_.applyServerOverwrite(a,f)}var p=a;s.length>0&&(p=this.rerunTransactions_(a)),this.eventQueue_.raiseEventsForChangedPath(p,s)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;h.each(t,function(t,n){e.updateInfo_(n,t)})},t.prototype.updateInfo_=function(t,e){var n=new o.Path("/.info/"+t),r=i.nodeFromJSON(e);this.infoData_.updateSnapshot(n,r);var a=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,a)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,o){var a=this;this.log_("set",{path:t.toString(),value:e,priority:n});var s=this.generateServerValues(),u=i.nodeFromJSON(e,n),c=r.resolveDeferredValueSnapshot(u,s),l=this.getNextWriteId_(),f=this.serverSyncTree_.applyUserOverwrite(t,c,l,!0);this.eventQueue_.queueEvents(f),this.server_.put(t.toString(),u.val(!0),function(e,n){var r="ok"===e;r||h.warn("set at "+t+" failed: "+e);var i=a.serverSyncTree_.ackUserWrite(l,!r);a.eventQueue_.raiseEventsForChangedPath(t,i),a.callOnCompleteCallback(o,e,n)});var p=this.abortTransactions_(t);this.rerunTransactions_(p),this.eventQueue_.raiseEventsForChangedPath(p,[])},t.prototype.update=function(t,e,n){var o=this;this.log_("update",{path:t.toString(),value:e});var a=!0,s=this.generateServerValues(),u={};if(l.forEach(e,function(t,e){a=!1;var n=i.nodeFromJSON(e);u[t]=r.resolveDeferredValueSnapshot(n,s)}),a)h.log("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var c=this.getNextWriteId_(),f=this.serverSyncTree_.applyUserMerge(t,u,c);this.eventQueue_.queueEvents(f),this.server_.merge(t.toString(),e,function(e,r){var i="ok"===e;i||h.warn("update at "+t+" failed: "+e);var a=o.serverSyncTree_.ackUserWrite(c,!i),s=a.length>0?o.rerunTransactions_(t):t;o.eventQueue_.raiseEventsForChangedPath(s,a),o.callOnCompleteCallback(n,e,r)}),l.forEach(e,function(e){var n=o.abortTransactions_(t.child(e));o.rerunTransactions_(n)}),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=[];r.resolveDeferredValueTree(this.onDisconnect_,e).forEachTree(o.Path.Empty,function(e,r){n=n.concat(t.serverSyncTree_.applyServerOverwrite(e,r));var i=t.abortTransactions_(e);t.rerunTransactions_(i)}),this.onDisconnect_=new a.SparseSnapshotTree,this.eventQueue_.raiseEventsForChangedPath(o.Path.Empty,n)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)})},t.prototype.onDisconnectSet=function(t,e,n){var r=this,o=i.nodeFromJSON(e);this.server_.onDisconnectPut(t.toString(),o.val(!0),function(e,i){"ok"===e&&r.onDisconnect_.remember(t,o),r.callOnCompleteCallback(n,e,i)})},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var o=this,a=i.nodeFromJSON(e,n);this.server_.onDisconnectPut(t.toString(),a.val(!0),function(e,n){"ok"===e&&o.onDisconnect_.remember(t,a),o.callOnCompleteCallback(r,e,n)})},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(l.isEmpty(e))return h.log("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,function(o,a){"ok"===o&&l.forEach(e,function(e,n){var o=i.nodeFromJSON(n);r.onDisconnect_.remember(t.child(e),o)}),r.callOnCompleteCallback(n,o,a)})},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;t?(this.statsListener_||(this.statsListener_=new y.StatsListener(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce(function(t,e){return Math.max(e.length,t)},0);l.forEach(e,function(t,e){for(var r=t.length;r<n+2;r++)t+=" ";console.log(t+e)})}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),h.log.apply(void 0,[n].concat(t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&h.exceptionGuard(function(){if("ok"==e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}})},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new _.Database(this))},enumerable:!0,configurable:!0}),t}();e.Repo=b},ovUe:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("mnK5"),o=n("nf05"),a=n("Vu+o"),s=function(){function t(t,e,n,r,i){void 0===i&&(i=""),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=o.PersistentStorage.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&o.PersistentStorage.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){r.assert("string"==typeof t,"typeof type must == string"),r.assert("object"==typeof e,"typeof params must == object");var n;if(t===a.WEBSOCKET)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==a.LONG_POLLING)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var o=[];return i.forEach(e,function(t,e){o.push(t+"="+e)}),n+o.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}();e.RepoInfo=s},pI3a:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n("mnK5"),o=n("k6UL"),a=n("mnK5"),s=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||a.isMobileCordova()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return r(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return i.assert("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(o.EventEmitter);e.OnlineMonitor=s},qHRL:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("Fx72"),o=n("Amoq"),a=n("mnK5"),s=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){r.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),r.validateCallback("OnDisconnect.cancel",1,t,!0);var e=new a.Deferred;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){r.validateArgCount("OnDisconnect.remove",0,1,arguments.length),i.validateWritablePath("OnDisconnect.remove",this.path_),r.validateCallback("OnDisconnect.remove",1,t,!0);var e=new a.Deferred;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){r.validateArgCount("OnDisconnect.set",1,2,arguments.length),i.validateWritablePath("OnDisconnect.set",this.path_),i.validateFirebaseDataArg("OnDisconnect.set",1,t,this.path_,!1),r.validateCallback("OnDisconnect.set",2,e,!0);var n=new a.Deferred;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){r.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),i.validateWritablePath("OnDisconnect.setWithPriority",this.path_),i.validateFirebaseDataArg("OnDisconnect.setWithPriority",1,t,this.path_,!1),i.validatePriority("OnDisconnect.setWithPriority",2,e,!1),r.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var o=new a.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,o.wrapCallback(n)),o.promise},t.prototype.update=function(t,e){if(r.validateArgCount("OnDisconnect.update",1,2,arguments.length),i.validateWritablePath("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},s=0;s<t.length;++s)n[""+s]=t[s];t=n,o.warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}i.validateFirebaseMergeDataArg("OnDisconnect.update",1,t,this.path_,!1),r.validateCallback("OnDisconnect.update",2,e,!0);var u=new a.Deferred;return this.repo_.onDisconnectUpdate(this.path_,t,u.wrapCallback(e)),u.promise},t}();e.OnDisconnect=s},qQjo:function(t,e,n){"use strict";function r(){function t(t){return t=t||s,a(h,t)||i("no-app",{name:t}),h[t]}function e(){return Object.keys(h).map(function(t){return h[t]})}function n(t,e){Object.keys(l).forEach(function(n){var r=u(t,n);null!==r&&f[r]&&f[r](e,t)})}function u(t,e){if("serverAuth"===e)return null;var n=e;t.options;return n}var h={},l={},f={},p={__esModule:!0,initializeApp:function(t,e){void 0===e?e=s:"string"==typeof e&&""!==e||i("bad-app-name",{name:e+""}),a(h,e)&&i("duplicate-app",{name:e});var r=new c(t,e,p);return h[e]=r,n(r,"create"),r},app:t,apps:null,Promise:Promise,SDK_VERSION:"4.8.0",INTERNAL:{registerService:function(n,r,a,s,u){l[n]&&i("duplicate-service",{name:n}),l[n]=r,s&&(f[n]=s,e().forEach(function(t){s("create",t)}));var h=function(e){return void 0===e&&(e=t()),"function"!=typeof e[n]&&i("invalid-app-argument",{name:n}),e[n]()};return void 0!==a&&Object(o.deepExtend)(h,a),p[n]=h,c.prototype[n]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,n).apply(this,u?t:[])},h},createFirebaseNamespace:r,extendNamespace:function(t){Object(o.deepExtend)(p,t)},createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,removeApp:function(t){n(h[t],"delete"),delete h[t]},factories:l,useAsService:u,Promise:Promise,deepExtend:o.deepExtend}};return Object(o.patchProperty)(p,"default",p),Object.defineProperty(p,"apps",{get:e}),Object(o.patchProperty)(t,"App",c),p}function i(t,e){throw h.create(t,e)}Object.defineProperty(e,"__esModule",{value:!0});var o=n("mnK5"),a=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s="[DEFAULT]",u=[],c=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e,this.options_=Object(o.deepCopy)(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){u.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){u=u.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){t.firebase_.INTERNAL.removeApp(t.name_);var e=[];return Object.keys(t.services_).forEach(function(n){Object.keys(t.services_[n]).forEach(function(r){e.push(t.services_[n][r])})}),Promise.all(e.map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=s),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==s?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;Object(o.deepExtend)(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(u.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),u=[])},t.prototype.checkDestroyed_=function(){this.isDeleted_&&i("app-deleted",{name:this.name_})},t}();c.prototype.name&&c.prototype.options||c.prototype.delete||console.log("dc");var h=new o.ErrorFactory("app","Firebase",{"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."});n.d(e,"firebase",function(){return l});var l=r();e.default=l},rASK:function(t,e,n){"use strict";function r(e){var n=e.INTERNAL.registerService("database",function(t,e,n){return c.RepoManager.getInstance().databaseFromApp(t,n)},{Reference:s.Reference,Query:a.Query,Database:o.Database,enableLogging:u.enableLogging,INTERNAL:h,ServerValue:p,TEST_ACCESS:l},null,!0);f.isNodeSdk()&&(t.exports=n)}Object.defineProperty(e,"__esModule",{value:!0});var i=n("qQjo"),o=n("GC2w");e.Database=o.Database;var a=n("Xlzd");e.Query=a.Query;var s=n("rURb");e.Reference=s.Reference;var u=n("Amoq");e.enableLogging=u.enableLogging;var c=n("+1fU"),h=n("yszr"),l=n("K6hM"),f=n("mnK5"),p=o.Database.ServerValue;e.ServerValue=p,e.registerDatabase=r,r(i.default);var d=n("YR+7");e.DataSnapshot=d.DataSnapshot;var y=n("qHRL");e.OnDisconnect=y.OnDisconnect},rURb:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n("qHRL"),o=n("zJVm"),a=n("Amoq"),s=n("RMj/"),u=n("Xlzd"),c=n("oCvb"),h=n("KbSj"),l=n("4e9P"),f=n("Fx72"),p=n("mnK5"),d=n("mnK5"),y=n("9ZaE"),m=function(t){function e(e,n){if(!(e instanceof c.Repo))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,l.QueryParams.DEFAULT,!1)||this}return r(e,t),e.prototype.getKey=function(){return p.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return p.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof h.Path||(null===this.path.getFront()?f.validateRootPathString("Reference.child",1,t,!1):f.validatePathString("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){p.validateArgCount("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){p.validateArgCount("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){p.validateArgCount("Reference.set",1,2,arguments.length),f.validateWritablePath("Reference.set",this.path),f.validateFirebaseDataArg("Reference.set",1,t,this.path,!1),p.validateCallback("Reference.set",2,e,!0);var n=new d.Deferred;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(p.validateArgCount("Reference.update",1,2,arguments.length),f.validateWritablePath("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,a.warn("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}f.validateFirebaseMergeDataArg("Reference.update",1,t,this.path,!1),p.validateCallback("Reference.update",2,e,!0);var i=new d.Deferred;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(p.validateArgCount("Reference.setWithPriority",2,3,arguments.length),f.validateWritablePath("Reference.setWithPriority",this.path),f.validateFirebaseDataArg("Reference.setWithPriority",1,t,this.path,!1),f.validatePriority("Reference.setWithPriority",2,e,!1),p.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new d.Deferred;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return p.validateArgCount("Reference.remove",0,1,arguments.length),f.validateWritablePath("Reference.remove",this.path),p.validateCallback("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(p.validateArgCount("Reference.transaction",1,3,arguments.length),f.validateWritablePath("Reference.transaction",this.path),p.validateCallback("Reference.transaction",1,t,!1),p.validateCallback("Reference.transaction",2,e,!0),f.validateBoolean("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new d.Deferred;"function"==typeof e&&r.promise.catch(function(){});return this.repo.startTransaction(this.path,t,function(t,n,i){t?r.reject(t):r.resolve(new o.TransactionResult(n,i)),"function"==typeof e&&e(t,n,i)},n),r.promise},e.prototype.setPriority=function(t,e){p.validateArgCount("Reference.setPriority",1,2,arguments.length),f.validateWritablePath("Reference.setPriority",this.path),f.validatePriority("Reference.setPriority",1,t,!1),p.validateCallback("Reference.setPriority",2,e,!0);var n=new d.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){p.validateArgCount("Reference.push",0,2,arguments.length),f.validateWritablePath("Reference.push",this.path),f.validateFirebaseDataArg("Reference.push",1,t,this.path,!0),p.validateCallback("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=s.nextPushId(r),o=this.child(i),a=this.child(i);return n=null!=t?o.set(t,e).then(function(){return a}):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch(function(){}),o},e.prototype.onDisconnect=function(){return f.validateWritablePath("Reference.onDisconnect",this.path),new i.OnDisconnect(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),e}(u.Query);e.Reference=m,u.Query.__referenceConstructor=m,y.SyncPoint.__referenceConstructor=m},rapL:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}();e.Deferred=r},rd4o:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}();e.SortedMapIterator=r;var i=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:a.EMPTY_NODE,this.right=null!=o?o:a.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r,i;return i=this,r=n(t,i.key),(i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return a.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(n=this,e(t,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return a.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){var t;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((t=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}();e.LLRBNode=i;var o=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new i(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}();e.LLRBEmptyNode=o;var a=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,i.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,i.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new r(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new r(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new r(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new r(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new o,t}();e.SortedMap=a},s7Gl:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("U1HK"),i=n("KbSj"),o=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=r.OperationType.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,i.Path.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}();e.Overwrite=o},"sC/S":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i,o,a=n("2/he"),s=n("Amoq"),u=n("NxJK"),c=n("CyQO");e.setNodeFromJSON=function(t){i=t},e.setMaxNode=function(t){o=t};var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?s.nameCompare(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return u.NamedNode.MIN},e.prototype.maxPost=function(){return new u.NamedNode(s.MAX_NAME,new c.LeafNode("[PRIORITY-POST]",o))},e.prototype.makePost=function(t,e){var n=i(t);return new u.NamedNode(e,new c.LeafNode("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(a.Index);e.PriorityIndex=h,e.PRIORITY_INDEX=new h},sn29:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("5aM3"),i=n("n1q+"),o=n("NxJK"),a=n("mnK5"),s=n("lscU"),u=function(){function t(t){this.rangedFilter_=new r.RangedFilter(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,a,s){return this.rangedFilter_.matches(new o.NamedNode(e,n))||(n=i.ChildrenNode.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,a,s):this.fullLimitUpdateChild_(t,e,n,a,s)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=i.ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=i.ChildrenNode.EMPTY_NODE.withIndex(this.index_);var o=void 0;o=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var a=0;o.hasNext()&&a<this.limit_;){var s=o.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),a++}}else{r=(r=e.withIndex(this.index_)).updatePriority(i.ChildrenNode.EMPTY_NODE);var u=void 0,c=void 0,h=void 0;o=void 0;if(this.reverse_){o=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();h=function(t,e){return l(e,t)}}else o=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),h=this.index_.getCompare();a=0;for(var f=!1;o.hasNext();){s=o.getNext();!f&&h(u,s)<=0&&(f=!0);f&&a<this.limit_&&h(s,c)<=0?a++:r=r.updateImmediateChild(s.name,i.ChildrenNode.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,u){var c;if(this.reverse_){var h=this.index_.getCompare();c=function(t,e){return h(e,t)}}else c=this.index_.getCompare();var l=t;a.assert(l.numChildren()==this.limit_,"");var f=new o.NamedNode(e,n),p=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),d=this.rangedFilter_.matches(f);if(l.hasChild(e)){for(var y=l.getImmediateChild(e),m=r.getChildAfterChild(this.index_,p,this.reverse_);null!=m&&(m.name==e||l.hasChild(m.name));)m=r.getChildAfterChild(this.index_,m,this.reverse_);var v=null==m?1:c(m,f);if(d&&!n.isEmpty()&&v>=0)return null!=u&&u.trackChildChange(s.Change.childChangedChange(e,n,y)),l.updateImmediateChild(e,n);null!=u&&u.trackChildChange(s.Change.childRemovedChange(e,y));var g=l.updateImmediateChild(e,i.ChildrenNode.EMPTY_NODE);return null!=m&&this.rangedFilter_.matches(m)?(null!=u&&u.trackChildChange(s.Change.childAddedChange(m.name,m.node)),g.updateImmediateChild(m.name,m.node)):g}return n.isEmpty()?t:d&&c(p,f)>=0?(null!=u&&(u.trackChildChange(s.Change.childRemovedChange(p.name,p.node)),u.trackChildChange(s.Change.childAddedChange(e,n))),l.updateImmediateChild(e,n).updateImmediateChild(p.name,i.ChildrenNode.EMPTY_NODE)):t},t}();e.LimitedFilter=u},u48Y:function(t,e,n){n("QUqZ")},uBgE:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n("mnK5"),o=n("RlcV"),a=n("mnK5"),s=n("NxJK"),u=n("sC/S"),c=n("ytZ3"),h={},l=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return i.assert(h&&u.PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),r=r||new t({".priority":h},{".priority":u.PRIORITY_INDEX})},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var e=a.safeGet(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e===h?null:e},t.prototype.hasIndex=function(t){return a.contains(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){i.assert(e!==c.KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r=[],u=!1,l=n.getIterator(s.NamedNode.Wrap),f=l.getNext();f;)u=u||e.isDefinedOn(f.node),r.push(f),f=l.getNext();var p;p=u?o.buildChildSet(r,e.getCompare()):h;var d=e.toString(),y=a.clone(this.indexSet_);y[d]=e;var m=a.clone(this.indexes_);return m[d]=p,new t(m,y)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(a.map(this.indexes_,function(t,u){var c=a.safeGet(r.indexSet_,u);if(i.assert(c,"Missing index implementation for "+u),t===h){if(c.isDefinedOn(e.node)){for(var l=[],f=n.getIterator(s.NamedNode.Wrap),p=f.getNext();p;)p.name!=e.name&&l.push(p),p=f.getNext();return l.push(e),o.buildChildSet(l,c.getCompare())}return h}var d=n.get(e.name),y=t;return d&&(y=y.remove(new s.NamedNode(e.name,d))),y.insert(e,e.node)}),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(a.map(this.indexes_,function(t){if(t===h)return t;var r=n.get(e.name);return r?t.remove(new s.NamedNode(e.name,r)):t}),this.indexSet_)},t}();e.IndexMap=l},uF3l:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("NxJK"),i=n("lscU"),o=n("mnK5"),a=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,o=[],a=[];return t.forEach(function(t){t.type===i.Change.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push(i.Change.childMovedChange(t.childName,t.snapshotNode))}),this.generateEventsForType_(o,i.Change.CHILD_REMOVED,t,n,e),this.generateEventsForType_(o,i.Change.CHILD_ADDED,t,n,e),this.generateEventsForType_(o,i.Change.CHILD_MOVED,a,n,e),this.generateEventsForType_(o,i.Change.CHILD_CHANGED,t,n,e),this.generateEventsForType_(o,i.Change.VALUE,t,n,e),o},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,a=n.filter(function(t){return t.type===e});a.sort(this.compareChanges_.bind(this)),a.forEach(function(e){var n=o.materializeSingleChange_(e,i);r.forEach(function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))})})},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_),t)},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw o.assertionError("Should only compare child_ events.");var n=new r.NamedNode(t.childName,t.snapshotNode),i=new r.NamedNode(e.childName,e.snapshotNode);return this.index_.compare(n,i)},t}();e.EventGenerator=a},"wwn+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Amoq");e.NAME_ONLY_COMPARATOR=function(t,e){return r.nameCompare(t.name,e.name)},e.NAME_COMPARATOR=function(t,e){return r.nameCompare(t,e)}},x9qz:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("n1q+"),i=n("TroR"),o=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new i.CacheNode(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new i.CacheNode(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new i.CacheNode(r.ChildrenNode.EMPTY_NODE,!1,!1),new i.CacheNode(r.ChildrenNode.EMPTY_NODE,!1,!1)),t}();e.ViewCache=o},xqIQ:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("IzwH"),i=n("Xiq3"),o=n("n1q+"),a=n("TroR"),s=n("x9qz"),u=n("uF3l"),c=n("mnK5"),h=n("U1HK"),l=n("lscU"),f=n("sC/S"),p=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),c=new r.IndexedFilter(n.getIndex()),h=n.getNodeFilter();this.processor_=new i.ViewProcessor(h);var l=e.getServerCache(),f=e.getEventCache(),p=c.updateFullNode(o.ChildrenNode.EMPTY_NODE,l.getNode(),null),d=h.updateFullNode(o.ChildrenNode.EMPTY_NODE,f.getNode(),null),y=new a.CacheNode(p,l.isFullyInitialized(),c.filtersNodes()),m=new a.CacheNode(d,f.isFullyInitialized(),h.filtersNodes());this.viewCache_=new s.ViewCache(m,y),this.eventGenerator_=new u.EventGenerator(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){c.assert(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach(function(t){e=e;var i=t.createCancelEvent(e,r);i&&n.push(i)})}if(t){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===h.OperationType.MERGE&&null!==t.source.queryId&&(c.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),c.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),c.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];if(!e.getNode().isLeafNode()){e.getNode().forEachChild(f.PRIORITY_INDEX,function(t,e){n.push(l.Change.childAddedChange(t,e))})}return e.isFullyInitialized()&&n.push(l.Change.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,r)},t}();e.View=p},yszr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("fIBc"),i=n("bEdf");e.forceLongPolling=function(){r.WebSocketConnection.forceDisallow(),i.BrowserPollConnection.forceAllow()},e.forceWebSockets=function(){i.BrowserPollConnection.forceDisallow()},e.isWebSocketsAvailable=function(){return r.WebSocketConnection.isAvailable()},e.setSecurityDebugCallback=function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},e.stats=function(t,e){t.repo.stats(e)},e.statsIncrementCounter=function(t,e){t.repo.statsIncrementCounter(e)},e.dataUpdateCount=function(t){return t.repo.dataUpdateCount},e.interceptServerData=function(t,e){return t.repo.interceptServerData_(e)}},ytZ3:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i,o=n("2/he"),a=n("NxJK"),s=n("Amoq"),u=n("mnK5"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return i},set:function(t){i=t},enumerable:!0,configurable:!0}),e.prototype.compare=function(t,e){return s.nameCompare(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw u.assertionError("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return a.NamedNode.MIN},e.prototype.maxPost=function(){return new a.NamedNode(s.MAX_NAME,i)},e.prototype.makePost=function(t,e){return u.assert("string"==typeof t,"KeyIndex indexValue must always be a string."),new a.NamedNode(t,i)},e.prototype.toString=function(){return".key"},e}(o.Index);e.KeyIndex=c,e.KEY_INDEX=new c},zJVm:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return r.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();e.TransactionResult=i},"zWi+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("KbSj"),o=n("U1HK"),a=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=o.OperationType.ACK_USER_WRITE,this.source=o.OperationSource.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return r.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new i.Path(e));return new t(i.Path.Empty,n,this.revert)}return r.assert(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}();e.AckUserWrite=a},zZtw:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mnK5"),i=n("Amoq"),o=n("zWi+"),a=n("n1q+"),s=n("mnK5"),u=n("6m+W"),c=n("icUp"),h=n("IbAO"),l=n("U1HK"),f=n("s7Gl"),p=n("KbSj"),d=n("9ZaE"),y=n("27hO"),m=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=u.ImmutableTree.Empty,this.pendingWriteTree_=new y.WriteTree,this.tagToQueryMap_={},this.queryToTagMap_={}}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new f.Overwrite(l.OperationSource.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=u.ImmutableTree.fromObject(e);return this.applyOperationToSyncPoints_(new h.Merge(l.OperationSource.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=u.ImmutableTree.Empty;return null!=n.snap?r=r.set(p.Path.Empty,!0):s.forEach(n.children,function(t,e){r=r.set(new p.Path(t),e)}),this.applyOperationToSyncPoints_(new o.AckUserWrite(n.path,r,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new f.Overwrite(l.OperationSource.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=u.ImmutableTree.fromObject(e);return this.applyOperationToSyncPoints_(new h.Merge(l.OperationSource.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new c.ListenComplete(l.OperationSource.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=p.Path.relativePath(a,e),c=new f.Overwrite(l.OperationSource.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,c=p.Path.relativePath(a,e),f=u.ImmutableTree.fromObject(n),d=new h.Merge(l.OperationSource.forServerTaggedQuery(s),c,f);return this.applyTaggedOperation_(a,d)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,a=i.queryId,s=p.Path.relativePath(o,e),u=new c.ListenComplete(l.OperationSource.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var i=e.path,o=null,s=!1;this.syncPointTree_.foreachOnPath(i,function(t,e){var n=p.Path.relativePath(t,i);o=o||e.getCompleteServerCache(n),s=s||e.hasCompleteView()});var u=this.syncPointTree_.get(i);u?(s=s||u.hasCompleteView(),o=o||u.getCompleteServerCache(p.Path.Empty)):(u=new d.SyncPoint,this.syncPointTree_=this.syncPointTree_.set(i,u));var c;if(null!=o)c=!0;else{c=!1,o=a.ChildrenNode.EMPTY_NODE;this.syncPointTree_.subtree(i).foreachChild(function(t,e){var n=e.getCompleteServerCache(p.Path.Empty);n&&(o=o.updateImmediateChild(t,n))})}var h=u.viewExistsForQuery(e);if(!h&&!e.getQueryParams().loadsAllData()){var l=t.makeQueryKey_(e);r.assert(!(l in this.queryToTagMap_),"View does not exist, but we have a tag");var f=t.getNextQueryTag_();this.queryToTagMap_[l]=f,this.tagToQueryMap_["_"+f]=l}var y=this.pendingWriteTree_.childWrites(i),m=u.addEventRegistration(e,n,y,o,c);if(!h&&!s){var v=u.viewForQuery(e);m=m.concat(this.setupListener_(e,v))}return m},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===e.queryIdentifier()||a.viewExistsForQuery(e))){var u=a.removeEventRegistration(e,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;s=u.events;var h=-1!==c.findIndex(function(t){return t.getQueryParams().loadsAllData()}),l=this.syncPointTree_.findOnPath(o,function(t,e){return e.hasCompleteView()});if(h&&!l){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var p=this.collectDistinctViewsForSubTree_(f),d=0;d<p.length;++d){var y=p[d],m=y.getQuery(),v=this.createListenerForView_(y);this.listenProvider_.startListening(t.queryForListening_(m),this.tagForQuery_(m),v.hashFn,v.onComplete)}}if(!l&&c.length>0&&!r)if(h){this.listenProvider_.stopListening(t.queryForListening_(e),null)}else c.forEach(function(e){var n=i.queryToTagMap_[t.makeQueryKey_(e)];i.listenProvider_.stopListening(t.queryForListening_(e),n)});this.removeTags_(c)}return s},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(t,function(e,n){var r=p.Path.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i});return n.calcCompleteEventCache(t,r,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold(function(t,e,n){if(e&&e.hasCompleteView()){return[e.getCompleteView()]}var r=[];return e&&(r=e.getQueryViews()),s.forEach(n,function(t,e){r=r.concat(e)}),r})},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap_[i];delete this.queryToTagMap_[i],delete this.tagToQueryMap_["_"+o]}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var i=e.path,o=this.tagForQuery_(e),a=this.createListenerForView_(n),u=this.listenProvider_.startListening(t.queryForListening_(e),o,a.hashFn,a.onComplete),c=this.syncPointTree_.subtree(i);if(o)r.assert(!c.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var h=c.fold(function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map(function(t){return t.getQuery()}))),s.forEach(n,function(t,e){r=r.concat(e)}),r}),l=0;l<h.length;++l){var f=h[l];this.listenProvider_.stopListening(t.queryForListening_(f),this.tagForQuery_(f))}return u},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||a.ChildrenNode.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var o=i.errorForServerCode(t,n);return e.removeEventRegistration(n,null,o)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return r.assert(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new p.Path(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap_["_"+t]},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return s.safeGet(this.queryToTagMap_,n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);r.assert(n,"Missing sync point for query tag that we're tracking");var i=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,i,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(p.Path.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(p.Path.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(p.Path.Empty));var o=[],a=t.path.getFront(),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,h=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,c,h))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(p.Path.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(p.Path.Empty));var a=[];return e.children.inorderTraversal(function(e,o){var s=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(a=a.concat(i.applyOperationDescendantsHelper_(c,o,s,u)))}),o&&(a=a.concat(o.applyOperation(t,r,n))),a},t.nextQueryTag_=1,t}();e.SyncTree=m}},["NHnr"]);
//# sourceMappingURL=app.a2eec97eca2deb12981b.js.map